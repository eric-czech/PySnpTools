<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>pysnptools Documentation &mdash; pysnptools 0.0.1 documentation</title>
    
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="pysnptools 0.0.1 documentation" href="#" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="#">pysnptools 0.0.1 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="pysnptools-documentation">
<h1><a class="reference internal" href="#module-pysnptools" title="pysnptools"><code class="xref py py-mod docutils literal"><span class="pre">pysnptools</span></code></a> Documentation<a class="headerlink" href="#pysnptools-documentation" title="Permalink to this headline">¶</a></h1>
<p>PySnpTools: A library for reading and manipulating genetic data.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">synopsis:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<ul class="simple">
<li><a class="reference internal" href="#module-pysnptools.snpreader" title="pysnptools.snpreader"><code class="xref py py-mod docutils literal"><span class="pre">snpreader</span></code></a>: Efficiently read genetic PLINK formats including *.bed/bim/fam and phenotype files. Also, efficiently read <em>parts</em> of files and standardize data.</li>
<li><a class="reference internal" href="#module-pysnptools.kernelreader" title="pysnptools.kernelreader"><code class="xref py py-mod docutils literal"><span class="pre">kernelreader</span></code></a>: Efficiently create, read, and manipulate kernel data.</li>
<li><a class="reference internal" href="#module-pysnptools.util" title="pysnptools.util"><code class="xref py py-mod docutils literal"><span class="pre">util</span></code></a>: In one line, intersect and re-order IIDs from <a class="reference internal" href="#module-pysnptools.snpreader" title="pysnptools.snpreader"><code class="xref py py-mod docutils literal"><span class="pre">snpreader</span></code></a>, <a class="reference internal" href="#module-pysnptools.kernelreader" title="pysnptools.kernelreader"><code class="xref py py-mod docutils literal"><span class="pre">kernelreader</span></code></a> and other sources. Also, efficiently extract a submatrix from an ndarray.</li>
<li><a class="reference internal" href="#pysnptools.util.IntRangeSet" title="pysnptools.util.IntRangeSet"><code class="xref py py-class docutils literal"><span class="pre">util.IntRangeSet</span></code></a>: Efficiently manipulate ranges of integers &#8211; for example, genetic position &#8211; with set operators including
union, intersection, and set difference.</li>
<li><a class="reference internal" href="#module-pysnptools.pstreader" title="pysnptools.pstreader"><code class="xref py py-mod docutils literal"><span class="pre">pstreader</span></code></a>: Generalizes <a class="reference internal" href="#module-pysnptools.snpreader" title="pysnptools.snpreader"><code class="xref py py-mod docutils literal"><span class="pre">snpreader</span></code></a> and <a class="reference internal" href="#module-pysnptools.kernelreader" title="pysnptools.kernelreader"><code class="xref py py-mod docutils literal"><span class="pre">kernelreader</span></code></a> (provides the efficiency of numpy arrays with some of the flexibility of pandas)</li>
<li><a class="reference internal" href="#module-pysnptools.standardizer" title="pysnptools.standardizer"><code class="xref py py-mod docutils literal"><span class="pre">standardizer</span></code></a>: Specify standardizers for <a class="reference internal" href="#module-pysnptools.snpreader" title="pysnptools.snpreader"><code class="xref py py-mod docutils literal"><span class="pre">snpreader</span></code></a>.</li>
<li><code class="xref py py-mod docutils literal"><span class="pre">kernelstandardizer</span></code>: Specify standardizers for <a class="reference internal" href="#module-pysnptools.kernelreader" title="pysnptools.kernelreader"><code class="xref py py-mod docutils literal"><span class="pre">kernelreader</span></code></a>.</li>
</ul>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Tutorial:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<p><em>From PyData Conference, Seattle, 2015</em></p>
<ul class="simple">
<li><a class="reference external" href="https://1drv.ms/p/s!AkoPP4cC5J64jOc15JXgDsXmD9EEaw">Slides</a></li>
<li><a class="reference external" href="https://www.youtube.com/watch?v=KPI6479ctAQ">Video</a></li>
<li><a class="reference external" href="https://github.com/MicrosoftGenomics/PySnpTools/blob/master/doc/ipynb/tutorial.ipynb">Notebook</a></li>
<li><a class="reference external" href="http://research.microsoft.com/en-us/um/redmond/projects/MSCompBio/PySnpTools/psttutorial.zip">Data file</a></li>
</ul>
<span class="target" id="module-pysnptools"></span><div class="section" id="module-pysnptools.snpreader">
<span id="snpreader-module"></span><h2><code class="xref py py-mod docutils literal"><span class="pre">snpreader</span></code> Module<a class="headerlink" href="#module-pysnptools.snpreader" title="Permalink to this headline">¶</a></h2>
<p>Tools for reading and manipulating SNP data.</p>
<div class="section" id="snpreader-snpreader">
<h3><code class="xref py py-class docutils literal"><span class="pre">snpreader.SnpReader</span></code><a class="headerlink" href="#snpreader-snpreader" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="pysnptools.snpreader.SnpReader">
<em class="property">class </em><code class="descclassname">pysnptools.snpreader.</code><code class="descname">SnpReader</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.snpreader.SnpReader" title="Permalink to this definition">¶</a></dt>
<dd><p>A SnpReader is one of three things:</p>
<ul>
<li><p class="first">A class such as <a class="reference internal" href="#pysnptools.snpreader.Bed" title="pysnptools.snpreader.Bed"><code class="xref py py-class docutils literal"><span class="pre">Bed</span></code></a> for you to specify data in a file. For example,</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.snpreader</span> <span class="k">import</span> <span class="n">Bed</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snp_on_disk</span> <span class="o">=</span> <span class="n">Bed</span><span class="p">(</span><span class="s1">&#39;../../tests/datasets/all_chr.maf0.001.N300&#39;</span><span class="p">,</span><span class="n">count_A1</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">snp_on_disk</span> <span class="c1"># prints specification for reading from file</span>
<span class="go">Bed(&#39;../../tests/datasets/all_chr.maf0.001.N300&#39;,count_A1=False)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snp_on_disk</span><span class="o">.</span><span class="n">sid_count</span> <span class="c1"># prints the number of SNPS (but doesn&#39;t read any SNP values)</span>
<span class="go">1015</span>
</pre></div>
</div>
</li>
<li><p class="first">A <a class="reference internal" href="#pysnptools.snpreader.SnpData" title="pysnptools.snpreader.SnpData"><code class="xref py py-class docutils literal"><span class="pre">SnpData</span></code></a> class that holds SNP data in memory, typically after reading it from disk:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">snp_on_disk</span> <span class="o">=</span> <span class="n">Bed</span><span class="p">(</span><span class="s1">&#39;../../tests/datasets/all_chr.maf0.001.N300&#39;</span><span class="p">,</span><span class="n">count_A1</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snpdata1</span> <span class="o">=</span> <span class="n">snp_on_disk</span><span class="o">.</span><span class="n">read</span><span class="p">()</span> <span class="c1">#reads the SNP values</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">type</span><span class="p">(</span><span class="n">snpdata1</span><span class="o">.</span><span class="n">val</span><span class="p">)</span> <span class="c1"># The val property is an ndarray of SNP values</span>
<span class="go">&lt;type &#39;numpy.ndarray&#39;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">snpdata1</span> <span class="c1"># prints the specification of the in-memory SNP information</span>
<span class="go">SnpData(Bed(&#39;../../tests/datasets/all_chr.maf0.001.N300&#39;,count_A1=False))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snpdata1</span><span class="o">.</span><span class="n">iid_count</span> <span class="c1">#prints the number of iids (number of individuals) in this in-memory data</span>
<span class="go">300</span>
</pre></div>
</div>
</li>
<li><p class="first">A subset of any SnpReader, specified with &#8220;[ <em>iid_index</em> , <em>sid_index</em> ]&#8221;, to read only some SNP values. It can
also be used to re-order the values.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">snp_on_disk</span> <span class="o">=</span> <span class="n">Bed</span><span class="p">(</span><span class="s1">&#39;../../tests/datasets/all_chr.maf0.001.N300&#39;</span><span class="p">,</span><span class="n">count_A1</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">subset_on_disk</span> <span class="o">=</span> <span class="n">snp_on_disk</span><span class="p">[[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],::</span><span class="mi">2</span><span class="p">]</span> <span class="c1"># specification for a subset of the data on disk. No SNP values are read yet.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">subset_on_disk</span><span class="o">.</span><span class="n">sid_count</span> <span class="c1"># prints the number of sids in this subset (but still doesn&#39;t read any SNP values)</span>
<span class="go">508</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">subset_on_disk</span> <span class="c1">#prints a specification of &#39;subset_on_disk&#39;</span>
<span class="go">Bed(&#39;../../tests/datasets/all_chr.maf0.001.N300&#39;,count_A1=False)[[3,4],::2]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snpdata_subset</span> <span class="o">=</span> <span class="n">subset_on_disk</span><span class="o">.</span><span class="n">read</span><span class="p">()</span> <span class="c1"># efficiently reads the specified subset of values from the disk</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">snpdata_subset</span> <span class="c1"># prints the specification of the in-memory SNP information</span>
<span class="go">SnpData(Bed(&#39;../../tests/datasets/all_chr.maf0.001.N300&#39;,count_A1=False)[[3,4],::2])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="nb">int</span><span class="p">(</span><span class="n">snpdata_subset</span><span class="o">.</span><span class="n">val</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">snpdata_subset</span><span class="o">.</span><span class="n">val</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="c1"># The dimensions of the ndarray of SNP values</span>
<span class="go">2 508</span>
</pre></div>
</div>
</li>
</ul>
<p>The SnpReaders Classes</p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="24%" />
<col width="18%" />
<col width="21%" />
<col width="17%" />
<col width="21%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><em>Class</em></td>
<td><em>Format</em></td>
<td><em>Random Access</em></td>
<td><em>Suffixes</em></td>
<td><em>Write</em> method?</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#pysnptools.snpreader.SnpData" title="pysnptools.snpreader.SnpData"><code class="xref py py-class docutils literal"><span class="pre">SnpData</span></code></a></td>
<td>in-memory floats</td>
<td>Yes</td>
<td><em>n/a</em></td>
<td><em>n/a</em></td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#pysnptools.snpreader.Bed" title="pysnptools.snpreader.Bed"><code class="xref py py-class docutils literal"><span class="pre">Bed</span></code></a></td>
<td>binary, 0,1,2</td>
<td>Yes (by sid)</td>
<td>.bed/.bim/.fam</td>
<td>Yes</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#pysnptools.snpreader.Pheno" title="pysnptools.snpreader.Pheno"><code class="xref py py-class docutils literal"><span class="pre">Pheno</span></code></a></td>
<td>text, floats</td>
<td>No</td>
<td>.txt,.phe</td>
<td>Yes</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#pysnptools.snpreader.Dat" title="pysnptools.snpreader.Dat"><code class="xref py py-class docutils literal"><span class="pre">Dat</span></code></a></td>
<td>text, floats</td>
<td>No</td>
<td>.dat/.map/.fam</td>
<td>Yes</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#pysnptools.snpreader.Ped" title="pysnptools.snpreader.Ped"><code class="xref py py-class docutils literal"><span class="pre">Ped</span></code></a></td>
<td>text, 0,1,2</td>
<td>No</td>
<td>.ped/.map</td>
<td>Yes</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#pysnptools.snpreader.Dense" title="pysnptools.snpreader.Dense"><code class="xref py py-class docutils literal"><span class="pre">Dense</span></code></a></td>
<td>text, 0,1,2</td>
<td>No</td>
<td>.dense.txt</td>
<td>Yes</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#pysnptools.snpreader.SnpNpz" title="pysnptools.snpreader.SnpNpz"><code class="xref py py-class docutils literal"><span class="pre">SnpNpz</span></code></a></td>
<td>binary, floats</td>
<td>No</td>
<td>.snp.npz</td>
<td>Yes</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#pysnptools.snpreader.SnpHdf5" title="pysnptools.snpreader.SnpHdf5"><code class="xref py py-class docutils literal"><span class="pre">SnpHdf5</span></code></a></td>
<td>binary, floats</td>
<td>Yes (by sid or iid)</td>
<td>.snp.hdf5</td>
<td>Yes</td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>Methods &amp; Properties:</p>
<blockquote>
<div><p>Every SnpReader, such as <a class="reference internal" href="#pysnptools.snpreader.Bed" title="pysnptools.snpreader.Bed"><code class="xref py py-class docutils literal"><span class="pre">Bed</span></code></a> and <a class="reference internal" href="#pysnptools.snpreader.SnpData" title="pysnptools.snpreader.SnpData"><code class="xref py py-class docutils literal"><span class="pre">SnpData</span></code></a>, has these properties: <a class="reference internal" href="#pysnptools.snpreader.SnpReader.iid" title="pysnptools.snpreader.SnpReader.iid"><code class="xref py py-attr docutils literal"><span class="pre">iid</span></code></a>, <a class="reference internal" href="#pysnptools.snpreader.SnpReader.iid_count" title="pysnptools.snpreader.SnpReader.iid_count"><code class="xref py py-attr docutils literal"><span class="pre">iid_count</span></code></a>, <a class="reference internal" href="#pysnptools.snpreader.SnpReader.sid" title="pysnptools.snpreader.SnpReader.sid"><code class="xref py py-attr docutils literal"><span class="pre">sid</span></code></a>, <a class="reference internal" href="#pysnptools.snpreader.SnpReader.sid_count" title="pysnptools.snpreader.SnpReader.sid_count"><code class="xref py py-attr docutils literal"><span class="pre">sid_count</span></code></a>,
<a class="reference internal" href="#pysnptools.snpreader.SnpReader.pos" title="pysnptools.snpreader.SnpReader.pos"><code class="xref py py-attr docutils literal"><span class="pre">pos</span></code></a> and these methods: <a class="reference internal" href="#pysnptools.snpreader.SnpReader.read" title="pysnptools.snpreader.SnpReader.read"><code class="xref py py-meth docutils literal"><span class="pre">read()</span></code></a>, <a class="reference internal" href="#pysnptools.snpreader.SnpReader.iid_to_index" title="pysnptools.snpreader.SnpReader.iid_to_index"><code class="xref py py-meth docutils literal"><span class="pre">iid_to_index()</span></code></a>, <a class="reference internal" href="#pysnptools.snpreader.SnpReader.sid_to_index" title="pysnptools.snpreader.SnpReader.sid_to_index"><code class="xref py py-meth docutils literal"><span class="pre">sid_to_index()</span></code></a>, <a class="reference internal" href="#pysnptools.snpreader.SnpReader.read_kernel" title="pysnptools.snpreader.SnpReader.read_kernel"><code class="xref py py-meth docutils literal"><span class="pre">read_kernel()</span></code></a>. See below for details.</p>
<p><a class="reference internal" href="#pysnptools.snpreader.SnpData" title="pysnptools.snpreader.SnpData"><code class="xref py py-class docutils literal"><span class="pre">SnpData</span></code></a> is a SnpReader so it supports the above properties and methods. In addition, it supports property <code class="xref py py-attr docutils literal"><span class="pre">SnpData.val</span></code>, method <a class="reference internal" href="#pysnptools.snpreader.SnpData.standardize" title="pysnptools.snpreader.SnpData.standardize"><code class="xref py py-meth docutils literal"><span class="pre">SnpData.standardize()</span></code></a>, and equality testing.
See below for details.</p>
<p>Many of the classes, such as <a class="reference internal" href="#pysnptools.snpreader.Bed" title="pysnptools.snpreader.Bed"><code class="xref py py-class docutils literal"><span class="pre">Bed</span></code></a>, also provide a static <a class="reference internal" href="#pysnptools.snpreader.Bed.write" title="pysnptools.snpreader.Bed.write"><code class="xref py py-meth docutils literal"><span class="pre">Bed.write()</span></code></a> method for writing <a class="reference internal" href="#pysnptools.snpreader.SnpData" title="pysnptools.snpreader.SnpData"><code class="xref py py-class docutils literal"><span class="pre">SnpData</span></code></a>.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># read from Pheno, write to Bed</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.snpreader</span> <span class="k">import</span> <span class="n">Pheno</span><span class="p">,</span> <span class="n">Bed</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pysnptools.util</span> <span class="k">as</span> <span class="nn">pstutil</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snpdata</span> <span class="o">=</span> <span class="n">Pheno</span><span class="p">(</span><span class="s1">&#39;../examples/toydata.phe&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span> <span class="c1"># Read data from Pheno format</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pstutil</span><span class="o">.</span><span class="n">create_directory_if_necessary</span><span class="p">(</span><span class="s2">&quot;tempdir/toydata.bed&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Bed</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;tempdir/toydata.bed&quot;</span><span class="p">,</span><span class="n">snpdata</span><span class="p">,</span><span class="n">count_A1</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>   <span class="c1"># Write data in Bed format</span>
</pre></div>
</div>
</div></blockquote>
<p>iids and sids:</p>
<blockquote>
<div><p>Individual are identified with an iid, which is a ndarray of two strings: a family ID and a case ID. SNP locations 
are identified with sid string. For example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">snp_on_disk</span> <span class="o">=</span> <span class="n">Bed</span><span class="p">(</span><span class="s1">&#39;../../tests/datasets/all_chr.maf0.001.N300&#39;</span><span class="p">,</span><span class="n">count_A1</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">snp_on_disk</span><span class="o">.</span><span class="n">iid</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span> <span class="c1"># print the first three iids</span>
<span class="go">[[&#39;POP1&#39; &#39;0&#39;]</span>
<span class="go"> [&#39;POP1&#39; &#39;12&#39;]</span>
<span class="go"> [&#39;POP1&#39; &#39;44&#39;]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">snp_on_disk</span><span class="o">.</span><span class="n">sid</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span> <span class="c1"># print the first ten sids</span>
<span class="go">[&#39;1_12&#39; &#39;1_34&#39; &#39;1_10&#39; &#39;1_35&#39; &#39;1_28&#39; &#39;1_25&#39; &#39;1_36&#39; &#39;1_39&#39; &#39;1_4&#39; &#39;1_13&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">snp_on_disk</span><span class="o">.</span><span class="n">iid_to_index</span><span class="p">([[</span><span class="s1">&#39;POP1&#39;</span><span class="p">,</span><span class="s1">&#39;44&#39;</span><span class="p">],[</span><span class="s1">&#39;POP1&#39;</span><span class="p">,</span><span class="s1">&#39;12&#39;</span><span class="p">]])</span> <span class="c1">#Find the indexes for two iids.</span>
<span class="go">[2 1]</span>
</pre></div>
</div>
</div></blockquote>
<p>When Data is Read:</p>
<blockquote>
<div><p>SNP data can be enormous so we generally avoid reading it to the degree practical. Specifically,</p>
<ul>
<li><p class="first">Constructing and printing a SnpReader causes no file reading. For example, these commands read no data:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">snp_on_disk</span> <span class="o">=</span> <span class="n">Bed</span><span class="p">(</span><span class="s1">&#39;../../tests/datasets/all_chr.maf0.001.N300&#39;</span><span class="p">,</span><span class="n">count_A1</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="c1"># Construct a Bed SnpReader. No data is read.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">snp_on_disk</span> <span class="c1"># Print the Bed SnpReader specification. No data is read.</span>
<span class="go">Bed(&#39;../../tests/datasets/all_chr.maf0.001.N300&#39;,count_A1=False)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">subset_on_disk</span> <span class="o">=</span> <span class="n">snp_on_disk</span><span class="p">[[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],::</span><span class="mi">2</span><span class="p">]</span> <span class="c1"># Construct a subsetting SnpReader. No data is read.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">subset_on_disk</span> <span class="c1"># print the subset SnpReader. No data is read.</span>
<span class="go">Bed(&#39;../../tests/datasets/all_chr.maf0.001.N300&#39;,count_A1=False)[[3,4],::2]</span>
</pre></div>
</div>
</li>
<li><p class="first">Properties and methods related to the iids and sids (to the degree practical) read just some iid and sid data from the disk,
not SNP value data. Moreover, the iid and sid data is read from file only once. Consider these commands:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">snp_on_disk</span> <span class="o">=</span> <span class="n">Bed</span><span class="p">(</span><span class="s1">&#39;../../tests/datasets/all_chr.maf0.001.N300&#39;</span><span class="p">,</span><span class="n">count_A1</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="c1"># Construct a Bed SnpReader. No data is read.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">snp_on_disk</span><span class="o">.</span><span class="n">sid</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span> <span class="c1"># without reading any SNP values data from disk, read the sid and iid data from disk, cache it, and then print the first ten sids.</span>
<span class="go">[&#39;1_12&#39; &#39;1_34&#39; &#39;1_10&#39; &#39;1_35&#39; &#39;1_28&#39; &#39;1_25&#39; &#39;1_36&#39; &#39;1_39&#39; &#39;1_4&#39; &#39;1_13&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">snp_on_disk</span><span class="o">.</span><span class="n">sid_to_index</span><span class="p">([</span><span class="s1">&#39;1_10&#39;</span><span class="p">,</span><span class="s1">&#39;1_13&#39;</span><span class="p">])</span> <span class="c1">#use the cached sid information to find the indexes of &#39;1_10&#39; and &#39;1_13&#39;. (No data is read from disk.)</span>
<span class="go">[2 9]</span>
</pre></div>
</div>
</li>
<li><p class="first">The only methods that read SNP values from file are <a class="reference internal" href="#pysnptools.snpreader.SnpReader.read" title="pysnptools.snpreader.SnpReader.read"><code class="xref py py-meth docutils literal"><span class="pre">read()</span></code></a> and <a class="reference internal" href="#pysnptools.snpreader.SnpReader.read_kernel" title="pysnptools.snpreader.SnpReader.read_kernel"><code class="xref py py-meth docutils literal"><span class="pre">read_kernel()</span></code></a> (to the degree practical). For example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">snp_on_disk</span> <span class="o">=</span> <span class="n">Bed</span><span class="p">(</span><span class="s1">&#39;../../tests/datasets/all_chr.maf0.001.N300&#39;</span><span class="p">,</span><span class="n">count_A1</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="c1"># Construct a Bed SnpReader. No data is read.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snpdata1</span> <span class="o">=</span> <span class="n">snp_on_disk</span><span class="o">.</span><span class="n">read</span><span class="p">()</span> <span class="c1">#read all the SNP values from disk, creating a new SnpData instance that keeps these values in memory</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">snpdata1</span><span class="o">.</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span> <span class="c1"># print the SNP value for the iid with index 0 and the sid with index 2. (No data is read from disk.)</span>
<span class="go">1.0</span>
</pre></div>
</div>
</li>
<li><p class="first">If you request the values for only a subset of the iids or sids, (to the degree practical) only that subset will be read from disk.
for example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">subset_on_disk</span> <span class="o">=</span> <span class="n">Bed</span><span class="p">(</span><span class="s1">&#39;../../tests/datasets/all_chr.maf0.001.N300&#39;</span><span class="p">,</span><span class="n">count_A1</span><span class="o">=</span><span class="kc">False</span><span class="p">)[[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],::</span><span class="mi">2</span><span class="p">]</span> <span class="c1"># Construct a subsetting SnpReader. No data is read.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snpdata_subset</span> <span class="o">=</span> <span class="n">subset_on_disk</span><span class="o">.</span><span class="n">read</span><span class="p">()</span> <span class="c1"># from disk, read the SNP values for the iids with index 3 and 4 AND sids with even numbered indexes.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">snpdata_subset</span><span class="o">.</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span> <span class="c1"># print the SNP value with subset iid index 0 and sid index 2 (corresponding to iid index 3 and sid index 4 in the full data). No data is read from disk.</span>
<span class="go">2.0</span>
</pre></div>
</div>
</li>
</ul>
</div></blockquote>
<p>When Data is Re-Read and Copied:</p>
<blockquote>
<div><p>Every time you call a SnpReader&#8217;s <a class="reference internal" href="#pysnptools.snpreader.SnpReader.read" title="pysnptools.snpreader.SnpReader.read"><code class="xref py py-meth docutils literal"><span class="pre">read()</span></code></a> method, the SnpReader re-reads the SNP value data and returns a new in-memory <a class="reference internal" href="#pysnptools.snpreader.SnpData" title="pysnptools.snpreader.SnpData"><code class="xref py py-class docutils literal"><span class="pre">SnpData</span></code></a>
(with <code class="xref py py-attr docutils literal"><span class="pre">SnpData.val</span></code> property containing a new ndarray of the SNP values). Likewise, when you call the <a class="reference internal" href="#pysnptools.snpreader.SnpReader.kernel" title="pysnptools.snpreader.SnpReader.kernel"><code class="xref py py-meth docutils literal"><span class="pre">kernel()</span></code></a> method, the SnpReader re-reads
the data and returns a new kernel ndarray.</p>
<p>Here is an example of what not to do, because it causes all the SNP value data to be read twice.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">snp_on_disk</span> <span class="o">=</span> <span class="n">Bed</span><span class="p">(</span><span class="s1">&#39;../../tests/datasets/all_chr.maf0.001.N300&#39;</span><span class="p">,</span><span class="n">count_A1</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="c1"># Construct a Bed SnpReader. No data is read.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># The following is not recommended because it inefficiently reads all the SNP values twice.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">snp_on_disk</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span> <span class="c1"># read all values into a new SnpData, print a SNP value</span>
<span class="go">1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">snp_on_disk</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span> <span class="c1"># read all values (again) into a second new SnpData, print a SNP value</span>
<span class="go">2.0</span>
</pre></div>
</div>
<p>Here are two efficient alternatives. First, if all SNP values can all fit in memory, read them once into a <a class="reference internal" href="#pysnptools.snpreader.SnpData" title="pysnptools.snpreader.SnpData"><code class="xref py py-class docutils literal"><span class="pre">SnpData</span></code></a> and then
access that <a class="reference internal" href="#pysnptools.snpreader.SnpData" title="pysnptools.snpreader.SnpData"><code class="xref py py-class docutils literal"><span class="pre">SnpData</span></code></a> multiple times.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">snp_on_disk</span> <span class="o">=</span> <span class="n">Bed</span><span class="p">(</span><span class="s1">&#39;../../tests/datasets/all_chr.maf0.001.N300&#39;</span><span class="p">,</span><span class="n">count_A1</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="c1"># Construct a Bed SnpReader. No data is read.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snpdata1</span> <span class="o">=</span> <span class="n">snp_on_disk</span><span class="o">.</span><span class="n">read</span><span class="p">()</span> <span class="c1"># read all values into a new SnpData</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">snpdata1</span><span class="o">.</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span> <span class="c1"># print a SNP value from snpdata1&#39;s in-memory ndarray</span>
<span class="go">1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">snpdata1</span><span class="o">.</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span> <span class="c1"># print another SNP value from snpdata1&#39;s in-memory ndarray.</span>
<span class="go">2.0</span>
</pre></div>
</div>
<p>Second, if the SNP value data is too large to fit in memory, use subsetting to read only the SNP values of interest from disk.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">snp_on_disk</span> <span class="o">=</span> <span class="n">Bed</span><span class="p">(</span><span class="s1">&#39;../../tests/datasets/all_chr.maf0.001.N300&#39;</span><span class="p">,</span><span class="n">count_A1</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="c1"># Construct a Bed SnpReader. No data is read.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">snp_on_disk</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="c1">#Define the subset of data and read only that subset from disk.</span>
<span class="go">1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">snp_on_disk</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="c1">#Define a second subset of data and read only that subset from disk.</span>
<span class="go">2.0</span>
</pre></div>
</div>
<p>Because the in-memory <a class="reference internal" href="#pysnptools.snpreader.SnpData" title="pysnptools.snpreader.SnpData"><code class="xref py py-class docutils literal"><span class="pre">SnpData</span></code></a> class is a kind of SnpReader, you may read from it, too.
Doing so create a new <a class="reference internal" href="#pysnptools.snpreader.SnpData" title="pysnptools.snpreader.SnpData"><code class="xref py py-class docutils literal"><span class="pre">SnpData</span></code></a> instance containing a copy of the SNP values in a new ndarray.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">snp_on_disk</span> <span class="o">=</span> <span class="n">Bed</span><span class="p">(</span><span class="s1">&#39;../../tests/datasets/all_chr.maf0.001.N300&#39;</span><span class="p">,</span><span class="n">count_A1</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="c1"># Construct a Bed SnpReader. No data is read.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snpdata1</span> <span class="o">=</span> <span class="n">snp_on_disk</span><span class="o">.</span><span class="n">read</span><span class="p">()</span> <span class="c1"># read all SNP values from disk into a new SnpData</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">snpdata1</span><span class="o">.</span><span class="n">val</span> <span class="ow">is</span> <span class="n">snpdata1</span><span class="o">.</span><span class="n">val</span> <span class="c1"># Do the in-memory SNP values use the same memory as themselves? Yes</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snpdata2</span> <span class="o">=</span> <span class="n">snpdata1</span><span class="o">.</span><span class="n">read</span><span class="p">()</span> <span class="c1"># copy all the SNP values into a new ndarray in a new SnpData</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">snpdata2</span><span class="o">.</span><span class="n">val</span> <span class="ow">is</span> <span class="n">snpdata1</span><span class="o">.</span><span class="n">val</span> <span class="c1"># Do the two ndarrays of in-memory SNP values use the same memory?</span>
<span class="go">False</span>
</pre></div>
</div>
</div></blockquote>
<p>Avoiding Unwanted ndarray Allocations</p>
<blockquote>
<div><p>You may want a subset of SNPs values from an in-memory <a class="reference internal" href="#pysnptools.snpreader.SnpData" title="pysnptools.snpreader.SnpData"><code class="xref py py-class docutils literal"><span class="pre">SnpData</span></code></a> and you may know that this subset and the original <a class="reference internal" href="#pysnptools.snpreader.SnpData" title="pysnptools.snpreader.SnpData"><code class="xref py py-class docutils literal"><span class="pre">SnpData</span></code></a>
can safely share the memory of the ndarray of SNP values. For this case, the <a class="reference internal" href="#pysnptools.snpreader.SnpReader.read" title="pysnptools.snpreader.SnpReader.read"><code class="xref py py-meth docutils literal"><span class="pre">read()</span></code></a> has optional parameters called view_ok and order. If you override 
the defaults of &#8220;view_ok=False,order=&#8217;F&#8217;&#8221; with &#8220;view_ok=True,order=&#8217;A&#8217;, the <a class="reference internal" href="#pysnptools.snpreader.SnpReader.read" title="pysnptools.snpreader.SnpReader.read"><code class="xref py py-meth docutils literal"><span class="pre">read()</span></code></a> will, if practical, return a new 
<a class="reference internal" href="#pysnptools.snpreader.SnpData" title="pysnptools.snpreader.SnpData"><code class="xref py py-class docutils literal"><span class="pre">SnpData</span></code></a> with a ndarray shares memory with the original ndarray.
Use these parameters with care because any change to either ndarray (for example, via <a class="reference internal" href="#pysnptools.snpreader.SnpData.standardize" title="pysnptools.snpreader.SnpData.standardize"><code class="xref py py-meth docutils literal"><span class="pre">SnpData.standardize()</span></code></a>) will effect
the others. Also keep in mind that <a class="reference internal" href="#pysnptools.snpreader.SnpReader.read" title="pysnptools.snpreader.SnpReader.read"><code class="xref py py-meth docutils literal"><span class="pre">read()</span></code></a> relies on ndarray&#8217;s mechanisms to decide whether to actually
share memory and so it may ignore your suggestion and allocate a new ndarray anyway.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">snp_on_disk</span> <span class="o">=</span> <span class="n">Bed</span><span class="p">(</span><span class="s1">&#39;../../tests/datasets/all_chr.maf0.001.N300&#39;</span><span class="p">,</span><span class="n">count_A1</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="c1"># Construct a Bed SnpReader. No data is read.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snpdata1</span> <span class="o">=</span> <span class="n">snp_on_disk</span><span class="o">.</span><span class="n">read</span><span class="p">()</span> <span class="c1"># read all data from disk into a SnpData with a new ndarray</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">column01</span> <span class="o">=</span> <span class="n">snpdata1</span><span class="p">[:,</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">view_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">order</span><span class="o">=</span><span class="s1">&#39;A&#39;</span><span class="p">)</span> <span class="c1">#create SnpData with the data from just the first two SNPs. Sharing memory is OK. The memory may be laid out in any order (that is sid-major and iid-major are both OK).</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#print np.may_share_memory(snpdata1.val, column01.val) # Do the two ndarray&#39;s share memory? They could (but currently they won&#39;t)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">column201</span> <span class="o">=</span> <span class="n">snpdata1</span><span class="p">[:,[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">view_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">order</span><span class="o">=</span><span class="s1">&#39;A&#39;</span><span class="p">)</span> <span class="c1">#create SnpData with the data from three SNPs, permuted. Sharing memory is OK.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">np</span><span class="o">.</span><span class="n">may_share_memory</span><span class="p">(</span><span class="n">snpdata1</span><span class="o">.</span><span class="n">val</span><span class="p">,</span> <span class="n">column201</span><span class="o">.</span><span class="n">val</span><span class="p">)</span> <span class="c1"># Do the two ndarray&#39;s share memory? No, ndarray decided that this indexing was too complex for sharing.</span>
<span class="go">False</span>
</pre></div>
</div>
</div></blockquote>
<p>Creating Subsetting SnpReaders with Indexing</p>
<blockquote>
<div><p>You often don&#8217;t want to read the SNP values for all iids and sids. You can use indexing to create a subsetting SnpReader that
will read only the SNP values of interest.</p>
<p>SnpReaders support the indexing formats supported by ndarray plus two generalizations. Here are examples of indexing with an array
of indexes, with slicing, and with an array of Booleans.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">snp_on_disk</span> <span class="o">=</span> <span class="n">Bed</span><span class="p">(</span><span class="s1">&#39;../../tests/datasets/all_chr.maf0.001.N300&#39;</span><span class="p">,</span><span class="n">count_A1</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="c1"># Specify some data on disk in Bed format</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">subset_snpreader_1</span> <span class="o">=</span> <span class="n">snp_on_disk</span><span class="p">[[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],:]</span> <span class="c1">#index with an array of indexes</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">subset_snpreader_1</span><span class="o">.</span><span class="n">iid_count</span><span class="p">,</span> <span class="n">subset_snpreader_1</span><span class="o">.</span><span class="n">sid_count</span>
<span class="go">2 1015</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snpdata1</span> <span class="o">=</span> <span class="n">subset_snpreader_1</span><span class="o">.</span><span class="n">read</span><span class="p">()</span> <span class="c1"># read just the two rows of interest from the disk</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">subset_snpreader_2</span> <span class="o">=</span> <span class="n">snp_on_disk</span><span class="p">[:,:</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="c1">#index with a slice</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">subset_snpreader_2</span><span class="o">.</span><span class="n">iid_count</span><span class="p">,</span> <span class="n">subset_snpreader_2</span><span class="o">.</span><span class="n">sid_count</span>
<span class="go">300 507</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">boolindexes</span> <span class="o">=</span> <span class="p">[</span><span class="n">s</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;23_&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">snp_on_disk</span><span class="o">.</span><span class="n">sid</span><span class="p">]</span> <span class="c1"># create a Boolean index of sids that start &#39;23_&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">subset_snpreader_3</span> <span class="o">=</span> <span class="n">snp_on_disk</span><span class="p">[:,</span><span class="n">boolindexes</span><span class="p">]</span> <span class="c1">#index with array of Booleans</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">subset_snpreader_3</span><span class="o">.</span><span class="n">iid_count</span><span class="p">,</span> <span class="n">subset_snpreader_3</span><span class="o">.</span><span class="n">sid_count</span>
<span class="go">300 24</span>
</pre></div>
</div>
<p>The first generalization over what ndarray offers is full indexing on both the iid dimension and the sid dimension, in other words,
full multidimensional indexing. For example,</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">snp_on_disk</span> <span class="o">=</span> <span class="n">Bed</span><span class="p">(</span><span class="s1">&#39;../../tests/datasets/all_chr.maf0.001.N300&#39;</span><span class="p">,</span><span class="n">count_A1</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="c1"># Specify some data on disk in Bed format</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">subset_snpreader_4</span> <span class="o">=</span> <span class="n">snp_on_disk</span><span class="p">[[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],:</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="c1"># index on two dimensions at once</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">subset_snpreader_4</span><span class="o">.</span><span class="n">iid_count</span><span class="p">,</span> <span class="n">subset_snpreader_4</span><span class="o">.</span><span class="n">sid_count</span>
<span class="go">2 507</span>
</pre></div>
</div>
<p>The second generalization is indexing on a single integer index.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">snp_on_disk</span> <span class="o">=</span> <span class="n">Bed</span><span class="p">(</span><span class="s1">&#39;../../tests/datasets/all_chr.maf0.001.N300&#39;</span><span class="p">,</span><span class="n">count_A1</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="c1"># Specify some data on disk in Bed format</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">subset_snpreader_5</span> <span class="o">=</span> <span class="n">snp_on_disk</span><span class="p">[</span><span class="mi">5</span><span class="p">,:]</span> <span class="c1">#index with single integer</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">subset_snpreader_5</span><span class="o">.</span><span class="n">iid_count</span><span class="p">,</span> <span class="n">subset_snpreader_5</span><span class="o">.</span><span class="n">sid_count</span>
<span class="go">1 1015</span>
</pre></div>
</div>
<p>Indexing is also useful when you have SNP values in memory via a <a class="reference internal" href="#pysnptools.snpreader.SnpData" title="pysnptools.snpreader.SnpData"><code class="xref py py-class docutils literal"><span class="pre">SnpData</span></code></a> index and want to copy a subset of those values.
While you could instead index directly on the <cite>.SnpData.val</cite> ndarray, by indexing on the <a class="reference internal" href="#pysnptools.snpreader.SnpData" title="pysnptools.snpreader.SnpData"><code class="xref py py-class docutils literal"><span class="pre">SnpData</span></code></a> instance you
also get iid and cid information.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">snp_on_disk</span> <span class="o">=</span> <span class="n">Bed</span><span class="p">(</span><span class="s1">&#39;../../tests/datasets/all_chr.maf0.001.N300&#39;</span><span class="p">,</span><span class="n">count_A1</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="c1"># Specify some data on disk in Bed format</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snpdata1</span> <span class="o">=</span> <span class="n">snp_on_disk</span><span class="o">.</span><span class="n">read</span><span class="p">()</span> <span class="c1"># read all SNP values into memory</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">snpdata1</span><span class="o">.</span><span class="n">sid</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span> <span class="c1"># print the first 10 sids</span>
<span class="go">[&#39;1_12&#39; &#39;1_34&#39; &#39;1_10&#39; &#39;1_35&#39; &#39;1_28&#39; &#39;1_25&#39; &#39;1_36&#39; &#39;1_39&#39; &#39;1_4&#39; &#39;1_13&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snpdata_subset</span> <span class="o">=</span> <span class="n">snpdata1</span><span class="p">[:,::</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">view_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">order</span><span class="o">=</span><span class="s1">&#39;A&#39;</span><span class="p">)</span> <span class="c1"># create a copy or view with every other sid</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">snpdata_subset</span><span class="o">.</span><span class="n">sid</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span> <span class="c1"># print the first 10 sids in the subset</span>
<span class="go">[&#39;1_12&#39; &#39;1_10&#39; &#39;1_28&#39; &#39;1_36&#39; &#39;1_4&#39; &#39;1_11&#39; &#39;1_32&#39; &#39;1_9&#39; &#39;1_17&#39; &#39;1_18&#39;]</span>
</pre></div>
</div>
<p>You can apply indexing on top of indexing to specify subsets of subsets of data to read. In this example, 
only the SNP values for every 16th sid is actually read from the disk.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># These are just SnpReaders, nothing is read from disk yet</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snp_on_disk</span> <span class="o">=</span> <span class="n">Bed</span><span class="p">(</span><span class="s1">&#39;../../tests/datasets/all_chr.maf0.001.N300&#39;</span><span class="p">,</span><span class="n">count_A1</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="c1"># Specify some data on disk in Bed format</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">half_snpreader</span> <span class="o">=</span> <span class="n">snp_on_disk</span><span class="p">[:,::</span><span class="mi">2</span><span class="p">]</span> <span class="c1"># a reader for half the sids</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">quarter_snpreader</span> <span class="o">=</span> <span class="n">half_snpreader</span><span class="p">[:,::</span><span class="mi">2</span><span class="p">]</span> <span class="c1"># a reader for half of half the sids</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sixteenth_snpreader</span> <span class="o">=</span> <span class="n">quarter_snpreader</span><span class="p">[:,::</span><span class="mi">2</span><span class="p">][:,::</span><span class="mi">2</span><span class="p">]</span> <span class="c1"># a reader for half of half of half of half the sids</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">sixteenth_snpreader</span> <span class="c1">#Print the specification of this reader</span>
<span class="go">Bed(&#39;../../tests/datasets/all_chr.maf0.001.N300&#39;,count_A1=False)[:,::2][:,::2][:,::2][:,::2]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Now we read from disk. Only values for one sid in every 16 will be read.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snpdata_sixteenth</span> <span class="o">=</span> <span class="n">sixteenth_snpreader</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">snpdata_sixteenth</span><span class="o">.</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span>
<span class="go">2.0</span>
</pre></div>
</div>
</div></blockquote>
<p>The <a class="reference internal" href="#pysnptools.snpreader.SnpReader.read" title="pysnptools.snpreader.SnpReader.read"><code class="xref py py-meth docutils literal"><span class="pre">read()</span></code></a> Method</p>
<blockquote>
<div>By default the <a class="reference internal" href="#pysnptools.snpreader.SnpReader.read" title="pysnptools.snpreader.SnpReader.read"><code class="xref py py-meth docutils literal"><span class="pre">read()</span></code></a> returns a ndarray of scipy.float64 laid out in memory in F-contiguous order (iid-index varies the fastest). You may, instead,
ask for scipy.float32 or for C-contiguous order or any order. See <a class="reference internal" href="#pysnptools.snpreader.SnpReader.read" title="pysnptools.snpreader.SnpReader.read"><code class="xref py py-meth docutils literal"><span class="pre">read()</span></code></a> for details.</div></blockquote>
<dl class="docutils">
<dt>The <a class="reference internal" href="#pysnptools.snpreader.SnpData.standardize" title="pysnptools.snpreader.SnpData.standardize"><code class="xref py py-meth docutils literal"><span class="pre">SnpData.standardize()</span></code></a> Method</dt>
<dd><p class="first">The <a class="reference internal" href="#pysnptools.snpreader.SnpData.standardize" title="pysnptools.snpreader.SnpData.standardize"><code class="xref py py-meth docutils literal"><span class="pre">SnpData.standardize()</span></code></a> method, available only on <a class="reference internal" href="#pysnptools.snpreader.SnpData" title="pysnptools.snpreader.SnpData"><code class="xref py py-class docutils literal"><span class="pre">SnpData</span></code></a>, does in-place standardization of the in-memory
SNP data. By default, it applies &#8216;Unit&#8217; standardization, that is: the values for each SNP will have mean zero and standard deviation 1.0.
NaN values are then filled with zeros (consequently, if there are NaN values, the final standard deviation will not be zero).
Note that, for efficiently, this method works in-place, actually changing values in the ndarray. Although it works in place, for convenience
it also returns itself. See <a class="reference internal" href="#pysnptools.snpreader.SnpData.standardize" title="pysnptools.snpreader.SnpData.standardize"><code class="xref py py-meth docutils literal"><span class="pre">SnpData.standardize()</span></code></a> for options and details.</p>
<div class="last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">snp_on_disk</span> <span class="o">=</span> <span class="n">Bed</span><span class="p">(</span><span class="s1">&#39;../../tests/datasets/all_chr.maf0.001.N300&#39;</span><span class="p">,</span><span class="n">count_A1</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="c1"># Specify some data on disk in Bed format</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snpdata1</span> <span class="o">=</span> <span class="n">snp_on_disk</span><span class="o">.</span><span class="n">read</span><span class="p">()</span> <span class="c1"># read all SNP values into memory</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">snpdata1</span> <span class="c1"># Prints the specification for this SnpData</span>
<span class="go">SnpData(Bed(&#39;../../tests/datasets/all_chr.maf0.001.N300&#39;,count_A1=False))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">snpdata1</span><span class="o">.</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
<span class="go">2.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snpdata1</span><span class="o">.</span><span class="n">standardize</span><span class="p">()</span> <span class="c1"># standardize changes the values in snpdata1.val and changes the specification.</span>
<span class="go">SnpData(Bed(&#39;../../tests/datasets/all_chr.maf0.001.N300&#39;,count_A1=False),Unit())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">snpdata1</span><span class="o">.</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
<span class="go">0.229415733871</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snpdata2</span> <span class="o">=</span> <span class="n">snp_on_disk</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">standardize</span><span class="p">()</span> <span class="c1"># Read and standardize in one expression with only one ndarray allocated.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">snpdata2</span><span class="o">.</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
<span class="go">0.229415733871</span>
</pre></div>
</div>
</dd>
</dl>
<p>The <a class="reference internal" href="#pysnptools.snpreader.SnpReader.read_kernel" title="pysnptools.snpreader.SnpReader.read_kernel"><code class="xref py py-meth docutils literal"><span class="pre">read_kernel()</span></code></a> Method</p>
<blockquote>
<div><p>The <a class="reference internal" href="#pysnptools.snpreader.SnpReader.read_kernel" title="pysnptools.snpreader.SnpReader.read_kernel"><code class="xref py py-meth docutils literal"><span class="pre">read_kernel()</span></code></a> method, available on any SnpReader, returns a <code class="xref py py-class docutils literal"><span class="pre">KernelData</span></code>. The <code class="xref py py-meth docutils literal"><span class="pre">val()</span></code> property of the <code class="xref py py-class docutils literal"><span class="pre">KernelData</span></code> is
an ndarray of the (possibility standardized) SNP values multiplied with their transposed selves. When applied to an read-from-disk SnpReader, such as <a class="reference internal" href="#pysnptools.snpreader.Bed" title="pysnptools.snpreader.Bed"><code class="xref py py-class docutils literal"><span class="pre">Bed</span></code></a>,
the method can save memory by reading (and standardizing) the data in blocks. See <a class="reference internal" href="#pysnptools.snpreader.SnpReader.read_kernel" title="pysnptools.snpreader.SnpReader.read_kernel"><code class="xref py py-meth docutils literal"><span class="pre">read_kernel()</span></code></a> for details.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.standardizer</span> <span class="k">import</span> <span class="n">Unit</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snp_on_disk</span> <span class="o">=</span> <span class="n">Bed</span><span class="p">(</span><span class="s1">&#39;../../tests/datasets/all_chr.maf0.001.N300&#39;</span><span class="p">,</span><span class="n">count_A1</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="c1"># Specify some data on disk in Bed format</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kerneldata1</span> <span class="o">=</span> <span class="n">snp_on_disk</span><span class="o">.</span><span class="n">read_kernel</span><span class="p">(</span><span class="n">Unit</span><span class="p">())</span> <span class="c1">#Create an in-memory kernel from the snp data on disk.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">kerneldata1</span><span class="o">.</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
<span class="go">901.421835903</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kerneldata2</span> <span class="o">=</span> <span class="n">snp_on_disk</span><span class="o">.</span><span class="n">read_kernel</span><span class="p">(</span><span class="n">Unit</span><span class="p">(),</span><span class="n">block_size</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span> <span class="c1">#Create an in-memory kernel from the snp data on disk, but only read 10 SNPS at a time from the disk.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">kerneldata2</span><span class="o">.</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
<span class="go">901.421835903</span>
</pre></div>
</div>
</div></blockquote>
<p>Details of Methods &amp; Properties:</p>
<dl class="attribute">
<dt id="pysnptools.snpreader.SnpReader.iid">
<code class="descname">iid</code><a class="headerlink" href="#pysnptools.snpreader.SnpReader.iid" title="Permalink to this definition">¶</a></dt>
<dd><p>A ndarray of the iids. Each iid is a ndarray of two strings (a family ID and a case ID) that identifies an individual.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">ndarray of strings with shape [<a class="reference internal" href="#pysnptools.snpreader.SnpReader.iid_count" title="pysnptools.snpreader.SnpReader.iid_count"><code class="xref py py-attr docutils literal"><span class="pre">iid_count</span></code></a>,2]</td>
</tr>
</tbody>
</table>
<p>This property (to the degree practical) reads only iid and sid data from the disk, not SNP value data. Moreover, the iid and sid data is read from file only once.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.snpreader</span> <span class="k">import</span> <span class="n">Bed</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snp_on_disk</span> <span class="o">=</span> <span class="n">Bed</span><span class="p">(</span><span class="s1">&#39;../../tests/datasets/all_chr.maf0.001.N300&#39;</span><span class="p">,</span><span class="n">count_A1</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">snp_on_disk</span><span class="o">.</span><span class="n">iid</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span> <span class="c1"># print the first three iids</span>
<span class="go">[[&#39;POP1&#39; &#39;0&#39;]</span>
<span class="go"> [&#39;POP1&#39; &#39;12&#39;]</span>
<span class="go"> [&#39;POP1&#39; &#39;44&#39;]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="pysnptools.snpreader.SnpReader.iid_count">
<code class="descname">iid_count</code><a class="headerlink" href="#pysnptools.snpreader.SnpReader.iid_count" title="Permalink to this definition">¶</a></dt>
<dd><p>number of iids</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">integer</td>
</tr>
</tbody>
</table>
<p>This property (to the degree practical) reads only iid and sid data from the disk, not SNP value data. Moreover, the iid and sid data is read from file only once.</p>
</dd></dl>

<dl class="method">
<dt id="pysnptools.snpreader.SnpReader.iid_to_index">
<code class="descname">iid_to_index</code><span class="sig-paren">(</span><em>list</em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.snpreader.SnpReader.iid_to_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes a list of iids and returns a list of index numbers</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>list</strong> &#8211; list of iids</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">ndarray of int</td>
</tr>
</tbody>
</table>
<p>This method (to the degree practical) reads only iid and sid data from the disk, not SNP value data. Moreover, the iid and sid data is read from file only once.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.snpreader</span> <span class="k">import</span> <span class="n">Bed</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snp_on_disk</span> <span class="o">=</span> <span class="n">Bed</span><span class="p">(</span><span class="s1">&#39;../../tests/datasets/all_chr.maf0.001.N300&#39;</span><span class="p">,</span><span class="n">count_A1</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="c1"># Specify SNP data on disk</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">snp_on_disk</span><span class="o">.</span><span class="n">iid_to_index</span><span class="p">([[</span><span class="s1">&#39;POP1&#39;</span><span class="p">,</span><span class="s1">&#39;44&#39;</span><span class="p">],[</span><span class="s1">&#39;POP1&#39;</span><span class="p">,</span><span class="s1">&#39;12&#39;</span><span class="p">]])</span> <span class="c1">#Find the indexes for two iids.</span>
<span class="go">[2 1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pysnptools.snpreader.SnpReader.kernel">
<code class="descname">kernel</code><span class="sig-paren">(</span><em>standardizer</em>, <em>allowlowrank=False</em>, <em>block_size=10000</em>, <em>blocksize=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.snpreader.SnpReader.kernel" title="Permalink to this definition">¶</a></dt>
<dd><div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Deprecated. Use <a class="reference internal" href="#pysnptools.snpreader.SnpReader.read_kernel" title="pysnptools.snpreader.SnpReader.read_kernel"><code class="xref py py-meth docutils literal"><span class="pre">read_kernel()</span></code></a> instead.</p>
</div>
<p>Returns a ndarray of size iid_count x iid_count. The returned array has the value of the standardized SNP values multiplied with their transposed selves.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>standardizer</strong> (<a class="reference internal" href="#pysnptools.standardizer.Standardizer" title="pysnptools.standardizer.Standardizer"><code class="xref py py-class docutils literal"><span class="pre">Standardizer</span></code></a>) &#8211; &#8211; Specify standardization to be applied before the matrix multiply. Any <a class="reference internal" href="#pysnptools.standardizer.Standardizer" title="pysnptools.standardizer.Standardizer"><code class="xref py py-class docutils literal"><span class="pre">Standardizer</span></code></a> may be used. Some choices include <code class="xref py py-class docutils literal"><span class="pre">Standardizer.Identity</span></code> 
(do nothing), <a class="reference internal" href="#pysnptools.standardizer.Unit" title="pysnptools.standardizer.Unit"><code class="xref py py-class docutils literal"><span class="pre">Unit</span></code></a> (make values for each SNP have mean zero and standard deviation 1.0), <code class="xref py py-class docutils literal"><span class="pre">Beta</span></code>.</li>
<li><strong>block_size</strong> (<em>int or None</em>) &#8211; optional &#8211; Default of 10000. None means to load all. Suggested number of sids to read into memory at a time.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray of size <a class="reference internal" href="#pysnptools.snpreader.SnpReader.iid_count" title="pysnptools.snpreader.SnpReader.iid_count"><code class="xref py py-attr docutils literal"><span class="pre">iid_count</span></code></a> x <a class="reference internal" href="#pysnptools.snpreader.SnpReader.iid_count" title="pysnptools.snpreader.SnpReader.iid_count"><code class="xref py py-attr docutils literal"><span class="pre">iid_count</span></code></a></p>
</td>
</tr>
</tbody>
</table>
<p>Calling the method again causes the SNP values to be re-read and allocates a new ndarray.</p>
<p>When applied to an read-from-disk SnpReader, such as <a class="reference internal" href="#pysnptools.snpreader.Bed" title="pysnptools.snpreader.Bed"><code class="xref py py-class docutils literal"><span class="pre">Bed</span></code></a>, the method can save memory by reading (and standardizing) the data in blocks.</p>
<p>If you request the values for only a subset of the sids or iids, (to the degree practical) only that subset will be read from disk.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.snpreader</span> <span class="k">import</span> <span class="n">Bed</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.standardizer</span> <span class="k">import</span> <span class="n">Unit</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snp_on_disk</span> <span class="o">=</span> <span class="n">Bed</span><span class="p">(</span><span class="s1">&#39;../../tests/datasets/all_chr.maf0.001.N300&#39;</span><span class="p">,</span><span class="n">count_A1</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="c1"># Specify SNP data on disk</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kernel</span> <span class="o">=</span> <span class="n">snp_on_disk</span><span class="o">.</span><span class="n">kernel</span><span class="p">(</span><span class="n">Unit</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">kernel</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span><span class="nb">int</span><span class="p">(</span><span class="n">kernel</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])),</span> <span class="n">kernel</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
<span class="go">(300, 300) 901.421835903</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="pysnptools.snpreader.SnpReader.pos">
<code class="descname">pos</code><a class="headerlink" href="#pysnptools.snpreader.SnpReader.pos" title="Permalink to this definition">¶</a></dt>
<dd><p>A ndarray of the position information for each sid. Each element is a ndarray of three scipy.numbers&#8217;s (chromosome, genetic distance, basepair distance).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">ndarray of float64 with shape [<a class="reference internal" href="#pysnptools.snpreader.SnpReader.sid_count" title="pysnptools.snpreader.SnpReader.sid_count"><code class="xref py py-attr docutils literal"><span class="pre">sid_count</span></code></a>, 3]</td>
</tr>
</tbody>
</table>
<p>This property (to the degree practical) reads only iid and sid data from the disk, not SNP value data. Moreover, the iid and sid data is read from file only once.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.snpreader</span> <span class="k">import</span> <span class="n">Bed</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snp_on_disk</span> <span class="o">=</span> <span class="n">Bed</span><span class="p">(</span><span class="s1">&#39;../../tests/datasets/all_chr.maf0.001.N300&#39;</span><span class="p">,</span><span class="n">count_A1</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">snp_on_disk</span><span class="o">.</span><span class="n">pos</span><span class="p">[:</span><span class="mi">3</span><span class="p">,]</span> <span class="c1"># print position information for the first three sids:</span>
<span class="go">[[ 1.          0.00800801  0.        ]</span>
<span class="go"> [ 1.          0.023023    1.        ]</span>
<span class="go"> [ 1.          0.0700701   4.        ]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pysnptools.snpreader.SnpReader.read">
<code class="descname">read</code><span class="sig-paren">(</span><em>order='F'</em>, <em>dtype=&lt;type 'numpy.float64'&gt;</em>, <em>force_python_only=False</em>, <em>view_ok=False</em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.snpreader.SnpReader.read" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads the SNP values and returns a <a class="reference internal" href="#pysnptools.snpreader.SnpData" title="pysnptools.snpreader.SnpData"><code class="xref py py-class docutils literal"><span class="pre">SnpData</span></code></a> (with <code class="xref py py-attr docutils literal"><span class="pre">SnpData.val</span></code> property containing a new ndarray of the SNP values).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>order</strong> (<em>string or None</em>) &#8211; {&#8216;F&#8217; (default), &#8216;C&#8217;, &#8216;A&#8217;}, optional &#8211; Specify the order of the ndarray. If order is &#8216;F&#8217; (default),
then the array will be in F-contiguous order (iid-index varies the fastest).
If order is &#8216;C&#8217;, then the returned array will be in C-contiguous order (sid-index varies the fastest).
If order is &#8216;A&#8217;, then the <code class="xref py py-attr docutils literal"><span class="pre">SnpData.val</span></code>
ndarray may be in any order (either C-, Fortran-contiguous).</li>
<li><strong>dtype</strong> (<em>data-type</em>) &#8211; {scipy.float64 (default), scipy.float32}, optional &#8211; The data-type for the <code class="xref py py-attr docutils literal"><span class="pre">SnpData.val</span></code> ndarray.</li>
<li><strong>force_python_only</strong> (<em>bool</em>) &#8211; optional &#8211; If False (default), may use outside library code. If True, requests that the read
be done without outside library code.</li>
<li><strong>view_ok</strong> (<em>bool</em>) &#8211; optional &#8211; If False (default), allocates new memory for the <code class="xref py py-attr docutils literal"><span class="pre">SnpData.val</span></code>&#8216;s ndarray. If True,
if practical and reading from a <a class="reference internal" href="#pysnptools.snpreader.SnpData" title="pysnptools.snpreader.SnpData"><code class="xref py py-class docutils literal"><span class="pre">SnpData</span></code></a>, will return a new 
<a class="reference internal" href="#pysnptools.snpreader.SnpData" title="pysnptools.snpreader.SnpData"><code class="xref py py-class docutils literal"><span class="pre">SnpData</span></code></a> with a ndarray shares memory with the original <a class="reference internal" href="#pysnptools.snpreader.SnpData" title="pysnptools.snpreader.SnpData"><code class="xref py py-class docutils literal"><span class="pre">SnpData</span></code></a>.
Typically, you&#8217;ll also wish to use &#8220;order=&#8217;A&#8217;&#8221; to increase the chance that sharing will be possible.
Use these parameters with care because any change to either ndarray (for example, via <a class="reference internal" href="#pysnptools.snpreader.SnpData.standardize" title="pysnptools.snpreader.SnpData.standardize"><code class="xref py py-meth docutils literal"><span class="pre">SnpData.standardize()</span></code></a>) will effect
the others. Also keep in mind that <a class="reference internal" href="#pysnptools.snpreader.SnpReader.read" title="pysnptools.snpreader.SnpReader.read"><code class="xref py py-meth docutils literal"><span class="pre">read()</span></code></a> relies on ndarray&#8217;s mechanisms to decide whether to actually
share memory and so it may ignore your suggestion and allocate a new ndarray anyway.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#pysnptools.snpreader.SnpData" title="pysnptools.snpreader.SnpData"><code class="xref py py-class docutils literal"><span class="pre">SnpData</span></code></a></p>
</td>
</tr>
</tbody>
</table>
<p>Calling the method again causes the SNP values to be re-read and creates a new in-memory <a class="reference internal" href="#pysnptools.snpreader.SnpData" title="pysnptools.snpreader.SnpData"><code class="xref py py-class docutils literal"><span class="pre">SnpData</span></code></a> with a new ndarray of SNP values.</p>
<p>If you request the values for only a subset of the sids or iids, (to the degree practical) only that subset will be read from disk.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.snpreader</span> <span class="k">import</span> <span class="n">Bed</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snp_on_disk</span> <span class="o">=</span> <span class="n">Bed</span><span class="p">(</span><span class="s1">&#39;../../tests/datasets/all_chr.maf0.001.N300.bed&#39;</span><span class="p">,</span><span class="n">count_A1</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="c1"># Specify SNP data on disk</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snpdata1</span> <span class="o">=</span> <span class="n">snp_on_disk</span><span class="o">.</span><span class="n">read</span><span class="p">()</span> <span class="c1"># Read all the SNP data returning a SnpData instance</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="nb">type</span><span class="p">(</span><span class="n">snpdata1</span><span class="o">.</span><span class="n">val</span><span class="p">)</span> <span class="c1"># The SnpData instance contains a ndarray of the data.</span>
<span class="go">&lt;type &#39;numpy.ndarray&#39;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">subset_snpdata</span> <span class="o">=</span> <span class="n">snp_on_disk</span><span class="p">[:,::</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">read</span><span class="p">()</span> <span class="c1"># From the disk, read SNP values for every other sid</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">subset_snpdata</span><span class="o">.</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># Print the first SNP value in the subset</span>
<span class="go">2.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">subsub_snpdata</span> <span class="o">=</span> <span class="n">subset_snpdata</span><span class="p">[:</span><span class="mi">10</span><span class="p">,:]</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="n">view_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1"># Create an in-memory subset of the subset with SNP values for the first ten iids. Share memory if practical.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># print np.may_share_memory(subset_snpdata.val, subsub_snpdata.val) # Do the two ndarray&#39;s share memory? They could. Currently they won&#39;t.       </span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pysnptools.snpreader.SnpReader.read_kernel">
<code class="descname">read_kernel</code><span class="sig-paren">(</span><em>standardizer=None</em>, <em>block_size=None</em>, <em>order='A'</em>, <em>dtype=&lt;type 'numpy.float64'&gt;</em>, <em>force_python_only=False</em>, <em>view_ok=False</em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.snpreader.SnpReader.read_kernel" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a <code class="xref py py-class docutils literal"><span class="pre">KernelData</span></code> such that the <code class="xref py py-meth docutils literal"><span class="pre">KernelData.val()</span></code> property will be a ndarray of the standardized SNP values multiplied with their transposed selves.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>standardizer</strong> (<a class="reference internal" href="#pysnptools.standardizer.Standardizer" title="pysnptools.standardizer.Standardizer"><code class="xref py py-class docutils literal"><span class="pre">Standardizer</span></code></a>) &#8211; &#8211; (required) Specify standardization to be applied before the matrix multiply. Any <a class="reference internal" href="#pysnptools.standardizer.Standardizer" title="pysnptools.standardizer.Standardizer"><code class="xref py py-class docutils literal"><span class="pre">Standardizer</span></code></a> may be used. Some choices include <code class="xref py py-class docutils literal"><span class="pre">Standardizer.Identity</span></code> 
(do nothing), <a class="reference internal" href="#pysnptools.standardizer.Unit" title="pysnptools.standardizer.Unit"><code class="xref py py-class docutils literal"><span class="pre">Unit</span></code></a> (make values for each SNP have mean zero and standard deviation 1.0) and <code class="xref py py-class docutils literal"><span class="pre">Beta</span></code>.</li>
<li><strong>block_size</strong> (<em>int or None</em>) &#8211; optional &#8211; Default of None (meaning to load all). Suggested number of sids to read into memory at a time.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">class:<cite>KernelData</cite></p>
</td>
</tr>
</tbody>
</table>
<p>Calling the method again causes the SNP values to be re-read and allocates a new class:<cite>KernelData</cite>.</p>
<p>When applied to an read-from-disk SnpReader, such as <a class="reference internal" href="#pysnptools.snpreader.Bed" title="pysnptools.snpreader.Bed"><code class="xref py py-class docutils literal"><span class="pre">Bed</span></code></a>, the method can save memory by reading (and standardizing) the data in blocks.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.snpreader</span> <span class="k">import</span> <span class="n">Bed</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.standardizer</span> <span class="k">import</span> <span class="n">Unit</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snp_on_disk</span> <span class="o">=</span> <span class="n">Bed</span><span class="p">(</span><span class="s1">&#39;../../tests/datasets/all_chr.maf0.001.N300&#39;</span><span class="p">,</span><span class="n">count_A1</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="c1"># Specify SNP data on disk</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kerneldata1</span> <span class="o">=</span> <span class="n">snp_on_disk</span><span class="o">.</span><span class="n">read_kernel</span><span class="p">(</span><span class="n">Unit</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="nb">int</span><span class="p">(</span><span class="n">kerneldata1</span><span class="o">.</span><span class="n">iid_count</span><span class="p">),</span> <span class="n">kerneldata1</span><span class="o">.</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
<span class="go">300 901.421835903</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="pysnptools.snpreader.SnpReader.row_property">
<code class="descname">row_property</code><a class="headerlink" href="#pysnptools.snpreader.SnpReader.row_property" title="Permalink to this definition">¶</a></dt>
<dd><p>Defined as a zero-width array for compatibility with <code class="xref py py-class docutils literal"><span class="pre">PstReader</span></code>, but not used.</p>
</dd></dl>

<dl class="attribute">
<dt id="pysnptools.snpreader.SnpReader.sid">
<code class="descname">sid</code><a class="headerlink" href="#pysnptools.snpreader.SnpReader.sid" title="Permalink to this definition">¶</a></dt>
<dd><p>A ndarray of the sids. Each sid is a string that identifies a SNP.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">ndarray (length <a class="reference internal" href="#pysnptools.snpreader.SnpReader.sid_count" title="pysnptools.snpreader.SnpReader.sid_count"><code class="xref py py-attr docutils literal"><span class="pre">sid_count</span></code></a>) of strings</td>
</tr>
</tbody>
</table>
<p>This property (to the degree practical) reads only iid and sid data from the disk, not SNP value data. Moreover, the iid and sid data is read from file only once.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.snpreader</span> <span class="k">import</span> <span class="n">Bed</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snp_on_disk</span> <span class="o">=</span> <span class="n">Bed</span><span class="p">(</span><span class="s1">&#39;../../tests/datasets/all_chr.maf0.001.N300&#39;</span><span class="p">,</span><span class="n">count_A1</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">snp_on_disk</span><span class="o">.</span><span class="n">sid</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span> <span class="c1"># print the first ten sids</span>
<span class="go">[&#39;1_12&#39; &#39;1_34&#39; &#39;1_10&#39; &#39;1_35&#39; &#39;1_28&#39; &#39;1_25&#39; &#39;1_36&#39; &#39;1_39&#39; &#39;1_4&#39; &#39;1_13&#39;]</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="pysnptools.snpreader.SnpReader.sid_count">
<code class="descname">sid_count</code><a class="headerlink" href="#pysnptools.snpreader.SnpReader.sid_count" title="Permalink to this definition">¶</a></dt>
<dd><p>number of sids</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">integer</td>
</tr>
</tbody>
</table>
<p>This property (to the degree practical) reads only iid and sid data from the disk, not SNP value data. Moreover, the iid and sid data is read from file only once.</p>
</dd></dl>

<dl class="method">
<dt id="pysnptools.snpreader.SnpReader.sid_to_index">
<code class="descname">sid_to_index</code><span class="sig-paren">(</span><em>list</em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.snpreader.SnpReader.sid_to_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes a list of sids and returns a list of index numbers</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>list</strong> (<em>list of strings</em>) &#8211; list of sids</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">ndarray of int</td>
</tr>
</tbody>
</table>
<p>This method (to the degree practical) reads only iid and sid data from the disk, not SNP value data. Moreover, the iid and sid data is read from file only once.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.snpreader</span> <span class="k">import</span> <span class="n">Bed</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snp_on_disk</span> <span class="o">=</span> <span class="n">Bed</span><span class="p">(</span><span class="s1">&#39;../../tests/datasets/all_chr.maf0.001.N300&#39;</span><span class="p">,</span><span class="n">count_A1</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="c1"># Specify SNP data on disk</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">snp_on_disk</span><span class="o">.</span><span class="n">sid_to_index</span><span class="p">([</span><span class="s1">&#39;1_10&#39;</span><span class="p">,</span><span class="s1">&#39;1_13&#39;</span><span class="p">])</span> <span class="c1">#Find the indexes for two sids.</span>
<span class="go">[2 9]</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="snpreader-bed">
<h3><code class="xref py py-class docutils literal"><span class="pre">snpreader.Bed</span></code><a class="headerlink" href="#snpreader-bed" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="pysnptools.snpreader.Bed">
<em class="property">class </em><code class="descclassname">pysnptools.snpreader.</code><code class="descname">Bed</code><span class="sig-paren">(</span><em>filename</em>, <em>count_A1=None</em>, <em>iid=None</em>, <em>sid=None</em>, <em>pos=None</em>, <em>skip_format_check=False</em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.snpreader.Bed" title="Permalink to this definition">¶</a></dt>
<dd><p>A <a class="reference internal" href="#pysnptools.snpreader.SnpReader" title="pysnptools.snpreader.SnpReader"><code class="xref py py-class docutils literal"><span class="pre">SnpReader</span></code></a> for random-access reads of Bed/Bim/Fam files from disk.</p>
<p>See <a class="reference internal" href="#pysnptools.snpreader.SnpReader" title="pysnptools.snpreader.SnpReader"><code class="xref py py-class docutils literal"><span class="pre">SnpReader</span></code></a> for details and examples.</p>
<p>The format is described in <a class="reference external" href="http://pngu.mgh.harvard.edu/~purcell/plink/binary.shtml">http://pngu.mgh.harvard.edu/~purcell/plink/binary.shtml</a>.</p>
<dl class="docutils">
<dt><strong>Constructor:</strong></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>filename</strong> (<em>string</em>) &#8211; The *.bed file to read. The &#8216;.bed&#8217; suffix is optional. The related *.bim and *.fam files will also be read.</li>
<li><strong>count_A1</strong> (<em>bool</em>) &#8211; Tells if it should count the number of A1 alleles (the PLINK standard) or the number of A2 alleles. False is the current default, but in the future the default will change to True.</li>
</ul>
<p><em>The following options are never needed, but can be used to avoid reading large &#8216;.fam&#8217; and &#8216;.bim&#8217; files when their information is already known.</em></p>
<ul class="last simple">
<li><strong>iid</strong> (an array of strings) &#8211; The <a class="reference internal" href="#pysnptools.snpreader.SnpReader.iid" title="pysnptools.snpreader.SnpReader.iid"><code class="xref py py-attr docutils literal"><span class="pre">SnpReader.iid</span></code></a> information. If not given, reads info from &#8216;.fam&#8217; file.</li>
<li><strong>sid</strong> (an array of strings) &#8211; The <a class="reference internal" href="#pysnptools.snpreader.SnpReader.sid" title="pysnptools.snpreader.SnpReader.sid"><code class="xref py py-attr docutils literal"><span class="pre">SnpReader.sid</span></code></a> information. If not given, reads info from &#8216;.bim&#8217; file.</li>
<li><strong>pos</strong> (optional, an array of strings) &#8211; The <a class="reference internal" href="#pysnptools.snpreader.SnpReader.pos" title="pysnptools.snpreader.SnpReader.pos"><code class="xref py py-attr docutils literal"><span class="pre">SnpReader.pos</span></code></a> information.  If not given, reads info from &#8216;.bim&#8217; file.</li>
<li><strong>skip_format_check</strong> (<em>bool</em>) &#8211; If False (default), will check that &#8216;.bed&#8217; file has expected starting bytes.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd>
</dl>
<p><strong>Methods beyond</strong> <a class="reference internal" href="#pysnptools.snpreader.SnpReader" title="pysnptools.snpreader.SnpReader"><code class="xref py py-class docutils literal"><span class="pre">SnpReader</span></code></a></p>
<dl class="staticmethod">
<dt id="pysnptools.snpreader.Bed.write">
<em class="property">static </em><code class="descname">write</code><span class="sig-paren">(</span><em>filename</em>, <em>snpdata</em>, <em>count_A1=False</em>, <em>force_python_only=False</em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.snpreader.Bed.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes a <a class="reference internal" href="#pysnptools.snpreader.SnpData" title="pysnptools.snpreader.SnpData"><code class="xref py py-class docutils literal"><span class="pre">SnpData</span></code></a> to Bed format.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>filename</strong> (<em>string</em>) &#8211; the name of the file to create</li>
<li><strong>snpdata</strong> (<a class="reference internal" href="#pysnptools.snpreader.SnpData" title="pysnptools.snpreader.SnpData"><code class="xref py py-class docutils literal"><span class="pre">SnpData</span></code></a>) &#8211; The in-memory data that should be written to disk.</li>
<li><strong>count_A1</strong> (<em>bool</em>) &#8211; Tells if it should count the number of A1 alleles (the PLINK standard) or the number of A2 alleles. False is the current default, but in the future the default will change to True.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.snpreader</span> <span class="k">import</span> <span class="n">Pheno</span><span class="p">,</span> <span class="n">Bed</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pysnptools.util</span> <span class="k">as</span> <span class="nn">pstutil</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snpdata</span> <span class="o">=</span> <span class="n">Pheno</span><span class="p">(</span><span class="s1">&#39;../examples/toydata.phe&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>         <span class="c1"># Read data from Pheno format</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pstutil</span><span class="o">.</span><span class="n">create_directory_if_necessary</span><span class="p">(</span><span class="s2">&quot;tempdir/toydata.bed&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Bed</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;tempdir/toydata.bed&quot;</span><span class="p">,</span><span class="n">snpdata</span><span class="p">,</span><span class="n">count_A1</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>   <span class="c1"># Write data in Bed format</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="snpreader-snpdata">
<h3><code class="xref py py-class docutils literal"><span class="pre">snpreader.SnpData</span></code><a class="headerlink" href="#snpreader-snpdata" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="pysnptools.snpreader.SnpData">
<em class="property">class </em><code class="descclassname">pysnptools.snpreader.</code><code class="descname">SnpData</code><span class="sig-paren">(</span><em>iid</em>, <em>sid</em>, <em>val</em>, <em>pos=None</em>, <em>name=None</em>, <em>parent_string=None</em>, <em>copyinputs_function=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.snpreader.SnpData" title="Permalink to this definition">¶</a></dt>
<dd><p>A <a class="reference internal" href="#pysnptools.snpreader.SnpReader" title="pysnptools.snpreader.SnpReader"><code class="xref py py-class docutils literal"><span class="pre">SnpReader</span></code></a> for holding SNP values (or similar values) in-memory, along with related iid and sid information.
It is usually created by calling the <a class="reference internal" href="#pysnptools.snpreader.SnpReader.read" title="pysnptools.snpreader.SnpReader.read"><code class="xref py py-meth docutils literal"><span class="pre">SnpReader.read()</span></code></a> method on another <a class="reference internal" href="#pysnptools.snpreader.SnpReader" title="pysnptools.snpreader.SnpReader"><code class="xref py py-class docutils literal"><span class="pre">SnpReader</span></code></a>, for example, <a class="reference internal" href="#pysnptools.snpreader.Bed" title="pysnptools.snpreader.Bed"><code class="xref py py-class docutils literal"><span class="pre">Bed</span></code></a>. It can also be constructed.</p>
<p>See <a class="reference internal" href="#pysnptools.snpreader.SnpReader" title="pysnptools.snpreader.SnpReader"><code class="xref py py-class docutils literal"><span class="pre">SnpReader</span></code></a> for details and examples.</p>
<dl class="docutils">
<dt><strong>Constructor:</strong></dt>
<dd><table class="first docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>iid</strong> (an array of strings) &#8211; The <a class="reference internal" href="#pysnptools.snpreader.SnpReader.iid" title="pysnptools.snpreader.SnpReader.iid"><code class="xref py py-attr docutils literal"><span class="pre">SnpReader.iid</span></code></a> information</li>
<li><strong>sid</strong> (an array of strings) &#8211; The <a class="reference internal" href="#pysnptools.snpreader.SnpReader.sid" title="pysnptools.snpreader.SnpReader.sid"><code class="xref py py-attr docutils literal"><span class="pre">SnpReader.sid</span></code></a> information</li>
<li><strong>val</strong> (a 2-D array of floats) &#8211; The SNP values</li>
<li><strong>pos</strong> (optional, an array of strings) &#8211; The <a class="reference internal" href="#pysnptools.snpreader.SnpReader.pos" title="pysnptools.snpreader.SnpReader.pos"><code class="xref py py-attr docutils literal"><span class="pre">SnpReader.pos</span></code></a> information</li>
<li><strong>name</strong> (optional, string) &#8211; Information to be display about the origin of this data</li>
<li><strong>copyinputs_function</strong> (optional, function) &#8211; <em>Used internally by optional clustering code</em></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.snpreader</span> <span class="k">import</span> <span class="n">SnpData</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snpdata</span> <span class="o">=</span> <span class="n">SnpData</span><span class="p">(</span><span class="n">iid</span><span class="o">=</span><span class="p">[[</span><span class="s1">&#39;fam0&#39;</span><span class="p">,</span><span class="s1">&#39;iid0&#39;</span><span class="p">],[</span><span class="s1">&#39;fam0&#39;</span><span class="p">,</span><span class="s1">&#39;iid1&#39;</span><span class="p">]],</span> <span class="n">sid</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;snp334&#39;</span><span class="p">,</span><span class="s1">&#39;snp349&#39;</span><span class="p">,</span><span class="s1">&#39;snp921&#39;</span><span class="p">],</span> <span class="n">val</span><span class="o">=</span><span class="p">[[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">2.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">2.</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">snpdata</span><span class="o">.</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">snpdata</span><span class="o">.</span><span class="n">iid_count</span><span class="p">,</span> <span class="n">snpdata</span><span class="o">.</span><span class="n">sid_count</span>
<span class="go">2.0 2 3</span>
</pre></div>
</div>
</dd>
</dl>
<p><strong>Equality:</strong></p>
<blockquote>
<div><p>Two SnpData objects are equal if their four arrays (<a class="reference internal" href="#pysnptools.snpreader.SnpReader.iid" title="pysnptools.snpreader.SnpReader.iid"><code class="xref py py-attr docutils literal"><span class="pre">SnpReader.iid</span></code></a>, <a class="reference internal" href="#pysnptools.snpreader.SnpReader.sid" title="pysnptools.snpreader.SnpReader.sid"><code class="xref py py-attr docutils literal"><span class="pre">SnpReader.sid</span></code></a>, <code class="xref py py-attr docutils literal"><span class="pre">SnpReader.val</span></code>, and <code class="xref py py-attr docutils literal"><span class="pre">SnpReader.pos_property</span></code>) are &#8216;array_equal&#8217;.
(Their &#8216;name&#8217; does not need to be the same).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.snpreader</span> <span class="k">import</span> <span class="n">SnpData</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snpdata1</span> <span class="o">=</span> <span class="n">SnpData</span><span class="p">(</span><span class="n">iid</span><span class="o">=</span><span class="p">[[</span><span class="s1">&#39;fam0&#39;</span><span class="p">,</span><span class="s1">&#39;iid0&#39;</span><span class="p">],[</span><span class="s1">&#39;fam0&#39;</span><span class="p">,</span><span class="s1">&#39;iid1&#39;</span><span class="p">]],</span> <span class="n">sid</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;snp334&#39;</span><span class="p">,</span><span class="s1">&#39;snp349&#39;</span><span class="p">,</span><span class="s1">&#39;snp921&#39;</span><span class="p">],</span> <span class="n">val</span><span class="o">=</span><span class="p">[[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">2.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">2.</span><span class="p">]],</span> <span class="n">pos</span><span class="o">=</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snpdata2</span> <span class="o">=</span> <span class="n">SnpData</span><span class="p">(</span><span class="n">iid</span><span class="o">=</span><span class="p">[[</span><span class="s1">&#39;fam0&#39;</span><span class="p">,</span><span class="s1">&#39;iid0&#39;</span><span class="p">],[</span><span class="s1">&#39;fam0&#39;</span><span class="p">,</span><span class="s1">&#39;iid1&#39;</span><span class="p">]],</span> <span class="n">sid</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;snp334&#39;</span><span class="p">,</span><span class="s1">&#39;snp349&#39;</span><span class="p">,</span><span class="s1">&#39;snp921&#39;</span><span class="p">],</span> <span class="n">val</span><span class="o">=</span><span class="p">[[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">2.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">2.</span><span class="p">]],</span> <span class="n">pos</span><span class="o">=</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">snpdata1</span> <span class="o">==</span> <span class="n">snpdata2</span> <span class="c1">#True, because all the arrays have the same values.</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">snpdata1</span><span class="o">.</span><span class="n">val</span> <span class="ow">is</span> <span class="n">snpdata2</span><span class="o">.</span><span class="n">val</span> <span class="c1">#False, because the two arrays have different memory.</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snpdata3</span> <span class="o">=</span> <span class="n">SnpData</span><span class="p">(</span><span class="n">iid</span><span class="o">=</span><span class="p">[[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;0&#39;</span><span class="p">],[</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="s1">&#39;0&#39;</span><span class="p">]],</span> <span class="n">sid</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;snp334&#39;</span><span class="p">,</span><span class="s1">&#39;snp349&#39;</span><span class="p">,</span><span class="s1">&#39;snp921&#39;</span><span class="p">],</span> <span class="n">val</span><span class="o">=</span><span class="p">[[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">2.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">2.</span><span class="p">]],</span> <span class="n">pos</span><span class="o">=</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snpdata4</span> <span class="o">=</span> <span class="n">SnpData</span><span class="p">(</span><span class="n">iid</span><span class="o">=</span><span class="p">[[</span><span class="s1">&#39;fam0&#39;</span><span class="p">,</span><span class="s1">&#39;iid0&#39;</span><span class="p">],[</span><span class="s1">&#39;fam0&#39;</span><span class="p">,</span><span class="s1">&#39;iid1&#39;</span><span class="p">]],</span> <span class="n">sid</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;snp334&#39;</span><span class="p">,</span><span class="s1">&#39;snp349&#39;</span><span class="p">,</span><span class="s1">&#39;snp921&#39;</span><span class="p">],</span> <span class="n">val</span><span class="o">=</span><span class="p">[[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">2.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">2.</span><span class="p">]],</span> <span class="n">pos</span><span class="o">=</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">snpdata3</span> <span class="o">==</span> <span class="n">snpdata4</span> <span class="c1">#False, because the iids are different.</span>
<span class="go">False</span>
</pre></div>
</div>
</div></blockquote>
<p><strong>Methods beyond</strong> <a class="reference internal" href="#pysnptools.snpreader.SnpReader" title="pysnptools.snpreader.SnpReader"><code class="xref py py-class docutils literal"><span class="pre">SnpReader</span></code></a></p>
<dl class="method">
<dt id="pysnptools.snpreader.SnpData.standardize">
<code class="descname">standardize</code><span class="sig-paren">(</span><em>standardizer=Unit()</em>, <em>block_size=None</em>, <em>return_trained=False</em>, <em>force_python_only=False</em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.snpreader.SnpData.standardize" title="Permalink to this definition">¶</a></dt>
<dd><p>Does in-place standardization of the in-memory
SNP data. By default, it applies &#8216;Unit&#8217; standardization, that is: the values for each SNP will have mean zero and standard deviation 1.0.
NaN values are then filled with zero, the mean (consequently, if there are NaN values, the final standard deviation will not be zero.
Note that, for efficiency, this method works in-place, actually changing values in the ndarray. Although it works in place, for convenience
it also returns the SnpData.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>standardizer</strong> (<a class="reference internal" href="#pysnptools.standardizer.Standardizer" title="pysnptools.standardizer.Standardizer"><code class="xref py py-class docutils literal"><span class="pre">Standardizer</span></code></a>) &#8211; optional &#8211; Specify standardization to be applied. 
Any <a class="reference internal" href="#pysnptools.standardizer.Standardizer" title="pysnptools.standardizer.Standardizer"><code class="xref py py-class docutils literal"><span class="pre">Standardizer</span></code></a> may be used. Some choices include <a class="reference internal" href="#pysnptools.standardizer.Unit" title="pysnptools.standardizer.Unit"><code class="xref py py-class docutils literal"><span class="pre">Unit</span></code></a> (default, makes values for each SNP have mean zero and
standard deviation 1.0) and <a class="reference internal" href="#pysnptools.standardizer.Beta" title="pysnptools.standardizer.Beta"><code class="xref py py-class docutils literal"><span class="pre">Beta</span></code></a>.</li>
<li><strong>block_size</strong> (<em>None</em>) &#8211; optional &#8211; Deprecated.</li>
<li><strong>return_trained</strong> (<em>boolean</em>) &#8211; If true, returns a second value containing a constant <a class="reference internal" href="#pysnptools.standardizer.Standardizer" title="pysnptools.standardizer.Standardizer"><code class="xref py py-class docutils literal"><span class="pre">Standardizer</span></code></a> trained on this data.</li>
<li><strong>force_python_only</strong> (<em>bool</em>) &#8211; optional &#8211; If true, will use pure Python instead of faster C++ libraries.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#pysnptools.snpreader.SnpData" title="pysnptools.snpreader.SnpData"><code class="xref py py-class docutils literal"><span class="pre">SnpData</span></code></a> (standardizes in place, but for convenience, returns &#8216;self&#8217;)</p>
</td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.snpreader</span> <span class="k">import</span> <span class="n">Bed</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snp_on_disk</span> <span class="o">=</span> <span class="n">Bed</span><span class="p">(</span><span class="s1">&#39;../../tests/datasets/all_chr.maf0.001.N300&#39;</span><span class="p">,</span><span class="n">count_A1</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="c1"># Specify some data on disk in Bed format</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snpdata1</span> <span class="o">=</span> <span class="n">snp_on_disk</span><span class="o">.</span><span class="n">read</span><span class="p">()</span> <span class="c1"># read all SNP values into memory</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">snpdata1</span> <span class="c1"># Prints the specification for this SnpData</span>
<span class="go">SnpData(Bed(&#39;../../tests/datasets/all_chr.maf0.001.N300&#39;,count_A1=False))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">snpdata1</span><span class="o">.</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
<span class="go">2.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snpdata1</span><span class="o">.</span><span class="n">standardize</span><span class="p">()</span> <span class="c1"># standardize changes the values in snpdata1.val and changes the specification.</span>
<span class="go">SnpData(Bed(&#39;../../tests/datasets/all_chr.maf0.001.N300&#39;,count_A1=False),Unit())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">snpdata1</span><span class="o">.</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
<span class="go">0.229415733871</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snpdata2</span> <span class="o">=</span> <span class="n">snp_on_disk</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">standardize</span><span class="p">()</span> <span class="c1"># Read and standardize in one expression with only one ndarray allocated.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">snpdata2</span><span class="o">.</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
<span class="go">0.229415733871</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pysnptools.snpreader.SnpData.train_standardizer">
<code class="descname">train_standardizer</code><span class="sig-paren">(</span><em>apply_in_place</em>, <em>standardizer=Unit()</em>, <em>force_python_only=False</em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.snpreader.SnpData.train_standardizer" title="Permalink to this definition">¶</a></dt>
<dd><div class="deprecated">
<p><span class="versionmodified">Deprecated since version 0.2.23: </span>Use <a class="reference internal" href="#pysnptools.snpreader.SnpData.standardize" title="pysnptools.snpreader.SnpData.standardize"><code class="xref py py-meth docutils literal"><span class="pre">standardize()</span></code></a> with return_trained=True instead.</p>
</div>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="snpreader-pheno">
<h3><code class="xref py py-class docutils literal"><span class="pre">snpreader.Pheno</span></code><a class="headerlink" href="#snpreader-pheno" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="pysnptools.snpreader.Pheno">
<em class="property">class </em><code class="descclassname">pysnptools.snpreader.</code><code class="descname">Pheno</code><span class="sig-paren">(</span><em>input</em>, <em>iid_if_none=None</em>, <em>missing=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.snpreader.Pheno" title="Permalink to this definition">¶</a></dt>
<dd><p>A <a class="reference internal" href="#pysnptools.snpreader.SnpReader" title="pysnptools.snpreader.SnpReader"><code class="xref py py-class docutils literal"><span class="pre">SnpReader</span></code></a> for reading &#8220;alternative alternative&#8221; phenotype files from disk.</p>
<p>See <a class="reference internal" href="#pysnptools.snpreader.SnpReader" title="pysnptools.snpreader.SnpReader"><code class="xref py py-class docutils literal"><span class="pre">SnpReader</span></code></a> for general examples of using SnpReaders.</p>
<p>This text format is described in <a class="reference external" href="http://pngu.mgh.harvard.edu/~purcell/plink/data.shtml#pheno">http://pngu.mgh.harvard.edu/~purcell/plink/data.shtml#pheno</a> and looks like:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">FID</span>    <span class="n">IID</span>      <span class="n">qt1</span>   <span class="n">bmi</span>    <span class="n">site</span>  
<span class="n">F1</span>     <span class="mi">1110</span>     <span class="mf">2.3</span>   <span class="mf">22.22</span>  <span class="mi">2</span>     
<span class="n">F2</span>     <span class="mi">2202</span>     <span class="mf">34.12</span> <span class="mf">18.23</span>  <span class="mi">1</span>     
<span class="o">...</span>
</pre></div>
</div>
<p>where the heading row is optional.</p>
<dl class="docutils">
<dt><strong>Constructor:</strong></dt>
<dd><table class="first docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>input</strong> (<em>string</em>) &#8211; The phenotype file to read.</li>
<li><strong>iid_if_none</strong> (<em>None</em> or array of strings) &#8211; An <a class="reference internal" href="#pysnptools.snpreader.SnpReader.iid" title="pysnptools.snpreader.SnpReader.iid"><code class="xref py py-attr docutils literal"><span class="pre">SnpReader.iid</span></code></a> to use if the file is empty.</li>
<li><strong>missing</strong> (<em>None</em> or string) &#8211; The value in the file that represents missing data.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>For backwards compatibility with older code, <strong>input</strong> can be a dictionary (instead of a filename) with these fields:</p>
<ul class="simple">
<li>&#8216;header&#8217; : [1] array phenotype name,</li>
<li>&#8216;vals&#8217;   : [N*1] array of phenotype data,</li>
<li>&#8216;iid&#8217;    : [N*2] array of family IDs and case IDs</li>
</ul>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.snpreader</span> <span class="k">import</span> <span class="n">Pheno</span><span class="p">,</span> <span class="n">Bed</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_on_disk</span> <span class="o">=</span> <span class="n">Pheno</span><span class="p">(</span><span class="s1">&#39;../examples/toydata.phe&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">data_on_disk</span><span class="o">.</span><span class="n">iid_count</span><span class="p">,</span> <span class="n">data_on_disk</span><span class="o">.</span><span class="n">sid_count</span>
<span class="go">500 1</span>
</pre></div>
</div>
</dd>
</dl>
<p><strong>Methods beyond</strong> <a class="reference internal" href="#pysnptools.snpreader.SnpReader" title="pysnptools.snpreader.SnpReader"><code class="xref py py-class docutils literal"><span class="pre">SnpReader</span></code></a></p>
<dl class="staticmethod">
<dt id="pysnptools.snpreader.Pheno.write">
<em class="property">static </em><code class="descname">write</code><span class="sig-paren">(</span><em>filename</em>, <em>snpdata</em>, <em>missing='NaN'</em>, <em>sep='\t'</em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.snpreader.Pheno.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes a <a class="reference internal" href="#pysnptools.snpreader.SnpData" title="pysnptools.snpreader.SnpData"><code class="xref py py-class docutils literal"><span class="pre">SnpData</span></code></a> to Pheno format.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.snpreader</span> <span class="k">import</span> <span class="n">Pheno</span><span class="p">,</span> <span class="n">Bed</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pysnptools.util</span> <span class="k">as</span> <span class="nn">pstutil</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snpdata</span> <span class="o">=</span> <span class="n">Bed</span><span class="p">(</span><span class="s1">&#39;../examples/toydata.bed&#39;</span><span class="p">,</span><span class="n">count_A1</span><span class="o">=</span><span class="kc">False</span><span class="p">)[:,:</span><span class="mi">10</span><span class="p">]</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>  <span class="c1"># Read first 10 snps from Bed format</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pstutil</span><span class="o">.</span><span class="n">create_directory_if_necessary</span><span class="p">(</span><span class="s2">&quot;tempdir/toydata10.phe&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Pheno</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;tempdir/toydata10.txt&quot;</span><span class="p">,</span><span class="n">snpdata</span><span class="p">)</span>       <span class="c1"># Write data in Pheno format</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="snpreader-ped">
<h3><code class="xref py py-class docutils literal"><span class="pre">snpreader.Ped</span></code><a class="headerlink" href="#snpreader-ped" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="pysnptools.snpreader.Ped">
<em class="property">class </em><code class="descclassname">pysnptools.snpreader.</code><code class="descname">Ped</code><span class="sig-paren">(</span><em>filename</em>, <em>missing='0'</em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.snpreader.Ped" title="Permalink to this definition">¶</a></dt>
<dd><p>A <a class="reference internal" href="#pysnptools.snpreader.SnpReader" title="pysnptools.snpreader.SnpReader"><code class="xref py py-class docutils literal"><span class="pre">SnpReader</span></code></a> for reading Ped-formated (and the related Map-formated) files from disk.</p>
<p>See <a class="reference internal" href="#pysnptools.snpreader.SnpReader" title="pysnptools.snpreader.SnpReader"><code class="xref py py-class docutils literal"><span class="pre">SnpReader</span></code></a> for general examples of using SnpReaders.</p>
<p>This format is described in <a class="reference external" href="http://pngu.mgh.harvard.edu/~purcell/plink/data.shtml#ped">http://pngu.mgh.harvard.edu/~purcell/plink/data.shtml#ped</a> and looks like:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">FAM001</span>  <span class="mi">1</span>  <span class="mi">0</span> <span class="mi">0</span>  <span class="mi">1</span>  <span class="mi">2</span>  <span class="n">A</span> <span class="n">A</span>  <span class="n">G</span> <span class="n">G</span>  <span class="n">A</span> <span class="n">C</span> 
<span class="n">FAM001</span>  <span class="mi">2</span>  <span class="mi">0</span> <span class="mi">0</span>  <span class="mi">1</span>  <span class="mi">2</span>  <span class="n">A</span> <span class="n">A</span>  <span class="n">A</span> <span class="n">G</span>  <span class="mi">0</span> <span class="mi">0</span> 
<span class="o">...</span>
</pre></div>
</div>
<p>the direction of the encoding from allele pair to 0,1,2 is arbitrary. That is, if the alleles are &#8220;A&#8221; and &#8220;G&#8221;, then &#8220;G G&#8221; could be 0 and &#8220;A A&#8221; could be 2 or visa versa. The pair &#8220;A G&#8221; will always be 1.</p>
<dl class="docutils">
<dt><strong>Constructor:</strong></dt>
<dd><table class="first docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>filename</strong> (<em>string</em>) &#8211; The Ped file to read.</li>
<li><strong>missing</strong> (<em>string</em>) &#8211; The value in the file that represents missing data.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.snpreader</span> <span class="k">import</span> <span class="n">Ped</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_on_disk</span> <span class="o">=</span> <span class="n">Ped</span><span class="p">(</span><span class="s1">&#39;../examples/toydata.ped&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">data_on_disk</span><span class="o">.</span><span class="n">iid_count</span><span class="p">,</span> <span class="n">data_on_disk</span><span class="o">.</span><span class="n">sid_count</span>
<span class="go">500 10000</span>
</pre></div>
</div>
</dd>
</dl>
<p><strong>Methods beyond</strong> <a class="reference internal" href="#pysnptools.snpreader.SnpReader" title="pysnptools.snpreader.SnpReader"><code class="xref py py-class docutils literal"><span class="pre">SnpReader</span></code></a></p>
<dl class="staticmethod">
<dt id="pysnptools.snpreader.Ped.write">
<em class="property">static </em><code class="descname">write</code><span class="sig-paren">(</span><em>filename</em>, <em>snpdata</em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.snpreader.Ped.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes a <a class="reference internal" href="#pysnptools.snpreader.SnpData" title="pysnptools.snpreader.SnpData"><code class="xref py py-class docutils literal"><span class="pre">SnpData</span></code></a> to Ped format. The values must be 0,1,2. The direction of the encoding to allele pairs is arbitrary. This means
that if a SnpData is written in Ped format and then read back, then 0&#8217;s may become 2&#8217;s and 2&#8217;s may become 0&#8217;s. (1&#8217;s will stay 1&#8217;s).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>filename</strong> (<em>string</em>) &#8211; the name of the file to create</li>
<li><strong>snpdata</strong> (<a class="reference internal" href="#pysnptools.snpreader.SnpData" title="pysnptools.snpreader.SnpData"><code class="xref py py-class docutils literal"><span class="pre">SnpData</span></code></a>) &#8211; The in-memory data that should be written to disk.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.snpreader</span> <span class="k">import</span> <span class="n">Ped</span><span class="p">,</span> <span class="n">Bed</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pysnptools.util</span> <span class="k">as</span> <span class="nn">pstutil</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snpdata</span> <span class="o">=</span> <span class="n">Bed</span><span class="p">(</span><span class="s1">&#39;../examples/toydata.bed&#39;</span><span class="p">,</span><span class="n">count_A1</span><span class="o">=</span><span class="kc">False</span><span class="p">)[:,:</span><span class="mi">10</span><span class="p">]</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>  <span class="c1"># Read first 10 snps from Bed format</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pstutil</span><span class="o">.</span><span class="n">create_directory_if_necessary</span><span class="p">(</span><span class="s2">&quot;tempdir/toydata10.ped&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Ped</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;tempdir/toydata10.ped&quot;</span><span class="p">,</span><span class="n">snpdata</span><span class="p">)</span>            <span class="c1"># Write data in Ped format</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="snpreader-dat">
<h3><code class="xref py py-class docutils literal"><span class="pre">snpreader.Dat</span></code><a class="headerlink" href="#snpreader-dat" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="pysnptools.snpreader.Dat">
<em class="property">class </em><code class="descclassname">pysnptools.snpreader.</code><code class="descname">Dat</code><span class="sig-paren">(</span><em>filename</em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.snpreader.Dat" title="Permalink to this definition">¶</a></dt>
<dd><p>A <a class="reference internal" href="#pysnptools.snpreader.SnpReader" title="pysnptools.snpreader.SnpReader"><code class="xref py py-class docutils literal"><span class="pre">SnpReader</span></code></a> for reading Dat/Fam/Map-formated files from disk.</p>
<p>See <a class="reference internal" href="#pysnptools.snpreader.SnpReader" title="pysnptools.snpreader.SnpReader"><code class="xref py py-class docutils literal"><span class="pre">SnpReader</span></code></a> for general examples of using SnpReaders.</p>
<p>This is a text format that can store any numeric values. (In contrast, Bed and Ped can only store 0,1,2, and missing). Its Dat files look like:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">null_0</span>          <span class="n">j</span>       <span class="n">n</span>       <span class="mf">0.333</span>   <span class="mi">1</span>       <span class="mi">2</span>
<span class="n">null_100</span>        <span class="n">j</span>       <span class="n">n</span>       <span class="mi">2</span>       <span class="mi">1</span>       <span class="mi">1</span>
<span class="n">null_200</span>        <span class="n">j</span>       <span class="n">n</span>       <span class="mi">0</span>       <span class="n">nan</span>     <span class="mi">1</span>
<span class="o">...</span>
</pre></div>
</div>
<p>Its Map and Fam files are described in <a class="reference external" href="http://pngu.mgh.harvard.edu/~purcell/plink/data.shtml">http://pngu.mgh.harvard.edu/~purcell/plink/data.shtml</a>.</p>
<dl class="docutils">
<dt><strong>Constructor:</strong></dt>
<dd><table class="first docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>filename</strong> (<em>string</em>) &#8211; The Dat file to read.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.snpreader</span> <span class="k">import</span> <span class="n">Dat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_on_disk</span> <span class="o">=</span> <span class="n">Dat</span><span class="p">(</span><span class="s1">&#39;../examples/toydata.dat&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">data_on_disk</span><span class="o">.</span><span class="n">iid_count</span><span class="p">,</span> <span class="n">data_on_disk</span><span class="o">.</span><span class="n">sid_count</span>
<span class="go">500 10000</span>
</pre></div>
</div>
</dd>
</dl>
<p><strong>Methods beyond</strong> <a class="reference internal" href="#pysnptools.snpreader.SnpReader" title="pysnptools.snpreader.SnpReader"><code class="xref py py-class docutils literal"><span class="pre">SnpReader</span></code></a></p>
<dl class="staticmethod">
<dt id="pysnptools.snpreader.Dat.write">
<em class="property">static </em><code class="descname">write</code><span class="sig-paren">(</span><em>filename</em>, <em>snpdata</em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.snpreader.Dat.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes a <a class="reference internal" href="#pysnptools.snpreader.SnpData" title="pysnptools.snpreader.SnpData"><code class="xref py py-class docutils literal"><span class="pre">SnpData</span></code></a> to dat/fam/map format.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>filename</strong> (<em>string</em>) &#8211; the name of the file to create</li>
<li><strong>snpdata</strong> (<a class="reference internal" href="#pysnptools.snpreader.SnpData" title="pysnptools.snpreader.SnpData"><code class="xref py py-class docutils literal"><span class="pre">SnpData</span></code></a>) &#8211; The in-memory data that should be written to disk.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.snpreader</span> <span class="k">import</span> <span class="n">Dat</span><span class="p">,</span> <span class="n">Bed</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pysnptools.util</span> <span class="k">as</span> <span class="nn">pstutil</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snpdata</span> <span class="o">=</span> <span class="n">Bed</span><span class="p">(</span><span class="s1">&#39;../examples/toydata.bed&#39;</span><span class="p">,</span><span class="n">count_A1</span><span class="o">=</span><span class="kc">False</span><span class="p">)[:,:</span><span class="mi">10</span><span class="p">]</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>  <span class="c1"># Read first 10 snps from Bed format</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pstutil</span><span class="o">.</span><span class="n">create_directory_if_necessary</span><span class="p">(</span><span class="s2">&quot;tempdir/toydata10.dat&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Dat</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;tempdir/toydata10.dat&quot;</span><span class="p">,</span><span class="n">snpdata</span><span class="p">)</span>              <span class="c1"># Write data in dat/fam/map format</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="snpreader-dense">
<h3><code class="xref py py-class docutils literal"><span class="pre">snpreader.Dense</span></code><a class="headerlink" href="#snpreader-dense" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="pysnptools.snpreader.Dense">
<em class="property">class </em><code class="descclassname">pysnptools.snpreader.</code><code class="descname">Dense</code><span class="sig-paren">(</span><em>filename</em>, <em>extract_iid_function=&lt;function zero_family at 0x0000000008C62908&gt;</em>, <em>extract_sid_pos_function=&lt;function zero_pos at 0x0000000008C6B6D8&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.snpreader.Dense" title="Permalink to this definition">¶</a></dt>
<dd><p>A <a class="reference internal" href="#pysnptools.snpreader.SnpReader" title="pysnptools.snpreader.SnpReader"><code class="xref py py-class docutils literal"><span class="pre">SnpReader</span></code></a> for reading *.dense.txt (0,1,2 text files) from disk.</p>
<p>See <a class="reference internal" href="#pysnptools.snpreader.SnpReader" title="pysnptools.snpreader.SnpReader"><code class="xref py py-class docutils literal"><span class="pre">SnpReader</span></code></a> for general examples of using SnpReaders.</p>
<p>This format looks like:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>var     4006    9570    22899   37676   41236   41978   55159   66828...
1-10004-rs12354060      22222222...
1-707348-rs12184279     222222?2...
1-724325-rs12564807     00000000...
...
</pre></div>
</div>
<p>where rows are sids and columns are iids.</p>
<dl class="docutils">
<dt><strong>Constructor:</strong></dt>
<dd><table class="first docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>filename</strong> (<em>string</em>) &#8211; The Dense file to read.</li>
<li><strong>extract_iid_function</strong> (<em>string</em>) &#8211; A function that breaks the row id from the file into a family id and an case id. Defaults to
setting the family id to 0 and using the whole row id as the iid.</li>
<li><strong>extract_sid_pos_function</strong> (<em>string</em>) &#8211; A function that breaks the column id from the file into (chromosome, sid, genetic distance, basepair distance).
Defaults to setting the <a class="reference internal" href="#pysnptools.snpreader.SnpReader.pos" title="pysnptools.snpreader.SnpReader.pos"><code class="xref py py-attr docutils literal"><span class="pre">SnpReader.pos</span></code></a> information to 0 and using the whole column id as the sid.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.snpreader</span> <span class="k">import</span> <span class="n">Dense</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_on_disk</span> <span class="o">=</span> <span class="n">Dense</span><span class="p">(</span><span class="s1">&#39;../examples/toydata100.dense.txt&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">data_on_disk</span><span class="o">.</span><span class="n">iid_count</span><span class="p">,</span> <span class="n">data_on_disk</span><span class="o">.</span><span class="n">sid_count</span>
<span class="go">500 100</span>
</pre></div>
</div>
</dd>
</dl>
<p><strong>Methods beyond</strong> <a class="reference internal" href="#pysnptools.snpreader.SnpReader" title="pysnptools.snpreader.SnpReader"><code class="xref py py-class docutils literal"><span class="pre">SnpReader</span></code></a></p>
<dl class="staticmethod">
<dt id="pysnptools.snpreader.Dense.write">
<em class="property">static </em><code class="descname">write</code><span class="sig-paren">(</span><em>filename</em>, <em>snpdata</em>, <em>join_iid_function=&lt;function just_case at 0x0000000008C6B748&gt;</em>, <em>join_sid_pos_function=&lt;function just_sid at 0x0000000008C6B7B8&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.snpreader.Dense.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes a <a class="reference internal" href="#pysnptools.snpreader.SnpData" title="pysnptools.snpreader.SnpData"><code class="xref py py-class docutils literal"><span class="pre">SnpData</span></code></a> to Dense format. The values must be 0,1,2 (or missing).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>filename</strong> (<em>string</em>) &#8211; the name of the file to create</li>
<li><strong>snpdata</strong> (<a class="reference internal" href="#pysnptools.snpreader.SnpData" title="pysnptools.snpreader.SnpData"><code class="xref py py-class docutils literal"><span class="pre">SnpData</span></code></a>) &#8211; The in-memory data that should be written to disk.</li>
<li><strong>join_iid_function</strong> (<em>a function</em>) &#8211; function to turn a family id and case id into a file id for columns.
Defaults ignoring the family id and using the case id as the column id.</li>
<li><strong>join_sid_pos_function</strong> (<em>a function</em>) &#8211; function to turn a sid and pos data into a file id for rows.
Defaults ignoring the <a class="reference internal" href="#pysnptools.snpreader.SnpReader.pos" title="pysnptools.snpreader.SnpReader.pos"><code class="xref py py-attr docutils literal"><span class="pre">SnpReader.pos</span></code></a> information and using the sid id as the row id.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.snpreader</span> <span class="k">import</span> <span class="n">Dense</span><span class="p">,</span> <span class="n">Bed</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pysnptools.util</span> <span class="k">as</span> <span class="nn">pstutil</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snpdata</span> <span class="o">=</span> <span class="n">Bed</span><span class="p">(</span><span class="s1">&#39;../examples/toydata.bed&#39;</span><span class="p">,</span><span class="n">count_A1</span><span class="o">=</span><span class="kc">False</span><span class="p">)[:,:</span><span class="mi">10</span><span class="p">]</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>  <span class="c1"># Read first 10 snps from Bed format</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pstutil</span><span class="o">.</span><span class="n">create_directory_if_necessary</span><span class="p">(</span><span class="s2">&quot;tempdir/toydata10.dense.txt&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Dense</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;tempdir/toydata10.dense.txt&quot;</span><span class="p">,</span><span class="n">snpdata</span><span class="p">)</span>        <span class="c1"># Write data in Dense format</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="snpreader-snphdf5">
<h3><code class="xref py py-class docutils literal"><span class="pre">snpreader.SnpHdf5</span></code><a class="headerlink" href="#snpreader-snphdf5" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="pysnptools.snpreader.SnpHdf5">
<em class="property">class </em><code class="descclassname">pysnptools.snpreader.</code><code class="descname">SnpHdf5</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.snpreader.SnpHdf5" title="Permalink to this definition">¶</a></dt>
<dd><p>A <a class="reference internal" href="#pysnptools.snpreader.SnpReader" title="pysnptools.snpreader.SnpReader"><code class="xref py py-class docutils literal"><span class="pre">SnpReader</span></code></a> for reading *.snp.hdf5 files from disk.</p>
<p>See <a class="reference internal" href="#pysnptools.snpreader.SnpReader" title="pysnptools.snpreader.SnpReader"><code class="xref py py-class docutils literal"><span class="pre">SnpReader</span></code></a> for general examples of using SnpReaders.</p>
<p>The general HDF5 format is described in <a class="reference external" href="http://www.hdfgroup.org/HDF5/">http://www.hdfgroup.org/HDF5/</a>. The SnpHdf5 format stores
val, iid, sid, and pos information in Hdf5 format.</p>
<dl class="docutils">
<dt><strong>Constructor:</strong></dt>
<dd><table class="first docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>filename</strong> (<em>string</em>) &#8211; The SnpHdf5 file to read.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.snpreader</span> <span class="k">import</span> <span class="n">SnpHdf5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_on_disk</span> <span class="o">=</span> <span class="n">SnpHdf5</span><span class="p">(</span><span class="s1">&#39;../examples/toydata.snpmajor.snp.hdf5&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">data_on_disk</span><span class="o">.</span><span class="n">iid_count</span><span class="p">,</span> <span class="n">data_on_disk</span><span class="o">.</span><span class="n">sid_count</span>
<span class="go">500 10000</span>
</pre></div>
</div>
</dd>
</dl>
<p><strong>Methods beyond</strong> <a class="reference internal" href="#pysnptools.snpreader.SnpReader" title="pysnptools.snpreader.SnpReader"><code class="xref py py-class docutils literal"><span class="pre">SnpReader</span></code></a></p>
<dl class="staticmethod">
<dt id="pysnptools.snpreader.SnpHdf5.write">
<em class="property">static </em><code class="descname">write</code><span class="sig-paren">(</span><em>filename</em>, <em>snpdata</em>, <em>hdf5_dtype=None</em>, <em>sid_major=True</em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.snpreader.SnpHdf5.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes a <a class="reference internal" href="#pysnptools.snpreader.SnpData" title="pysnptools.snpreader.SnpData"><code class="xref py py-class docutils literal"><span class="pre">SnpData</span></code></a> to SnpHdf5 format.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>filename</strong> (<em>string</em>) &#8211; the name of the file to create</li>
<li><strong>snpdata</strong> (<a class="reference internal" href="#pysnptools.snpreader.SnpData" title="pysnptools.snpreader.SnpData"><code class="xref py py-class docutils literal"><span class="pre">SnpData</span></code></a>) &#8211; The in-memory data that should be written to disk.</li>
<li><strong>hdf5_dtype</strong> (<em>string</em>) &#8211; None (use the .val&#8217;s dtype) or a Hdf5 dtype, e.g. &#8216;f8&#8217;,&#8217;f4&#8217;,etc.</li>
<li><strong>col_major</strong> (<em>bool</em>) &#8211; Tells if vals should be stored on disk in sid_major (default) or iid_major format.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.snpreader</span> <span class="k">import</span> <span class="n">SnpHdf5</span><span class="p">,</span> <span class="n">Bed</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pysnptools.util</span> <span class="k">as</span> <span class="nn">pstutil</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snpdata</span> <span class="o">=</span> <span class="n">Bed</span><span class="p">(</span><span class="s1">&#39;../examples/toydata.bed&#39;</span><span class="p">,</span><span class="n">count_A1</span><span class="o">=</span><span class="kc">False</span><span class="p">)[:,:</span><span class="mi">10</span><span class="p">]</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>     <span class="c1"># Read first 10 snps from Bed format</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pstutil</span><span class="o">.</span><span class="n">create_directory_if_necessary</span><span class="p">(</span><span class="s2">&quot;tempdir/toydata10.snp.hdf5&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">SnpHdf5</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;tempdir/toydata10.snp.hdf5&quot;</span><span class="p">,</span><span class="n">snpdata</span><span class="p">)</span>        <span class="c1"># Write data in SnpHdf5 format</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="snpreader-snpnpz">
<h3><code class="xref py py-class docutils literal"><span class="pre">snpreader.SnpNpz</span></code><a class="headerlink" href="#snpreader-snpnpz" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="pysnptools.snpreader.SnpNpz">
<em class="property">class </em><code class="descclassname">pysnptools.snpreader.</code><code class="descname">SnpNpz</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.snpreader.SnpNpz" title="Permalink to this definition">¶</a></dt>
<dd><p>A <a class="reference internal" href="#pysnptools.snpreader.SnpReader" title="pysnptools.snpreader.SnpReader"><code class="xref py py-class docutils literal"><span class="pre">SnpReader</span></code></a> for reading *.snp.npz files from disk.</p>
<p>See <a class="reference internal" href="#pysnptools.snpreader.SnpReader" title="pysnptools.snpreader.SnpReader"><code class="xref py py-class docutils literal"><span class="pre">SnpReader</span></code></a> for general examples of using SnpReaders.</p>
<p>The general NPZ format is described in <a class="reference external" href="http://docs.scipy.org/doc/numpy/reference/generated/numpy.savez.html">http://docs.scipy.org/doc/numpy/reference/generated/numpy.savez.html</a>. The SnpNpz format stores
val, iid, sid, and pos information in NPZ format.</p>
<dl class="docutils">
<dt><strong>Constructor:</strong></dt>
<dd><table class="first docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>filename</strong> (<em>string</em>) &#8211; The SnpNpz file to read.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.snpreader</span> <span class="k">import</span> <span class="n">SnpNpz</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_on_disk</span> <span class="o">=</span> <span class="n">SnpNpz</span><span class="p">(</span><span class="s1">&#39;../examples/toydata10.snp.npz&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">data_on_disk</span><span class="o">.</span><span class="n">iid_count</span><span class="p">,</span> <span class="n">data_on_disk</span><span class="o">.</span><span class="n">sid_count</span>
<span class="go">500 10</span>
</pre></div>
</div>
</dd>
</dl>
<p><strong>Methods beyond</strong> <a class="reference internal" href="#pysnptools.snpreader.SnpReader" title="pysnptools.snpreader.SnpReader"><code class="xref py py-class docutils literal"><span class="pre">SnpReader</span></code></a></p>
<dl class="staticmethod">
<dt id="pysnptools.snpreader.SnpNpz.write">
<em class="property">static </em><code class="descname">write</code><span class="sig-paren">(</span><em>filename</em>, <em>snpdata</em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.snpreader.SnpNpz.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes a <a class="reference internal" href="#pysnptools.snpreader.SnpData" title="pysnptools.snpreader.SnpData"><code class="xref py py-class docutils literal"><span class="pre">SnpData</span></code></a> to SnpNpz format.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>filename</strong> (<em>string</em>) &#8211; the name of the file to create</li>
<li><strong>snpdata</strong> (<a class="reference internal" href="#pysnptools.snpreader.SnpData" title="pysnptools.snpreader.SnpData"><code class="xref py py-class docutils literal"><span class="pre">SnpData</span></code></a>) &#8211; The in-memory data that should be written to disk.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.snpreader</span> <span class="k">import</span> <span class="n">SnpNpz</span><span class="p">,</span> <span class="n">Bed</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pysnptools.util</span> <span class="k">as</span> <span class="nn">pstutil</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snpdata</span> <span class="o">=</span> <span class="n">Bed</span><span class="p">(</span><span class="s1">&#39;../examples/toydata.bed&#39;</span><span class="p">,</span><span class="n">count_A1</span><span class="o">=</span><span class="kc">False</span><span class="p">)[:,:</span><span class="mi">10</span><span class="p">]</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>     <span class="c1"># Read first 10 snps from Bed format</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pstutil</span><span class="o">.</span><span class="n">create_directory_if_necessary</span><span class="p">(</span><span class="s2">&quot;tempdir/toydata10.snp.npz&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">SnpNpz</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;tempdir/toydata10.snp.npz&quot;</span><span class="p">,</span><span class="n">snpdata</span><span class="p">)</span>          <span class="c1"># Write data in SnpNpz format</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</div>
</div>
<div class="section" id="module-pysnptools.kernelreader">
<span id="kernelreader-module"></span><h2><code class="xref py py-mod docutils literal"><span class="pre">kernelreader</span></code> Module<a class="headerlink" href="#module-pysnptools.kernelreader" title="Permalink to this headline">¶</a></h2>
<p>Tools for reading and manipulating kernels. A kernels is a matrix from iid to iid that typically tells the relatedness of pairs of people.</p>
<div class="section" id="kernelreader-kernelreader">
<h3><code class="xref py py-class docutils literal"><span class="pre">kernelreader.KernelReader</span></code><a class="headerlink" href="#kernelreader-kernelreader" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="pysnptools.kernelreader.KernelReader">
<em class="property">class </em><code class="descclassname">pysnptools.kernelreader.</code><code class="descname">KernelReader</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.kernelreader.KernelReader" title="Permalink to this definition">¶</a></dt>
<dd><p>A KernelReader is one of three things:</p>
<ul>
<li><p class="first">A class such as <a class="reference internal" href="#pysnptools.kernelreader.KernelNpz" title="pysnptools.kernelreader.KernelNpz"><code class="xref py py-class docutils literal"><span class="pre">KernelNpz</span></code></a> for you to specify data in a file. For example,</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.kernelreader</span> <span class="k">import</span> <span class="n">KernelNpz</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kernel_on_disk</span> <span class="o">=</span> <span class="n">KernelNpz</span><span class="p">(</span><span class="s1">&#39;../examples/toydata.kernel.npz&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">kernel_on_disk</span> <span class="c1"># prints specification for reading from file</span>
<span class="go">KernelNpz(&#39;../examples/toydata.kernel.npz&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kernel_on_disk</span><span class="o">.</span><span class="n">iid_count</span> <span class="c1"># prints the number of iids (but doesn&#39;t read any kernel values)</span>
<span class="go">500</span>
</pre></div>
</div>
</li>
<li><p class="first">A <a class="reference internal" href="#pysnptools.kernelreader.KernelData" title="pysnptools.kernelreader.KernelData"><code class="xref py py-class docutils literal"><span class="pre">KernelData</span></code></a> class that holds kernel data in memory, typically after computing from a SnpReader or reading it from a KernelReader:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Compute kernel from a SnpReader</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.snpreader</span> <span class="k">import</span> <span class="n">Bed</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.standardizer</span> <span class="k">import</span> <span class="n">Unit</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snp_on_disk</span> <span class="o">=</span> <span class="n">Bed</span><span class="p">(</span><span class="s1">&#39;../../tests/datasets/all_chr.maf0.001.N300&#39;</span><span class="p">,</span><span class="n">count_A1</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kerneldata1</span> <span class="o">=</span> <span class="n">snp_on_disk</span><span class="o">.</span><span class="n">read_kernel</span><span class="p">(</span><span class="n">Unit</span><span class="p">())</span> <span class="c1">#reads the SNP values and computes the kernel</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">type</span><span class="p">(</span><span class="n">kerneldata1</span><span class="o">.</span><span class="n">val</span><span class="p">)</span> <span class="c1"># The val property is an ndarray of kernel values</span>
<span class="go">&lt;type &#39;numpy.ndarray&#39;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">kerneldata1</span> <span class="c1"># prints the specification of the in-memory kernel information</span>
<span class="go">KernelData(SnpKernel(Bed(&#39;../../tests/datasets/all_chr.maf0.001.N300&#39;,count_A1=False),standardizer=Unit()))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kerneldata1</span><span class="o">.</span><span class="n">iid_count</span> <span class="c1">#prints the number of iids (number of individuals) in this in-memory data</span>
<span class="go">300</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Read kernel from a KernelReader</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kernel_on_disk</span> <span class="o">=</span> <span class="n">KernelNpz</span><span class="p">(</span><span class="s1">&#39;../examples/toydata.kernel.npz&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kerneldata2</span> <span class="o">=</span> <span class="n">kernel_on_disk</span><span class="o">.</span><span class="n">read</span><span class="p">()</span> <span class="c1">#reads the kernel values</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">kerneldata2</span> <span class="c1"># prints the specification of the in-memory kernel information</span>
<span class="go">KernelData(KernelNpz(&#39;../examples/toydata.kernel.npz&#39;))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kerneldata2</span><span class="o">.</span><span class="n">iid_count</span> <span class="c1">#prints the number of iids (number of individuals) in this in-memory data</span>
<span class="go">500</span>
</pre></div>
</div>
</li>
<li><p class="first">A subset of any KernelReader, specified with &#8220;[ <em>iid_index</em> ]&#8221; (or  specified with &#8220;[ <em>iid0_index</em> , <em>iid1_index</em> ]&#8221;), to read only some kernel values. It can
also be used to re-order the values.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">kernel_on_disk</span> <span class="o">=</span> <span class="n">KernelNpz</span><span class="p">(</span><span class="s1">&#39;../examples/toydata.kernel.npz&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">subset_on_disk1</span> <span class="o">=</span> <span class="n">kernel_on_disk</span><span class="p">[[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]]</span> <span class="c1"># specification for a subset of the data on disk. No kernel values are read yet.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">subset_on_disk1</span><span class="o">.</span><span class="n">iid_count</span> <span class="c1"># prints the number of iids in this subset (but still doesn&#39;t read any kernel values)</span>
<span class="go">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">subset_on_disk1</span> <span class="c1">#prints a specification of &#39;subset_on_disk1&#39;</span>
<span class="go">KernelNpz(&#39;../examples/toydata.kernel.npz&#39;)[[3,4],[3,4]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kerneldata_subset</span> <span class="o">=</span> <span class="n">subset_on_disk1</span><span class="o">.</span><span class="n">read</span><span class="p">()</span> <span class="c1"># efficiently (if possible) reads the specified subset of values from the disk</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">kerneldata_subset</span> <span class="c1"># prints the specification of the in-memory kernel information</span>
<span class="go">KernelData(KernelNpz(&#39;../examples/toydata.kernel.npz&#39;)[[3,4],[3,4]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="nb">int</span><span class="p">(</span><span class="n">kerneldata_subset</span><span class="o">.</span><span class="n">val</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">kerneldata_subset</span><span class="o">.</span><span class="n">val</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="c1"># The dimensions of the ndarray of kernel values</span>
<span class="go">2 2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">subset_on_disk2</span> <span class="o">=</span> <span class="n">kernel_on_disk</span><span class="p">[[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],::</span><span class="mi">2</span><span class="p">]</span> <span class="c1"># specification for a subset of the data on disk. No kernel values are read yet.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">subset_on_disk2</span><span class="o">.</span><span class="n">iid0_count</span><span class="p">,</span> <span class="n">subset_on_disk2</span><span class="o">.</span><span class="n">iid1_count</span>
<span class="go">2 250</span>
</pre></div>
</div>
</li>
</ul>
<p>The KernelReaders Classes</p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="30%" />
<col width="16%" />
<col width="20%" />
<col width="16%" />
<col width="18%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><em>Class</em></td>
<td><em>Format</em></td>
<td><em>Random Access</em></td>
<td><em>Suffixes</em></td>
<td><em>Write</em> method?</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#pysnptools.kernelreader.KernelData" title="pysnptools.kernelreader.KernelData"><code class="xref py py-class docutils literal"><span class="pre">KernelData</span></code></a></td>
<td>in-memory</td>
<td>Yes</td>
<td><em>n/a</em></td>
<td><em>n/a</em></td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#pysnptools.kernelreader.KernelNpz" title="pysnptools.kernelreader.KernelNpz"><code class="xref py py-class docutils literal"><span class="pre">KernelNpz</span></code></a></td>
<td>binary</td>
<td>No</td>
<td>.kernel.npz</td>
<td>Yes</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#pysnptools.kernelreader.KernelHdf5" title="pysnptools.kernelreader.KernelHdf5"><code class="xref py py-class docutils literal"><span class="pre">KernelHdf5</span></code></a></td>
<td>binary</td>
<td>Yes</td>
<td>.kernel.hdf5</td>
<td>Yes</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#pysnptools.kernelreader.Identity" title="pysnptools.kernelreader.Identity"><code class="xref py py-class docutils literal"><span class="pre">Identity</span></code></a></td>
<td><em>n/a</em></td>
<td>Yes</td>
<td><em>n/a</em></td>
<td>No</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#pysnptools.kernelreader.SnpKernel" title="pysnptools.kernelreader.SnpKernel"><code class="xref py py-class docutils literal"><span class="pre">SnpKernel</span></code></a></td>
<td>depends</td>
<td>depends</td>
<td><em>n/a</em></td>
<td>No</td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>Methods &amp; Properties:</p>
<blockquote>
<div><p>Every KernelReader, such as <a class="reference internal" href="#pysnptools.kernelreader.KernelNpz" title="pysnptools.kernelreader.KernelNpz"><code class="xref py py-class docutils literal"><span class="pre">KernelNpz</span></code></a> and <a class="reference internal" href="#pysnptools.kernelreader.KernelData" title="pysnptools.kernelreader.KernelData"><code class="xref py py-class docutils literal"><span class="pre">KernelData</span></code></a>, when square has these properties: <a class="reference internal" href="#pysnptools.kernelreader.KernelReader.iid" title="pysnptools.kernelreader.KernelReader.iid"><code class="xref py py-attr docutils literal"><span class="pre">iid</span></code></a>, <a class="reference internal" href="#pysnptools.kernelreader.KernelReader.iid_count" title="pysnptools.kernelreader.KernelReader.iid_count"><code class="xref py py-attr docutils literal"><span class="pre">iid_count</span></code></a>, 
and these methods: <a class="reference internal" href="#pysnptools.kernelreader.KernelReader.read" title="pysnptools.kernelreader.KernelReader.read"><code class="xref py py-meth docutils literal"><span class="pre">read()</span></code></a>, and <a class="reference internal" href="#pysnptools.kernelreader.KernelReader.iid_to_index" title="pysnptools.kernelreader.KernelReader.iid_to_index"><code class="xref py py-meth docutils literal"><span class="pre">iid_to_index()</span></code></a>. A square kernel is one that has the same iid list for both its rows and columns.</p>
<p>More generally, KernelReaders can have one iid list for its rows and a different iid list for its columns, so these properties and methods are also defined: <a class="reference internal" href="#pysnptools.kernelreader.KernelReader.iid0" title="pysnptools.kernelreader.KernelReader.iid0"><code class="xref py py-attr docutils literal"><span class="pre">iid0</span></code></a>, <a class="reference internal" href="#pysnptools.kernelreader.KernelReader.iid1" title="pysnptools.kernelreader.KernelReader.iid1"><code class="xref py py-attr docutils literal"><span class="pre">iid1</span></code></a>, <a class="reference internal" href="#pysnptools.kernelreader.KernelReader.iid0_count" title="pysnptools.kernelreader.KernelReader.iid0_count"><code class="xref py py-attr docutils literal"><span class="pre">iid0_count</span></code></a>, 
<a class="reference internal" href="#pysnptools.kernelreader.KernelReader.iid1_count" title="pysnptools.kernelreader.KernelReader.iid1_count"><code class="xref py py-attr docutils literal"><span class="pre">iid1_count</span></code></a>, <a class="reference internal" href="#pysnptools.kernelreader.KernelReader.iid0_to_index" title="pysnptools.kernelreader.KernelReader.iid0_to_index"><code class="xref py py-meth docutils literal"><span class="pre">iid0_to_index()</span></code></a>, and <a class="reference internal" href="#pysnptools.kernelreader.KernelReader.iid1_to_index" title="pysnptools.kernelreader.KernelReader.iid1_to_index"><code class="xref py py-meth docutils literal"><span class="pre">iid1_to_index()</span></code></a>.</p>
<p>See below for details.</p>
<p><a class="reference internal" href="#pysnptools.kernelreader.KernelData" title="pysnptools.kernelreader.KernelData"><code class="xref py py-class docutils literal"><span class="pre">KernelData</span></code></a> is a KernelReader so it supports the above properties and methods. In addition, it supports property <code class="xref py py-attr docutils literal"><span class="pre">KernelData.val</span></code>, method <a class="reference internal" href="#pysnptools.kernelreader.KernelData.standardize" title="pysnptools.kernelreader.KernelData.standardize"><code class="xref py py-meth docutils literal"><span class="pre">KernelData.standardize()</span></code></a>, and equality testing.
See below for details.</p>
<p>Some of the classes, such as <a class="reference internal" href="#pysnptools.kernelreader.KernelNpz" title="pysnptools.kernelreader.KernelNpz"><code class="xref py py-class docutils literal"><span class="pre">KernelNpz</span></code></a>, also provide a static <a class="reference internal" href="#pysnptools.kernelreader.KernelNpz.write" title="pysnptools.kernelreader.KernelNpz.write"><code class="xref py py-meth docutils literal"><span class="pre">KernelNpz.write()</span></code></a> method for writing <a class="reference internal" href="#pysnptools.kernelreader.KernelData" title="pysnptools.kernelreader.KernelData"><code class="xref py py-class docutils literal"><span class="pre">KernelData</span></code></a>.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># create a kernel from a Bed file and write to KernelNpz format</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.snpreader</span> <span class="k">import</span> <span class="n">Bed</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.standardizer</span> <span class="k">import</span> <span class="n">Unit</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pysnptools.util</span> <span class="k">as</span> <span class="nn">pstutil</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kerneldata</span> <span class="o">=</span> <span class="n">Bed</span><span class="p">(</span><span class="s1">&#39;../examples/toydata.bed&#39;</span><span class="p">,</span><span class="n">count_A1</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">read_kernel</span><span class="p">(</span><span class="n">Unit</span><span class="p">())</span>     <span class="c1"># Create a kernel from the data in the Bed file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pstutil</span><span class="o">.</span><span class="n">create_directory_if_necessary</span><span class="p">(</span><span class="s2">&quot;tempdir/toydata.kernel.npz&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">KernelNpz</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;tempdir/toydata.kernel.npz&quot;</span><span class="p">,</span><span class="n">kerneldata</span><span class="p">)</span>      <span class="c1"># Write data in KernelNpz format</span>
</pre></div>
</div>
</div></blockquote>
<p>iids:</p>
<blockquote>
<div><p>Individual are identified with an iid, which is a ndarray of two strings: a family ID and a case ID. For example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">kernel_on_disk</span> <span class="o">=</span> <span class="n">KernelNpz</span><span class="p">(</span><span class="s1">&#39;../examples/toydata.kernel.npz&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">kernel_on_disk</span><span class="o">.</span><span class="n">iid</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span> <span class="c1"># print the first three iids</span>
<span class="go">[[&#39;per0&#39; &#39;per0&#39;]</span>
<span class="go"> [&#39;per1&#39; &#39;per1&#39;]</span>
<span class="go"> [&#39;per2&#39; &#39;per2&#39;]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">kernel_on_disk</span><span class="o">.</span><span class="n">iid_to_index</span><span class="p">([[</span><span class="s1">&#39;per2&#39;</span><span class="p">,</span><span class="s1">&#39;per2&#39;</span><span class="p">],[</span><span class="s1">&#39;per1&#39;</span><span class="p">,</span><span class="s1">&#39;per1&#39;</span><span class="p">]])</span> <span class="c1">#Find the indexes for two iids.</span>
<span class="go">[2 1]</span>
</pre></div>
</div>
</div></blockquote>
<p><a class="reference internal" href="#pysnptools.kernelreader.KernelReader" title="pysnptools.kernelreader.KernelReader"><code class="xref py py-class docutils literal"><span class="pre">KernelReader</span></code></a> is a kind of <a class="reference internal" href="#pysnptools.pstreader.PstReader" title="pysnptools.pstreader.PstReader"><code class="xref py py-class docutils literal"><span class="pre">PstReader</span></code></a>. See the documentation for <a class="reference internal" href="#pysnptools.pstreader.PstReader" title="pysnptools.pstreader.PstReader"><code class="xref py py-class docutils literal"><span class="pre">PstReader</span></code></a> to learn about:</p>
<blockquote>
<div><ul class="simple">
<li>When Data is Read</li>
<li>When Data is Re-Read and Copied</li>
<li>Avoiding Unwanted ndarray Allocations</li>
<li>Creating Subsetting PstReaders with Indexing</li>
</ul>
</div></blockquote>
<p>The <a class="reference internal" href="#pysnptools.kernelreader.KernelReader.read" title="pysnptools.kernelreader.KernelReader.read"><code class="xref py py-meth docutils literal"><span class="pre">read()</span></code></a> Method</p>
<blockquote>
<div>By default the <a class="reference internal" href="#pysnptools.kernelreader.KernelReader.read" title="pysnptools.kernelreader.KernelReader.read"><code class="xref py py-meth docutils literal"><span class="pre">read()</span></code></a> returns a ndarray of scipy.float64 laid out in memory in F-contiguous order (iid0-index varies the fastest). You may, instead,
ask for scipy.float32 or for C-contiguous order or any order. See <a class="reference internal" href="#pysnptools.kernelreader.KernelReader.read" title="pysnptools.kernelreader.KernelReader.read"><code class="xref py py-meth docutils literal"><span class="pre">read()</span></code></a> for details.</div></blockquote>
<dl class="docutils">
<dt>The <a class="reference internal" href="#pysnptools.kernelreader.KernelData.standardize" title="pysnptools.kernelreader.KernelData.standardize"><code class="xref py py-meth docutils literal"><span class="pre">KernelData.standardize()</span></code></a> Method</dt>
<dd><p class="first">The <a class="reference internal" href="#pysnptools.kernelreader.KernelData.standardize" title="pysnptools.kernelreader.KernelData.standardize"><code class="xref py py-meth docutils literal"><span class="pre">KernelData.standardize()</span></code></a> method, available only on <a class="reference internal" href="#pysnptools.kernelreader.KernelData" title="pysnptools.kernelreader.KernelData"><code class="xref py py-class docutils literal"><span class="pre">KernelData</span></code></a>, does in-place standardization of the in-memory
kernel data. The method multiples the values with a scalar factor such that the diagonal sums to iid_count. Although it works in place, for convenience
it also returns itself. See <a class="reference internal" href="#pysnptools.kernelreader.KernelData.standardize" title="pysnptools.kernelreader.KernelData.standardize"><code class="xref py py-meth docutils literal"><span class="pre">KernelData.standardize()</span></code></a> for details.</p>
<div class="last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">kernel_on_disk</span> <span class="o">=</span> <span class="n">KernelNpz</span><span class="p">(</span><span class="s1">&#39;../examples/toydata.kernel.npz&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kerneldata1</span> <span class="o">=</span> <span class="n">kernel_on_disk</span><span class="o">.</span><span class="n">read</span><span class="p">()</span> <span class="c1"># read all kernel values into memory</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">kerneldata1</span><span class="o">.</span><span class="n">val</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="go">5000000.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kerneldata1</span><span class="o">.</span><span class="n">standardize</span><span class="p">()</span> <span class="c1"># standardize changes the values in kerneldata1.val</span>
<span class="go">KernelData(KernelNpz(&#39;../examples/toydata.kernel.npz&#39;))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">kerneldata1</span><span class="o">.</span><span class="n">val</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="go">500.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kerneldata2</span> <span class="o">=</span> <span class="n">kernel_on_disk</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">standardize</span><span class="p">()</span> <span class="c1"># Read and standardize in one expression with only one ndarray allocated.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">kerneldata2</span><span class="o">.</span><span class="n">val</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="go">500.0</span>
</pre></div>
</div>
</dd>
</dl>
<p>Details of Methods &amp; Properties:</p>
<dl class="attribute">
<dt id="pysnptools.kernelreader.KernelReader.iid">
<code class="descname">iid</code><a class="headerlink" href="#pysnptools.kernelreader.KernelReader.iid" title="Permalink to this definition">¶</a></dt>
<dd><p>A ndarray of the iids. Each iid is a ndarray of two strings (a family ID and a case ID) that identifies an individual.
Assumes the kernel is square, so will throw an exception if the row iids are different from the column iids.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">ndarray (length <a class="reference internal" href="#pysnptools.kernelreader.KernelReader.iid_count" title="pysnptools.kernelreader.KernelReader.iid_count"><code class="xref py py-attr docutils literal"><span class="pre">iid_count</span></code></a>) of ndarray (length 2) of strings</td>
</tr>
</tbody>
</table>
<p>This property (to the degree practical) reads only iid and sid data from the disk, not kernel value data. Moreover, the iid data is read from file only once.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.kernelreader</span> <span class="k">import</span> <span class="n">KernelNpz</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kernel_on_disk</span> <span class="o">=</span> <span class="n">KernelNpz</span><span class="p">(</span><span class="s1">&#39;../examples/toydata.kernel.npz&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">kernel_on_disk</span><span class="o">.</span><span class="n">iid</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span> <span class="c1"># print the first three iids</span>
<span class="go">[[&#39;per0&#39; &#39;per0&#39;]</span>
<span class="go"> [&#39;per1&#39; &#39;per1&#39;]</span>
<span class="go"> [&#39;per2&#39; &#39;per2&#39;]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="pysnptools.kernelreader.KernelReader.iid0">
<code class="descname">iid0</code><a class="headerlink" href="#pysnptools.kernelreader.KernelReader.iid0" title="Permalink to this definition">¶</a></dt>
<dd><p>A ndarray of the row iids. See <a class="reference internal" href="#pysnptools.kernelreader.KernelReader.iid" title="pysnptools.kernelreader.KernelReader.iid"><code class="xref py py-attr docutils literal"><span class="pre">iid</span></code></a></p>
</dd></dl>

<dl class="attribute">
<dt id="pysnptools.kernelreader.KernelReader.iid0_count">
<code class="descname">iid0_count</code><a class="headerlink" href="#pysnptools.kernelreader.KernelReader.iid0_count" title="Permalink to this definition">¶</a></dt>
<dd><p>number of row iids. See <a class="reference internal" href="#pysnptools.kernelreader.KernelReader.iid_count" title="pysnptools.kernelreader.KernelReader.iid_count"><code class="xref py py-attr docutils literal"><span class="pre">iid_count</span></code></a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">integer</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pysnptools.kernelreader.KernelReader.iid0_to_index">
<code class="descname">iid0_to_index</code><span class="sig-paren">(</span><em>list</em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.kernelreader.KernelReader.iid0_to_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes a list of row iids and returns a list of index numbers. See <a class="reference internal" href="#pysnptools.kernelreader.KernelReader.iid_to_index" title="pysnptools.kernelreader.KernelReader.iid_to_index"><code class="xref py py-attr docutils literal"><span class="pre">iid_to_index</span></code></a></p>
</dd></dl>

<dl class="attribute">
<dt id="pysnptools.kernelreader.KernelReader.iid1">
<code class="descname">iid1</code><a class="headerlink" href="#pysnptools.kernelreader.KernelReader.iid1" title="Permalink to this definition">¶</a></dt>
<dd><p>A ndarray of the column iids. See <a class="reference internal" href="#pysnptools.kernelreader.KernelReader.iid" title="pysnptools.kernelreader.KernelReader.iid"><code class="xref py py-attr docutils literal"><span class="pre">iid</span></code></a></p>
</dd></dl>

<dl class="attribute">
<dt id="pysnptools.kernelreader.KernelReader.iid1_count">
<code class="descname">iid1_count</code><a class="headerlink" href="#pysnptools.kernelreader.KernelReader.iid1_count" title="Permalink to this definition">¶</a></dt>
<dd><p>number of column iids. See <a class="reference internal" href="#pysnptools.kernelreader.KernelReader.iid_count" title="pysnptools.kernelreader.KernelReader.iid_count"><code class="xref py py-attr docutils literal"><span class="pre">iid_count</span></code></a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">integer</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pysnptools.kernelreader.KernelReader.iid1_to_index">
<code class="descname">iid1_to_index</code><span class="sig-paren">(</span><em>list</em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.kernelreader.KernelReader.iid1_to_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes a list of column iids and returns a list of index numbers. See <a class="reference internal" href="#pysnptools.kernelreader.KernelReader.iid_to_index" title="pysnptools.kernelreader.KernelReader.iid_to_index"><code class="xref py py-attr docutils literal"><span class="pre">iid_to_index</span></code></a></p>
</dd></dl>

<dl class="attribute">
<dt id="pysnptools.kernelreader.KernelReader.iid_count">
<code class="descname">iid_count</code><a class="headerlink" href="#pysnptools.kernelreader.KernelReader.iid_count" title="Permalink to this definition">¶</a></dt>
<dd><p>number of iids
Assumes the kernel is square, so will throw an exception if the row iids are different from the column iids.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">integer</td>
</tr>
</tbody>
</table>
<p>This property (to the degree practical) reads only iid data from the disk, not kernel value data. Moreover, the iid data is read from file only once.</p>
</dd></dl>

<dl class="method">
<dt id="pysnptools.kernelreader.KernelReader.iid_to_index">
<code class="descname">iid_to_index</code><span class="sig-paren">(</span><em>list</em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.kernelreader.KernelReader.iid_to_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes a list of iids and returns a list of index numbers.
Assumes the kernel is square, so will throw an exception if the row iids are different from the column iids.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>list</strong> &#8211; list of iids</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">ndarray of int</td>
</tr>
</tbody>
</table>
<p>This method (to the degree practical) reads only iid from the disk, not kernel value data. Moreover, the iid data is read from file only once.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.kernelreader</span> <span class="k">import</span> <span class="n">KernelNpz</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kernel_on_disk</span> <span class="o">=</span> <span class="n">KernelNpz</span><span class="p">(</span><span class="s1">&#39;../examples/toydata.kernel.npz&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">kernel_on_disk</span><span class="o">.</span><span class="n">iid_to_index</span><span class="p">([[</span><span class="s1">&#39;per2&#39;</span><span class="p">,</span><span class="s1">&#39;per2&#39;</span><span class="p">],[</span><span class="s1">&#39;per1&#39;</span><span class="p">,</span><span class="s1">&#39;per1&#39;</span><span class="p">]])</span> <span class="c1">#Find the indexes for two iids.</span>
<span class="go">[2 1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pysnptools.kernelreader.KernelReader.read">
<code class="descname">read</code><span class="sig-paren">(</span><em>order='F'</em>, <em>dtype=&lt;type 'numpy.float64'&gt;</em>, <em>force_python_only=False</em>, <em>view_ok=False</em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.kernelreader.KernelReader.read" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads the kernel values and returns a <a class="reference internal" href="#pysnptools.kernelreader.KernelData" title="pysnptools.kernelreader.KernelData"><code class="xref py py-class docutils literal"><span class="pre">KernelData</span></code></a> (with <code class="xref py py-attr docutils literal"><span class="pre">KernelData.val</span></code> property containing a new ndarray of the kernel values).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>order</strong> (<em>string or None</em>) &#8211; {&#8216;F&#8217; (default), &#8216;C&#8217;, &#8216;A&#8217;}, optional &#8211; Specify the order of the ndarray. If order is &#8216;F&#8217; (default),
then the array will be in F-contiguous order (iid0-index varies the fastest).
If order is &#8216;C&#8217;, then the returned array will be in C-contiguous order (iid1-index varies the fastest).
If order is &#8216;A&#8217;, then the <code class="xref py py-attr docutils literal"><span class="pre">KernelData.val</span></code>
ndarray may be in any order (either C-, Fortran-contiguous, or even discontiguous).</li>
<li><strong>dtype</strong> (<em>data-type</em>) &#8211; {scipy.float64 (default), scipy.float32}, optional &#8211; The data-type for the <code class="xref py py-attr docutils literal"><span class="pre">KernelData.val</span></code> ndarray.</li>
<li><strong>force_python_only</strong> (<em>bool</em>) &#8211; optional &#8211; If False (default), may use outside library code. If True, requests that the read
be done without outside library code.</li>
<li><strong>view_ok</strong> (<em>bool</em>) &#8211; optional &#8211; If False (default), allocates new memory for the <code class="xref py py-attr docutils literal"><span class="pre">KernelData.val</span></code>&#8216;s ndarray. If True,
if practical and reading from a <a class="reference internal" href="#pysnptools.kernelreader.KernelData" title="pysnptools.kernelreader.KernelData"><code class="xref py py-class docutils literal"><span class="pre">KernelData</span></code></a>, will return a new 
<a class="reference internal" href="#pysnptools.kernelreader.KernelData" title="pysnptools.kernelreader.KernelData"><code class="xref py py-class docutils literal"><span class="pre">KernelData</span></code></a> with a ndarray shares memory with the original <a class="reference internal" href="#pysnptools.kernelreader.KernelData" title="pysnptools.kernelreader.KernelData"><code class="xref py py-class docutils literal"><span class="pre">KernelData</span></code></a>.
Typically, you&#8217;ll also wish to use &#8220;order=&#8217;A&#8217;&#8221; to increase the chance that sharing will be possible.
Use these parameters with care because any change to either ndarray (for example, via <a class="reference internal" href="#pysnptools.kernelreader.KernelData.standardize" title="pysnptools.kernelreader.KernelData.standardize"><code class="xref py py-meth docutils literal"><span class="pre">KernelData.standardize()</span></code></a>) will effect
the others. Also keep in mind that <a class="reference internal" href="#pysnptools.kernelreader.KernelReader.read" title="pysnptools.kernelreader.KernelReader.read"><code class="xref py py-meth docutils literal"><span class="pre">read()</span></code></a> relies on ndarray&#8217;s mechanisms to decide whether to actually
share memory and so it may ignore your suggestion and allocate a new ndarray anyway.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#pysnptools.kernelreader.KernelData" title="pysnptools.kernelreader.KernelData"><code class="xref py py-class docutils literal"><span class="pre">KernelData</span></code></a></p>
</td>
</tr>
</tbody>
</table>
<p>Calling the method again causes the kernel values to be re-read and creates a new in-memory <a class="reference internal" href="#pysnptools.kernelreader.KernelData" title="pysnptools.kernelreader.KernelData"><code class="xref py py-class docutils literal"><span class="pre">KernelData</span></code></a> with a new ndarray of kernel values.</p>
<p>If you request the values for only a subset of the sids or iids, (to the degree practical) only that subset will be read from disk.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.kernelreader</span> <span class="k">import</span> <span class="n">KernelNpz</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kernel_on_disk</span> <span class="o">=</span> <span class="n">KernelNpz</span><span class="p">(</span><span class="s1">&#39;../examples/toydata.kernel.npz&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kerneldata1</span> <span class="o">=</span> <span class="n">kernel_on_disk</span><span class="o">.</span><span class="n">read</span><span class="p">()</span> <span class="c1"># Read all the kernel data returning a KernelData instance</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="nb">type</span><span class="p">(</span><span class="n">kerneldata1</span><span class="o">.</span><span class="n">val</span><span class="p">)</span> <span class="c1"># The KernelData instance contains a ndarray of the data.</span>
<span class="go">&lt;type &#39;numpy.ndarray&#39;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">subset_kerneldata</span> <span class="o">=</span> <span class="n">kernel_on_disk</span><span class="p">[::</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">read</span><span class="p">()</span> <span class="c1"># From the disk, read kernel values for every other iid</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">subset_kerneldata</span><span class="o">.</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># Print the first kernel value in the subset</span>
<span class="go">9923.06992842</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">subsub_kerneldata</span> <span class="o">=</span> <span class="n">subset_kerneldata</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="n">view_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1"># Create an in-memory subset of the subset with kernel values for the first ten iids. Share memory if practical.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#print np.may_share_memory(subset_kerneldata.val, subsub_kerneldata.val) # Do the two ndarray&#39;s share memory? They could. Currently they won&#39;t.       </span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="kernelreader-kerneldata">
<h3><code class="xref py py-class docutils literal"><span class="pre">kernelreader.KernelData</span></code><a class="headerlink" href="#kernelreader-kerneldata" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="pysnptools.kernelreader.KernelData">
<em class="property">class </em><code class="descclassname">pysnptools.kernelreader.</code><code class="descname">KernelData</code><span class="sig-paren">(</span><em>iid=None</em>, <em>iid0=None</em>, <em>iid1=None</em>, <em>val=None</em>, <em>name=None</em>, <em>parent_string=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.kernelreader.KernelData" title="Permalink to this definition">¶</a></dt>
<dd><p>A <a class="reference internal" href="#pysnptools.kernelreader.KernelReader" title="pysnptools.kernelreader.KernelReader"><code class="xref py py-class docutils literal"><span class="pre">KernelReader</span></code></a> for holding kernel values in-memory, along with related iid information.
It is usually created by calling the <a class="reference internal" href="#pysnptools.snpreader.SnpReader.read_kernel" title="pysnptools.snpreader.SnpReader.read_kernel"><code class="xref py py-meth docutils literal"><span class="pre">SnpReader.read_kernel()</span></code></a> method on a <a class="reference internal" href="#pysnptools.snpreader.SnpReader" title="pysnptools.snpreader.SnpReader"><code class="xref py py-class docutils literal"><span class="pre">SnpReader</span></code></a>, for example, <a class="reference internal" href="#pysnptools.snpreader.Bed" title="pysnptools.snpreader.Bed"><code class="xref py py-class docutils literal"><span class="pre">Bed</span></code></a>.
It can also be created by calling the <a class="reference internal" href="#pysnptools.kernelreader.KernelReader.read" title="pysnptools.kernelreader.KernelReader.read"><code class="xref py py-meth docutils literal"><span class="pre">KernelReader.read()</span></code></a> method on <a class="reference internal" href="#pysnptools.kernelreader.SnpKernel" title="pysnptools.kernelreader.SnpKernel"><code class="xref py py-class docutils literal"><span class="pre">SnpKernel</span></code></a>, for example, <a class="reference internal" href="#pysnptools.kernelreader.KernelNpz" title="pysnptools.kernelreader.KernelNpz"><code class="xref py py-class docutils literal"><span class="pre">KernelNpz</span></code></a>.
It can also be constructed.</p>
<p>See <a class="reference internal" href="#pysnptools.kernelreader.KernelReader" title="pysnptools.kernelreader.KernelReader"><code class="xref py py-class docutils literal"><span class="pre">KernelReader</span></code></a> for details and examples.</p>
<dl class="docutils">
<dt><strong>Constructor:</strong></dt>
<dd><table class="first docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>iid</strong> (an array of strings) &#8211; The <a class="reference internal" href="#pysnptools.kernelreader.KernelReader.iid" title="pysnptools.kernelreader.KernelReader.iid"><code class="xref py py-attr docutils literal"><span class="pre">KernelReader.iid</span></code></a> information</li>
<li><strong>iid0</strong> (an array of strings) &#8211; The <a class="reference internal" href="#pysnptools.kernelreader.KernelReader.iid0" title="pysnptools.kernelreader.KernelReader.iid0"><code class="xref py py-attr docutils literal"><span class="pre">KernelReader.iid0</span></code></a> information</li>
<li><strong>iid1</strong> (an array of strings) &#8211; The <a class="reference internal" href="#pysnptools.kernelreader.KernelReader.iid1" title="pysnptools.kernelreader.KernelReader.iid1"><code class="xref py py-attr docutils literal"><span class="pre">KernelReader.iid1</span></code></a> information</li>
<li><strong>val</strong> (a 2-D array of floats) &#8211; The SNP values</li>
<li><strong>name</strong> (optional, string) &#8211; Information to be display about the origin of this data</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>If <em>iid</em> is provided, don&#8217;t provide <em>iid0</em> and <em>iid1</em>. Likewise, if <em>iid0</em> and <em>iid1</em> are provided, don&#8217;t provide <em>iid</em>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.kernelreader</span> <span class="k">import</span> <span class="n">KernelData</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kerneldata</span> <span class="o">=</span> <span class="n">KernelData</span><span class="p">(</span><span class="n">iid</span><span class="o">=</span><span class="p">[[</span><span class="s1">&#39;fam0&#39;</span><span class="p">,</span><span class="s1">&#39;iid0&#39;</span><span class="p">],[</span><span class="s1">&#39;fam0&#39;</span><span class="p">,</span><span class="s1">&#39;iid1&#39;</span><span class="p">]],</span> <span class="n">val</span><span class="o">=</span><span class="p">[[</span><span class="mf">1.</span><span class="p">,</span><span class="o">.</span><span class="mi">5</span><span class="p">],[</span><span class="o">.</span><span class="mi">5</span><span class="p">,</span><span class="mf">1.</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">kerneldata</span><span class="o">.</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">kerneldata</span><span class="o">.</span><span class="n">iid_count</span>
<span class="go">0.5 2</span>
</pre></div>
</div>
</dd>
</dl>
<p><strong>Equality:</strong></p>
<blockquote>
<div><p>Two KernelData objects are equal if their three arrays (<a class="reference internal" href="#pysnptools.kernelreader.KernelReader.iid0" title="pysnptools.kernelreader.KernelReader.iid0"><code class="xref py py-attr docutils literal"><span class="pre">iid0</span></code></a>, <a class="reference internal" href="#pysnptools.kernelreader.KernelReader.iid1" title="pysnptools.kernelreader.KernelReader.iid1"><code class="xref py py-attr docutils literal"><span class="pre">iid1</span></code></a>, and <code class="xref py py-attr docutils literal"><span class="pre">val</span></code>) are &#8216;array_equal&#8217;.
(Their &#8216;string&#8217; does not need to be the same).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.kernelreader</span> <span class="k">import</span> <span class="n">KernelData</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kerneldata1</span> <span class="o">=</span> <span class="n">KernelData</span><span class="p">(</span><span class="n">iid</span><span class="o">=</span><span class="p">[[</span><span class="s1">&#39;fam0&#39;</span><span class="p">,</span><span class="s1">&#39;iid0&#39;</span><span class="p">],[</span><span class="s1">&#39;fam0&#39;</span><span class="p">,</span><span class="s1">&#39;iid1&#39;</span><span class="p">]],</span> <span class="n">val</span><span class="o">=</span><span class="p">[[</span><span class="mf">1.</span><span class="p">,</span><span class="o">.</span><span class="mi">5</span><span class="p">],[</span><span class="o">.</span><span class="mi">5</span><span class="p">,</span><span class="mf">1.</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kerneldata2</span> <span class="o">=</span> <span class="n">KernelData</span><span class="p">(</span><span class="n">iid</span><span class="o">=</span><span class="p">[[</span><span class="s1">&#39;fam0&#39;</span><span class="p">,</span><span class="s1">&#39;iid0&#39;</span><span class="p">],[</span><span class="s1">&#39;fam0&#39;</span><span class="p">,</span><span class="s1">&#39;iid1&#39;</span><span class="p">]],</span> <span class="n">val</span><span class="o">=</span><span class="p">[[</span><span class="mf">1.</span><span class="p">,</span><span class="o">.</span><span class="mi">5</span><span class="p">],[</span><span class="o">.</span><span class="mi">5</span><span class="p">,</span><span class="mf">1.</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">kerneldata1</span> <span class="o">==</span> <span class="n">kerneldata2</span> <span class="c1">#True, because all the arrays have the same values.</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">kerneldata1</span><span class="o">.</span><span class="n">val</span> <span class="ow">is</span> <span class="n">kerneldata2</span><span class="o">.</span><span class="n">val</span> <span class="c1">#False, because the two arrays have different memory.</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kerneldata3</span> <span class="o">=</span> <span class="n">KernelData</span><span class="p">(</span><span class="n">iid</span><span class="o">=</span><span class="p">[[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;0&#39;</span><span class="p">],[</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="s1">&#39;0&#39;</span><span class="p">]],</span> <span class="n">val</span><span class="o">=</span><span class="p">[[</span><span class="mf">1.</span><span class="p">,</span><span class="o">.</span><span class="mi">5</span><span class="p">],[</span><span class="o">.</span><span class="mi">5</span><span class="p">,</span><span class="mf">1.</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kerneldata4</span> <span class="o">=</span> <span class="n">KernelData</span><span class="p">(</span><span class="n">iid</span><span class="o">=</span><span class="p">[[</span><span class="s1">&#39;fam0&#39;</span><span class="p">,</span><span class="s1">&#39;iid0&#39;</span><span class="p">],[</span><span class="s1">&#39;fam0&#39;</span><span class="p">,</span><span class="s1">&#39;iid1&#39;</span><span class="p">]],</span> <span class="n">val</span><span class="o">=</span><span class="p">[[</span><span class="mf">1.</span><span class="p">,</span><span class="o">.</span><span class="mi">5</span><span class="p">],[</span><span class="o">.</span><span class="mi">5</span><span class="p">,</span><span class="mf">1.</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">kerneldata3</span> <span class="o">==</span> <span class="n">kerneldata4</span> <span class="c1">#False, because the iids are different.</span>
<span class="go">False</span>
</pre></div>
</div>
</div></blockquote>
<p><strong>Methods beyond</strong> <a class="reference internal" href="#pysnptools.kernelreader.KernelReader" title="pysnptools.kernelreader.KernelReader"><code class="xref py py-class docutils literal"><span class="pre">KernelReader</span></code></a></p>
<dl class="method">
<dt id="pysnptools.kernelreader.KernelData.standardize">
<code class="descname">standardize</code><span class="sig-paren">(</span><em>standardizer=DiagKtoN()</em>, <em>return_trained=False</em>, <em>force_python_only=False</em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.kernelreader.KernelData.standardize" title="Permalink to this definition">¶</a></dt>
<dd><p>Does in-place standardization of the in-memory
kernel data. The method multiples the values with a scalar factor such that the diagonal sums to iid_count. Although it works in place, for convenience
it also returns the KernelData.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="#pysnptools.kernelreader.KernelData" title="pysnptools.kernelreader.KernelData"><code class="xref py py-class docutils literal"><span class="pre">KernelData</span></code></a> (standardizes in place, but for convenience, returns &#8216;self&#8217;)</td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.kernelreader</span> <span class="k">import</span> <span class="n">KernelNpz</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kernel_on_disk</span> <span class="o">=</span> <span class="n">KernelNpz</span><span class="p">(</span><span class="s1">&#39;../examples/toydata.kernel.npz&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kerneldata1</span> <span class="o">=</span> <span class="n">kernel_on_disk</span><span class="o">.</span><span class="n">read</span><span class="p">()</span> <span class="c1"># read all kernel values into memory</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">kerneldata1</span><span class="o">.</span><span class="n">val</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="go">5000000.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kerneldata1</span><span class="o">.</span><span class="n">standardize</span><span class="p">()</span> <span class="c1"># standardize changes the values in kerneldata1.val</span>
<span class="go">KernelData(KernelNpz(&#39;../examples/toydata.kernel.npz&#39;))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">kerneldata1</span><span class="o">.</span><span class="n">val</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="go">500.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kerneldata2</span> <span class="o">=</span> <span class="n">kernel_on_disk</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">standardize</span><span class="p">()</span> <span class="c1"># Read and standardize in one expression with only one ndarray allocated.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">kerneldata2</span><span class="o">.</span><span class="n">val</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="go">500.0</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="kernelreader-kernelnpz">
<h3><code class="xref py py-class docutils literal"><span class="pre">kernelreader.KernelNpz</span></code><a class="headerlink" href="#kernelreader-kernelnpz" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="pysnptools.kernelreader.KernelNpz">
<em class="property">class </em><code class="descclassname">pysnptools.kernelreader.</code><code class="descname">KernelNpz</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.kernelreader.KernelNpz" title="Permalink to this definition">¶</a></dt>
<dd><p>A <a class="reference internal" href="#pysnptools.kernelreader.KernelReader" title="pysnptools.kernelreader.KernelReader"><code class="xref py py-class docutils literal"><span class="pre">KernelReader</span></code></a> for reading *.kernel.npz files from disk.</p>
<p>See <a class="reference internal" href="#pysnptools.kernelreader.KernelReader" title="pysnptools.kernelreader.KernelReader"><code class="xref py py-class docutils literal"><span class="pre">KernelReader</span></code></a> for general examples of using KernelReaders.</p>
<p>The general NPZ format is described in <a class="reference external" href="http://docs.scipy.org/doc/numpy/reference/generated/numpy.savez.html">http://docs.scipy.org/doc/numpy/reference/generated/numpy.savez.html</a>. The KernelNpz format stores
val, iid0, and iid1 information in NPZ format.</p>
<dl class="docutils">
<dt><strong>Constructor:</strong></dt>
<dd><table class="first docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>filename</strong> (<em>string</em>) &#8211; The KernelNpz file to read.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.kernelreader</span> <span class="k">import</span> <span class="n">KernelNpz</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_on_disk</span> <span class="o">=</span> <span class="n">KernelNpz</span><span class="p">(</span><span class="s1">&#39;../examples/toydata.kernel.npz&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">data_on_disk</span><span class="o">.</span><span class="n">iid_count</span>
<span class="go">500</span>
</pre></div>
</div>
</dd>
</dl>
<p><strong>Methods beyond</strong> <a class="reference internal" href="#pysnptools.kernelreader.KernelReader" title="pysnptools.kernelreader.KernelReader"><code class="xref py py-class docutils literal"><span class="pre">KernelReader</span></code></a></p>
<dl class="staticmethod">
<dt id="pysnptools.kernelreader.KernelNpz.write">
<em class="property">static </em><code class="descname">write</code><span class="sig-paren">(</span><em>filename</em>, <em>kerneldata</em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.kernelreader.KernelNpz.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes a <a class="reference internal" href="#pysnptools.kernelreader.KernelData" title="pysnptools.kernelreader.KernelData"><code class="xref py py-class docutils literal"><span class="pre">KernelData</span></code></a> to KernelNpz format.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>filename</strong> (<em>string</em>) &#8211; the name of the file to create</li>
<li><strong>kerneldata</strong> (<a class="reference internal" href="#pysnptools.kernelreader.KernelData" title="pysnptools.kernelreader.KernelData"><code class="xref py py-class docutils literal"><span class="pre">KernelData</span></code></a>) &#8211; The in-memory data that should be written to disk.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.snpreader</span> <span class="k">import</span> <span class="n">Bed</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.standardizer</span> <span class="k">import</span> <span class="n">Unit</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pysnptools.util</span> <span class="k">as</span> <span class="nn">pstutil</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kerneldata</span> <span class="o">=</span> <span class="n">Bed</span><span class="p">(</span><span class="s1">&#39;../examples/toydata.bed&#39;</span><span class="p">,</span><span class="n">count_A1</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">read_kernel</span><span class="p">(</span><span class="n">Unit</span><span class="p">())</span>     <span class="c1"># Create a kernel from the data in the Bed file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pstutil</span><span class="o">.</span><span class="n">create_directory_if_necessary</span><span class="p">(</span><span class="s2">&quot;tempdir/toydata.kernel.npz&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">KernelNpz</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;tempdir/toydata.kernel.npz&quot;</span><span class="p">,</span><span class="n">kerneldata</span><span class="p">)</span>      <span class="c1"># Write data in KernelNpz format</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="kernelreader-kernelhdf5">
<h3><code class="xref py py-class docutils literal"><span class="pre">kernelreader.KernelHdf5</span></code><a class="headerlink" href="#kernelreader-kernelhdf5" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="pysnptools.kernelreader.KernelHdf5">
<em class="property">class </em><code class="descclassname">pysnptools.kernelreader.</code><code class="descname">KernelHdf5</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.kernelreader.KernelHdf5" title="Permalink to this definition">¶</a></dt>
<dd><p>A <a class="reference internal" href="#pysnptools.kernelreader.KernelReader" title="pysnptools.kernelreader.KernelReader"><code class="xref py py-class docutils literal"><span class="pre">KernelReader</span></code></a> for reading *.kernel.hdf5 files from disk.</p>
<p>See <a class="reference internal" href="#pysnptools.kernelreader.KernelReader" title="pysnptools.kernelreader.KernelReader"><code class="xref py py-class docutils literal"><span class="pre">KernelReader</span></code></a> for general examples of using KernelReaders.</p>
<p>The general HDF5 format is described in <a class="reference external" href="http://www.hdfgroup.org/HDF5/">http://www.hdfgroup.org/HDF5/</a>. The KernelHdf5 format stores
val, iid, sid, and pos information in Hdf5 format.</p>
<dl class="docutils">
<dt><strong>Constructor:</strong></dt>
<dd><table class="first docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>filename</strong> (<em>string</em>) &#8211; The KernelHdf5 file to read.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.kernelreader</span> <span class="k">import</span> <span class="n">KernelHdf5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_on_disk</span> <span class="o">=</span> <span class="n">KernelHdf5</span><span class="p">(</span><span class="s1">&#39;../examples/toydata.kernel.hdf5&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">data_on_disk</span><span class="o">.</span><span class="n">iid_count</span>
<span class="go">500</span>
</pre></div>
</div>
</dd>
</dl>
<p><strong>Methods beyond</strong> <a class="reference internal" href="#pysnptools.kernelreader.KernelReader" title="pysnptools.kernelreader.KernelReader"><code class="xref py py-class docutils literal"><span class="pre">KernelReader</span></code></a></p>
<dl class="staticmethod">
<dt id="pysnptools.kernelreader.KernelHdf5.write">
<em class="property">static </em><code class="descname">write</code><span class="sig-paren">(</span><em>filename</em>, <em>kerneldata</em>, <em>hdf5_dtype=None</em>, <em>sid_major=True</em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.kernelreader.KernelHdf5.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes a <a class="reference internal" href="#pysnptools.kernelreader.KernelData" title="pysnptools.kernelreader.KernelData"><code class="xref py py-class docutils literal"><span class="pre">KernelData</span></code></a> to KernelHdf5 format.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>filename</strong> (<em>string</em>) &#8211; the name of the file to create</li>
<li><strong>kerneldata</strong> (<a class="reference internal" href="#pysnptools.kernelreader.KernelData" title="pysnptools.kernelreader.KernelData"><code class="xref py py-class docutils literal"><span class="pre">KernelData</span></code></a>) &#8211; The in-memory data that should be written to disk.</li>
<li><strong>hdf5_dtype</strong> (<em>string</em>) &#8211; None (use the .val&#8217;s dtype) or a Hdf5 dtype, e.g. &#8216;f8&#8217;,&#8217;f4&#8217;,etc.</li>
<li><strong>col_major</strong> (<em>bool</em>) &#8211; Tells if vals should be stored on disk in sid_major (default) or iid_major format.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.snpreader</span> <span class="k">import</span> <span class="n">Bed</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.standardizer</span> <span class="k">import</span> <span class="n">Unit</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pysnptools.util</span> <span class="k">as</span> <span class="nn">pstutil</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kerneldata</span> <span class="o">=</span> <span class="n">Bed</span><span class="p">(</span><span class="s1">&#39;../examples/toydata.bed&#39;</span><span class="p">,</span><span class="n">count_A1</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">read_kernel</span><span class="p">(</span><span class="n">Unit</span><span class="p">())</span>     <span class="c1"># Create a kernel from the data in the Bed file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pstutil</span><span class="o">.</span><span class="n">create_directory_if_necessary</span><span class="p">(</span><span class="s2">&quot;tempdir/toydata.kernel.hdf5&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">KernelHdf5</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;tempdir/toydata.kernel.hdf5&quot;</span><span class="p">,</span><span class="n">kerneldata</span><span class="p">)</span>          <span class="c1"># Write data in KernelHdf5 format</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="kernelreader-identity">
<h3><code class="xref py py-class docutils literal"><span class="pre">kernelreader.Identity</span></code><a class="headerlink" href="#kernelreader-identity" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="pysnptools.kernelreader.Identity">
<em class="property">class </em><code class="descclassname">pysnptools.kernelreader.</code><code class="descname">Identity</code><span class="sig-paren">(</span><em>iid</em>, <em>test=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.kernelreader.Identity" title="Permalink to this definition">¶</a></dt>
<dd><p>A <a class="reference internal" href="#pysnptools.kernelreader.KernelReader" title="pysnptools.kernelreader.KernelReader"><code class="xref py py-class docutils literal"><span class="pre">KernelReader</span></code></a> for that represents an identity matrix. No memory for the values is allocated until <code class="xref py py-meth docutils literal"><span class="pre">Identity.read()</span></code> is called.</p>
<p>See <a class="reference internal" href="#pysnptools.kernelreader.KernelReader" title="pysnptools.kernelreader.KernelReader"><code class="xref py py-class docutils literal"><span class="pre">KernelReader</span></code></a> for general examples of using KernelReaders.</p>
<dl class="docutils">
<dt><strong>Constructor:</strong></dt>
<dd><table class="first docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>iid</strong> (an array of strings) &#8211; The <a class="reference internal" href="#pysnptools.kernelreader.KernelReader.iid" title="pysnptools.kernelreader.KernelReader.iid"><code class="xref py py-attr docutils literal"><span class="pre">KernelReader.iid</span></code></a> information</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.kernelreader</span> <span class="k">import</span> <span class="n">Identity</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">identity</span> <span class="o">=</span> <span class="n">Identity</span><span class="p">(</span><span class="n">iid</span><span class="o">=</span><span class="p">[[</span><span class="s1">&#39;fam0&#39;</span><span class="p">,</span><span class="s1">&#39;iid0&#39;</span><span class="p">],[</span><span class="s1">&#39;fam0&#39;</span><span class="p">,</span><span class="s1">&#39;iid1&#39;</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">identity</span><span class="o">.</span><span class="n">iid_count</span>
<span class="go">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">identity</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">val</span>
<span class="go">[[ 1.  0.]</span>
<span class="go"> [ 0.  1.]]</span>
</pre></div>
</div>
<div class="last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">identity</span> <span class="o">=</span> <span class="n">Identity</span><span class="p">(</span><span class="n">iid</span><span class="o">=</span><span class="p">[[</span><span class="s1">&#39;fam0&#39;</span><span class="p">,</span><span class="s1">&#39;iid0&#39;</span><span class="p">],[</span><span class="s1">&#39;fam0&#39;</span><span class="p">,</span><span class="s1">&#39;iid1&#39;</span><span class="p">],[</span><span class="s1">&#39;fam0&#39;</span><span class="p">,</span><span class="s1">&#39;iid2&#39;</span><span class="p">]],</span><span class="n">test</span><span class="o">=</span><span class="p">[[</span><span class="s1">&#39;fam0&#39;</span><span class="p">,</span><span class="s1">&#39;iid1&#39;</span><span class="p">],[</span><span class="s1">&#39;fam0&#39;</span><span class="p">,</span><span class="s1">&#39;iid3&#39;</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">identity</span><span class="o">.</span><span class="n">iid0_count</span><span class="p">,</span> <span class="n">identity</span><span class="o">.</span><span class="n">iid1_count</span>
<span class="go">3 2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">identity</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">val</span>
<span class="go">[[ 0.  0.]</span>
<span class="go"> [ 1.  0.]</span>
<span class="go"> [ 0.  0.]]</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="kernelreader-snpkernel">
<h3><code class="xref py py-class docutils literal"><span class="pre">kernelreader.SnpKernel</span></code><a class="headerlink" href="#kernelreader-snpkernel" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="pysnptools.kernelreader.SnpKernel">
<em class="property">class </em><code class="descclassname">pysnptools.kernelreader.</code><code class="descname">SnpKernel</code><span class="sig-paren">(</span><em>snpreader</em>, <em>standardizer=None</em>, <em>block_size=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.kernelreader.SnpKernel" title="Permalink to this definition">¶</a></dt>
<dd><p>A <a class="reference internal" href="#pysnptools.kernelreader.KernelReader" title="pysnptools.kernelreader.KernelReader"><code class="xref py py-class docutils literal"><span class="pre">KernelReader</span></code></a> that creates a kernel from a <a class="reference internal" href="#pysnptools.snpreader.SnpReader" title="pysnptools.snpreader.SnpReader"><code class="xref py py-class docutils literal"><span class="pre">SnpReader</span></code></a>. No SNP data will be read until
the <code class="xref py py-meth docutils literal"><span class="pre">SnpKernel.read()</span></code> method is called. Use block_size to avoid ever reading all the SNP data into memory
at once.</p>
<p>See <a class="reference internal" href="#pysnptools.kernelreader.KernelReader" title="pysnptools.kernelreader.KernelReader"><code class="xref py py-class docutils literal"><span class="pre">KernelReader</span></code></a> for general examples of using KernelReaders.</p>
<dl class="docutils">
<dt><strong>Constructor:</strong></dt>
<dd><table class="first docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>snpreader</strong> (<code class="xref py py-class docutils literal"><span class="pre">SnpReader</span></code>) &#8211; The SNP data</li>
<li><strong>standardizer</strong> (<code class="xref py py-class docutils literal"><span class="pre">Standardizer</span></code>) &#8211; How the SNP data should be standardized</li>
<li><strong>block_size</strong> (optional, int) &#8211; The number of SNPs to read at a time.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>If <strong>block_size</strong> is not given, then all SNP data will be read at once.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.snpreader</span> <span class="k">import</span> <span class="n">Bed</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.standardizer</span> <span class="k">import</span> <span class="n">Unit</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snp_on_disk</span> <span class="o">=</span> <span class="n">Bed</span><span class="p">(</span><span class="s1">&#39;../examples/toydata.bed&#39;</span><span class="p">,</span><span class="n">count_A1</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>     <span class="c1"># A Bed file is specified, but nothing is read from disk</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kernel_on_disk</span> <span class="o">=</span> <span class="n">SnpKernel</span><span class="p">(</span><span class="n">snp_on_disk</span><span class="p">,</span> <span class="n">Unit</span><span class="p">(),</span><span class="n">block_size</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>  <span class="c1"># A kernel is specified, but nothing is read from disk</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">kernel_on_disk</span> <span class="c1">#Print the specification</span>
<span class="go">SnpKernel(Bed(&#39;../examples/toydata.bed&#39;,count_A1=False),standardizer=Unit(),block_size=500)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">kernel_on_disk</span><span class="o">.</span><span class="n">iid_count</span>                                  <span class="c1"># iid information is read from disk, but not SNP data</span>
<span class="go">500</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kerneldata</span> <span class="o">=</span> <span class="n">kernel_on_disk</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">standardize</span><span class="p">()</span>                <span class="c1"># SNPs are read and Unit standardized, 500 at a time, to create a kernel, which is then standardized</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">kerneldata</span><span class="o">.</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
<span class="go">0.992306992842</span>
</pre></div>
</div>
</dd>
</dl>
<dl class="attribute">
<dt id="pysnptools.kernelreader.SnpKernel.pos">
<code class="descname">pos</code><a class="headerlink" href="#pysnptools.kernelreader.SnpKernel.pos" title="Permalink to this definition">¶</a></dt>
<dd><p>The <a class="reference internal" href="#pysnptools.snpreader.SnpReader.pos" title="pysnptools.snpreader.SnpReader.pos"><code class="xref py py-attr docutils literal"><span class="pre">SnpReader.pos</span></code></a> property of the SNP data.</p>
</dd></dl>

<dl class="method">
<dt id="pysnptools.kernelreader.SnpKernel.read_snps">
<code class="descname">read_snps</code><span class="sig-paren">(</span><em>order='F'</em>, <em>dtype=&lt;type 'numpy.float64'&gt;</em>, <em>force_python_only=False</em>, <em>view_ok=False</em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.kernelreader.SnpKernel.read_snps" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads the SNP values, applies the standardizer, and returns a <a class="reference internal" href="#pysnptools.snpreader.SnpData" title="pysnptools.snpreader.SnpData"><code class="xref py py-class docutils literal"><span class="pre">SnpData</span></code></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>order</strong> (<em>string or None</em>) &#8211; {&#8216;F&#8217; (default), &#8216;C&#8217;, &#8216;A&#8217;}, optional &#8211; Specify the order of the ndarray. If order is &#8216;F&#8217; (default),
then the array will be in F-contiguous order (iid-index varies the fastest).
If order is &#8216;C&#8217;, then the returned array will be in C-contiguous order (sid-index varies the fastest).
If order is &#8216;A&#8217;, then the <code class="xref py py-attr docutils literal"><span class="pre">SnpData.val</span></code>
ndarray may be in any order (either C-, Fortran-contiguous).</li>
<li><strong>dtype</strong> (<em>data-type</em>) &#8211; {scipy.float64 (default), scipy.float32}, optional &#8211; The data-type for the <code class="xref py py-attr docutils literal"><span class="pre">SnpData.val</span></code> ndarray.</li>
<li><strong>force_python_only</strong> (<em>bool</em>) &#8211; optional &#8211; If False (default), may use outside library code. If True, requests that the read
be done without outside library code.</li>
<li><strong>view_ok</strong> (<em>bool</em>) &#8211; optional &#8211; If False (default), allocates new memory for the <code class="xref py py-attr docutils literal"><span class="pre">SnpData.val</span></code>&#8216;s ndarray. If True,
if practical and reading from a <code class="xref py py-class docutils literal"><span class="pre">SnpData</span></code>, will return a new 
<code class="xref py py-class docutils literal"><span class="pre">SnpData</span></code> with a ndarray shares memory with the original <code class="xref py py-class docutils literal"><span class="pre">SnpData</span></code>.
Typically, you&#8217;ll also wish to use &#8220;order=&#8217;A&#8217;&#8221; to increase the chance that sharing will be possible.
Use these parameters with care because any change to either ndarray (for example, via <a class="reference internal" href="#pysnptools.snpreader.SnpData.standardize" title="pysnptools.snpreader.SnpData.standardize"><code class="xref py py-meth docutils literal"><span class="pre">SnpData.standardize()</span></code></a>) will effect
the others. Also keep in mind that <code class="xref py py-meth docutils literal"><span class="pre">read()</span></code> relies on ndarray&#8217;s mechanisms to decide whether to actually
share memory and so it may ignore your suggestion and allocate a new ndarray anyway.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#pysnptools.snpreader.SnpData" title="pysnptools.snpreader.SnpData"><code class="xref py py-class docutils literal"><span class="pre">SnpData</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="pysnptools.kernelreader.SnpKernel.sid">
<code class="descname">sid</code><a class="headerlink" href="#pysnptools.kernelreader.SnpKernel.sid" title="Permalink to this definition">¶</a></dt>
<dd><p>The <a class="reference internal" href="#pysnptools.snpreader.SnpReader.sid" title="pysnptools.snpreader.SnpReader.sid"><code class="xref py py-attr docutils literal"><span class="pre">SnpReader.sid</span></code></a> property of the SNP data.</p>
</dd></dl>

<dl class="attribute">
<dt id="pysnptools.kernelreader.SnpKernel.sid_count">
<code class="descname">sid_count</code><a class="headerlink" href="#pysnptools.kernelreader.SnpKernel.sid_count" title="Permalink to this definition">¶</a></dt>
<dd><p>The <a class="reference internal" href="#pysnptools.snpreader.SnpReader.sid_count" title="pysnptools.snpreader.SnpReader.sid_count"><code class="xref py py-attr docutils literal"><span class="pre">SnpReader.sid_count</span></code></a> property of the SNP data.</p>
</dd></dl>

</dd></dl>

</div>
</div>
<div class="section" id="util-module">
<h2><code class="xref py py-mod docutils literal"><span class="pre">util</span></code> Module<a class="headerlink" href="#util-module" title="Permalink to this headline">¶</a></h2>
<div class="section" id="module-pysnptools.util">
<span id="util"></span><h3><code class="xref py py-mod docutils literal"><span class="pre">util</span></code><a class="headerlink" href="#module-pysnptools.util" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="pysnptools.util.create_directory_if_necessary">
<code class="descclassname">pysnptools.util.</code><code class="descname">create_directory_if_necessary</code><span class="sig-paren">(</span><em>name</em>, <em>isfile=True</em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.create_directory_if_necessary" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a directory for a file if the directory doesn&#8217;t already exist.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>name</strong> (<em>string</em>) &#8211; file or directory name</li>
<li><strong>isfile</strong> (<em>bool</em>) &#8211; If True (default), the name is a file, otherwise it is a directory.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pysnptools.util.intersect_apply">
<code class="descclassname">pysnptools.util.</code><code class="descname">intersect_apply</code><span class="sig-paren">(</span><em>data_list</em>, <em>sort_by_dataset=True</em>, <em>intersect_before_standardize=True</em>, <em>is_test=False</em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.intersect_apply" title="Permalink to this definition">¶</a></dt>
<dd><p>Intersects and sorts the iids from a list of datasets, returning new version of the datasets with all the same iids in the same order.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>data_list</strong> (<em>list</em>) &#8211; list of datasets</li>
<li><strong>sort_by_dataset</strong> (<em>bool</em>) &#8211; optional, If True (default), the iids are ordered according to the first non-None dataset.
If False, the order is arbitrary, but consistent.</li>
<li><strong>intersect_before_standardize</strong> (<em>bool</em>) &#8211; optional. Special code for <a class="reference internal" href="#pysnptools.kernelreader.SnpKernel" title="pysnptools.kernelreader.SnpKernel"><code class="xref py py-class docutils literal"><span class="pre">SnpKernel</span></code></a>, the class that postpones computing a kernel from SNP data. 
If True (default), <a class="reference internal" href="#pysnptools.kernelreader.SnpKernel" title="pysnptools.kernelreader.SnpKernel"><code class="xref py py-class docutils literal"><span class="pre">SnpKernel</span></code></a> will remove any iids before SNP standardization before computing the kernel.
If False, SNPs will be standardized with all iids, then the kernel will be computed, then any iids will be removed.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">list of datasets</p>
</td>
</tr>
</tbody>
</table>
<p>Here are the dataset formats understood and what is returned for each.</p>
<table border="1" class="docutils">
<colgroup>
<col width="42%" />
<col width="58%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Dataset Format</th>
<th class="head">What is Returned</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>None</td>
<td>None</td>
</tr>
<tr class="row-odd"><td>A <a class="reference internal" href="#pysnptools.snpreader.SnpReader" title="pysnptools.snpreader.SnpReader"><code class="xref py py-class docutils literal"><span class="pre">SnpReader</span></code></a></td>
<td>A new subsetting <a class="reference internal" href="#pysnptools.snpreader.SnpReader" title="pysnptools.snpreader.SnpReader"><code class="xref py py-class docutils literal"><span class="pre">SnpReader</span></code></a> with adjusted iid</td>
</tr>
<tr class="row-even"><td>A <a class="reference internal" href="#pysnptools.kernelreader.KernelReader" title="pysnptools.kernelreader.KernelReader"><code class="xref py py-class docutils literal"><span class="pre">KernelReader</span></code></a></td>
<td>A new subsetting <a class="reference internal" href="#pysnptools.kernelreader.KernelReader" title="pysnptools.kernelreader.KernelReader"><code class="xref py py-class docutils literal"><span class="pre">KernelReader</span></code></a> with adjusted iid</td>
</tr>
<tr class="row-odd"><td>A dictionary with [&#8216;iid&#8217;] and [&#8216;vals&#8217;] keys</td>
<td>The same dictionary but with the iid and vals values adjusted</td>
</tr>
<tr class="row-even"><td>Tuple of the form (val ndarray, iid list)</td>
<td>A new tuple with the val ndarray and iid list adjusted</td>
</tr>
</tbody>
</table>
<p>If the iids in all the datasets are already the same and in the same order, then the datasets are returned without change.</p>
<p>Notice that only dictionaries are processed in-place. Inputting a <a class="reference internal" href="#pysnptools.snpreader.SnpReader" title="pysnptools.snpreader.SnpReader"><code class="xref py py-class docutils literal"><span class="pre">SnpReader</span></code></a> and <a class="reference internal" href="#pysnptools.kernelreader.KernelReader" title="pysnptools.kernelreader.KernelReader"><code class="xref py py-class docutils literal"><span class="pre">KernelReader</span></code></a> returns a new class of the same type (unless its iids
are already ok). Inputting a tuple returns a new tuple (unless its iids are already ok).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.snpreader</span> <span class="k">import</span> <span class="n">Bed</span><span class="p">,</span> <span class="n">Pheno</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.kernelreader</span> <span class="k">import</span> <span class="n">SnpKernel</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.standardizer</span> <span class="k">import</span> <span class="n">Unit</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#Create five datasets in different formats</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ignore_in</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kernel_in</span> <span class="o">=</span> <span class="n">SnpKernel</span><span class="p">(</span><span class="n">Bed</span><span class="p">(</span><span class="s1">&#39;../../tests/datasets/all_chr.maf0.001.N300&#39;</span><span class="p">,</span><span class="n">count_A1</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span><span class="n">Unit</span><span class="p">())</span> <span class="c1"># Create a kernel from a Bed file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pheno_in</span> <span class="o">=</span> <span class="n">Pheno</span><span class="p">(</span><span class="s1">&#39;../../tests/datasets/phenSynthFrom22.23.N300.randcidorder.txt&#39;</span><span class="p">,</span><span class="n">missing</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cov</span> <span class="o">=</span> <span class="n">Pheno</span><span class="p">(</span><span class="s1">&#39;../../tests/datasets/all_chr.maf0.001.covariates.N300.txt&#39;</span><span class="p">,</span><span class="n">missing</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cov_as_tuple_in</span> <span class="o">=</span> <span class="p">(</span><span class="n">cov</span><span class="o">.</span><span class="n">val</span><span class="p">,</span><span class="n">cov</span><span class="o">.</span><span class="n">iid</span><span class="p">)</span> <span class="c1">#We could do cov directly, but as an example we make it a tuple.</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create five new datasets with consistent iids</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ignore_out</span><span class="p">,</span> <span class="n">kernel_out</span><span class="p">,</span> <span class="n">pheno_out</span><span class="p">,</span> <span class="n">cov_as_tuple_out</span> <span class="o">=</span> <span class="n">intersect_apply</span><span class="p">([</span><span class="n">ignore_in</span><span class="p">,</span> <span class="n">kernel_in</span><span class="p">,</span> <span class="n">pheno_in</span><span class="p">,</span> <span class="n">cov_as_tuple_in</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Print the first five iids from each dataset</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">ignore_out</span><span class="p">,</span> <span class="n">kernel_out</span><span class="o">.</span><span class="n">iid</span><span class="p">[:</span><span class="mi">5</span><span class="p">],</span> <span class="n">pheno_out</span><span class="o">.</span><span class="n">iid</span><span class="p">[:</span><span class="mi">5</span><span class="p">],</span> <span class="n">cov_as_tuple_out</span><span class="p">[</span><span class="mi">1</span><span class="p">][:</span><span class="mi">5</span><span class="p">]</span>
<span class="go">None [[&#39;POP1&#39; &#39;0&#39;]</span>
<span class="go"> [&#39;POP1&#39; &#39;12&#39;]</span>
<span class="go"> [&#39;POP1&#39; &#39;44&#39;]</span>
<span class="go"> [&#39;POP1&#39; &#39;58&#39;]</span>
<span class="go"> [&#39;POP1&#39; &#39;65&#39;]] [[&#39;POP1&#39; &#39;0&#39;]</span>
<span class="go"> [&#39;POP1&#39; &#39;12&#39;]</span>
<span class="go"> [&#39;POP1&#39; &#39;44&#39;]</span>
<span class="go"> [&#39;POP1&#39; &#39;58&#39;]</span>
<span class="go"> [&#39;POP1&#39; &#39;65&#39;]] [[&#39;POP1&#39; &#39;0&#39;]</span>
<span class="go"> [&#39;POP1&#39; &#39;12&#39;]</span>
<span class="go"> [&#39;POP1&#39; &#39;44&#39;]</span>
<span class="go"> [&#39;POP1&#39; &#39;58&#39;]</span>
<span class="go"> [&#39;POP1&#39; &#39;65&#39;]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pysnptools.util.intersect_ids">
<code class="descclassname">pysnptools.util.</code><code class="descname">intersect_ids</code><span class="sig-paren">(</span><em>idslist</em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.intersect_ids" title="Permalink to this definition">¶</a></dt>
<dd><div class="deprecated">
<p><span class="versionmodified">Deprecated since version Use: </span><a class="reference internal" href="#pysnptools.util.intersect_apply" title="pysnptools.util.intersect_apply"><code class="xref py py-func docutils literal"><span class="pre">intersect_apply()</span></code></a> instead.    </p>
</div>
<p>Takes a list of 2d string arrays of family and case ids.
These are intersected.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">indarr, an array of size N x L, where N is the number of
individuals in the intersection, and L is the number of lists in idslist, and which
contains the index to use (in order) such that all people will be identical and in order
across all data sets.</td>
</tr>
</tbody>
</table>
<p>If one of the lists=None, it is ignored (but still has values reported in indarr, all equal to -1),</p>
</dd></dl>

<dl class="function">
<dt id="pysnptools.util.sub_matrix">
<code class="descclassname">pysnptools.util.</code><code class="descname">sub_matrix</code><span class="sig-paren">(</span><em>val</em>, <em>row_index_list</em>, <em>col_index_list</em>, <em>order='A'</em>, <em>dtype=&lt;type 'numpy.float64'&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.sub_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Efficiently creates a sub-matrix from a 2-D ndarray.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>val</strong> (<em>ndarray</em>) &#8211; The ndarray from which to copy.</li>
<li><strong>row_index_list</strong> (<em>list of integers</em>) &#8211; Tells which rows (and in which order) to copy into the sub-matrix</li>
<li><strong>col_index_list</strong> (<em>list of integers</em>) &#8211; Tells which columns (and in which order) to copy into the sub-matrix</li>
<li><strong>order</strong> (<em>string or None</em>) &#8211; {&#8216;A&#8217; (default), &#8216;C&#8217;, &#8216;F&#8217;}, optional &#8211; Specify the order of the sub-matrix to create.
If order is &#8216;C&#8217;, then the returned sub-matrix will be in C-contiguous order (first index varies the fastest).
If order is &#8216;F&#8217;, then the array will be in F-contiguous order (second index varies the fastest).
If order is &#8216;A&#8217;, then sub-matrix may be in any order F or C.</li>
<li><strong>dtype</strong> (<em>data-type</em>) &#8211; {scipy.float64 (default), scipy.float32}, optional &#8211; The data-type for sub-matrix created.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pysnptools.util</span> <span class="k">as</span> <span class="nn">pstutil</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="c1"># set seed so that results are deterministic</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span> <span class="c1"># create a 12 x 7 ndarray</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">submatrix</span> <span class="o">=</span> <span class="n">pstutil</span><span class="o">.</span><span class="n">sub_matrix</span><span class="p">(</span><span class="n">matrix</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">11</span><span class="p">],[</span><span class="mi">6</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">submatrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span><span class="nb">int</span><span class="p">(</span><span class="n">submatrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
<span class="go">(3, 7)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">matrix</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">submatrix</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">]</span> <span class="c1">#The row # 2 is now #1, the column #0 is now #6.</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Note: Behind the scenes, for performance, this function selects and then calls one of 16 C++ helper functions.</p>
</dd></dl>

<dl class="function">
<dt id="pysnptools.util.weighted_mean">
<code class="descclassname">pysnptools.util.</code><code class="descname">weighted_mean</code><span class="sig-paren">(</span><em>ys</em>, <em>weights</em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.weighted_mean" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>ys</strong> (<em>ndarray</em>) &#8211; The ndarray of values</li>
<li><strong>weights</strong> (<em>ndarray</em>) &#8211; the weight of each value (unnormalized is fine)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">the weight mean</p>
</td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ys</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">103.664086</span><span class="p">,</span><span class="mf">89.80645161</span><span class="p">,</span><span class="mf">83.86888046</span><span class="p">,</span><span class="mf">90.54141176</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">2.340862423</span><span class="p">,</span><span class="mf">4.982888433</span><span class="p">,</span><span class="mf">0.17522245</span><span class="p">,</span><span class="mf">0.098562628</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">round</span><span class="p">(</span><span class="n">weighted_mean</span><span class="p">(</span><span class="n">ys</span><span class="p">,</span> <span class="n">weights</span><span class="p">),</span><span class="mi">5</span><span class="p">)</span>
<span class="go">93.9487</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pysnptools.util.weighted_simple_linear_regression">
<code class="descclassname">pysnptools.util.</code><code class="descname">weighted_simple_linear_regression</code><span class="sig-paren">(</span><em>xs</em>, <em>ys</em>, <em>weights</em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.weighted_simple_linear_regression" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>xs</strong> (<em>ndarray</em>) &#8211; The ndarray of independent values</li>
<li><strong>ys</strong> (<em>ndarray</em>) &#8211; The ndarray of dependent values</li>
<li><strong>weights</strong> (<em>ndarray</em>) &#8211; the weight of each case (unnormalized is fine)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">slope, intercept, xmean, ymean</p>
</td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">xs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">53.8329911</span><span class="p">,</span><span class="mf">57.49486653</span><span class="p">,</span><span class="mf">60.07392197</span><span class="p">,</span><span class="mf">60.21081451</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ys</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">103.664086</span><span class="p">,</span><span class="mf">89.80645161</span><span class="p">,</span><span class="mf">83.86888046</span><span class="p">,</span><span class="mf">90.54141176</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">2.340862423</span><span class="p">,</span><span class="mf">4.982888433</span><span class="p">,</span><span class="mf">0.17522245</span><span class="p">,</span><span class="mf">0.098562628</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">slope</span><span class="p">,</span> <span class="n">intercept</span><span class="p">,</span> <span class="n">xmean</span><span class="p">,</span> <span class="n">ymean</span> <span class="o">=</span> <span class="n">weighted_simple_linear_regression</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">ys</span><span class="p">,</span> <span class="n">weights</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="nb">round</span><span class="p">(</span><span class="n">slope</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span> <span class="nb">round</span><span class="p">(</span><span class="n">intercept</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span> <span class="nb">round</span><span class="p">(</span><span class="n">xmean</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span> <span class="nb">round</span><span class="p">(</span><span class="n">ymean</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="go">-3.52643 293.05586 56.46133 93.9487</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="util-intrangeset">
<h3><code class="xref py py-class docutils literal"><span class="pre">util.IntRangeSet</span></code><a class="headerlink" href="#util-intrangeset" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="pysnptools.util.IntRangeSet">
<em class="property">class </em><code class="descclassname">pysnptools.util.</code><code class="descname">IntRangeSet</code><span class="sig-paren">(</span><em>*ranges_inputs</em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.IntRangeSet" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>A class for efficiently manipulating ranges of integers (including negatives and longs) using set operations such as <a class="reference internal" href="#pysnptools.util.IntRangeSet.union" title="pysnptools.util.IntRangeSet.union"><code class="xref py py-meth docutils literal"><span class="pre">union()</span></code></a>, <a class="reference internal" href="#pysnptools.util.IntRangeSet.intersection" title="pysnptools.util.IntRangeSet.intersection"><code class="xref py py-meth docutils literal"><span class="pre">intersection()</span></code></a>, and difference.</p>
<p>The class differs from the built-in <em>set</em> class (and from Boolean numpy arrays) because it does not need to store every element in the set, only for every contiguous range of elements.
It differs from other Python interval libraries (that we know of) by being specialized and optimized for integer elements.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<p>Here we take the union (operator &#8220;|&#8221;) of two IntRangeSets:</p>
<img alt="_images/example1.png" src="_images/example1.png" />
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="s2">&quot;100:500,501:1000&quot;</span><span class="p">)</span> <span class="c1"># a is the set of integers from 100 to 500 (exclusive) and 501 to 1000 (exclusive)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="s2">&quot;-20,400:600&quot;</span><span class="p">)</span>      <span class="c1"># b is the set of integers -20 and the range 400 to 600 (exclusive)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">a</span> <span class="o">|</span> <span class="n">b</span>                           <span class="c1"># c is the union of a and b, namely -20 and 100 to 1000 (exclusive)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">c</span>
<span class="go">IntRangeSet(&#39;-20,100:1000&#39;)</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<p>Suppose we want to find the intron regions of a gene but we are given only the transcription region and the exon regions.</p>
<img alt="_images/example2.png" src="_images/example2.png" />
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.util</span> <span class="k">import</span> <span class="n">IntRangeSet</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">line</span> <span class="o">=</span> <span class="s2">&quot;chr15   29370   37380   29370,32358,36715   30817,32561,37380&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">chr</span><span class="p">,</span><span class="n">trans_start</span><span class="p">,</span><span class="n">trans_last</span><span class="p">,</span><span class="n">exon_starts</span><span class="p">,</span><span class="n">exon_lasts</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span> <span class="c1"># split the line on white space</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">trans_start</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">trans_start</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">trans_stop</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">trans_last</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span> <span class="c1"># add one to convert the inclusive &quot;last&quot; value into a Pythonesque exclusive &quot;stop&quot; value</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">int_range_set</span> <span class="o">=</span> <span class="n">IntRangeSet</span><span class="p">((</span><span class="n">trans_start</span><span class="p">,</span><span class="n">trans_stop</span><span class="p">))</span> <span class="c1"># creates a IntRangeSet from 29370 (inclusive) to 37381 (exclusive)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">int_range_set</span> <span class="c1"># print at any time to see the current value</span>
<span class="go">IntRangeSet(&#39;29370:37381&#39;)</span>
</pre></div>
</div>
<p>Parse the exon start and last lists from strings to lists of integers (converting &#8216;last&#8217; to &#8216;stop&#8217;)</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">exon_starts</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">start</span><span class="p">)</span> <span class="k">for</span> <span class="n">start</span> <span class="ow">in</span> <span class="n">exon_starts</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">exon_stops</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">last</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span> <span class="k">for</span> <span class="n">last</span> <span class="ow">in</span> <span class="n">exon_lasts</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">exon_starts</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">exon_stops</span><span class="p">)</span>
</pre></div>
</div>
<p>Zip together the two lists to create an iterable of exon_start,exon_stop tuples. Then
&#8216;set subtract&#8217; all these ranges from int_range_set</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">itertools</span> <span class="k">import</span> <span class="n">izip</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">int_range_set</span> <span class="o">-=</span> <span class="n">izip</span><span class="p">(</span><span class="n">exon_starts</span><span class="p">,</span><span class="n">exon_stops</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">int_range_set</span> <span class="c1"># See what it looks like</span>
<span class="go">IntRangeSet(&#39;30818:32358,32562:36715&#39;)</span>
</pre></div>
</div>
<p>Create the desired output by iterating through each contiguous range of integers</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">start</span><span class="p">,</span> <span class="n">stop</span> <span class="ow">in</span> <span class="n">int_range_set</span><span class="o">.</span><span class="n">ranges</span><span class="p">():</span>
<span class="gp">... </span>   <span class="nb">print</span> <span class="s2">&quot;</span><span class="si">{0}</span><span class="s2">   </span><span class="si">{1}</span><span class="s2">     </span><span class="si">{2}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">chr</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="go">chr15   30818     32357</span>
<span class="go">chr15   32562     36714</span>
</pre></div>
</div>
<p><strong>Ranges Input</strong></p>
<p>The input to the <a class="reference internal" href="#pysnptools.util.IntRangeSet" title="pysnptools.util.IntRangeSet"><code class="xref py py-class docutils literal"><span class="pre">IntRangeSet</span></code></a> constructor and many of its methods is a <em>ranges input</em>.</p>
<p>A <em>ranges input</em> is one of the following:</p>
<blockquote>
<div><ul class="simple">
<li>A comma-separated string of integers or integer ranges, e.g., <code class="docutils literal"><span class="pre">'100:500,500:1000,2000'</span></code></li>
<li>An integer or integer expression, e.g., <code class="docutils literal"><span class="pre">3</span></code></li>
<li>A tuple of two integers, <em>start</em> and <em>stop</em>, e.g., <code class="docutils literal"><span class="pre">(2,8)</span></code>. <em>stop</em> is exclusive.</li>
<li>A slice with non-negative values, e.g. <code class="docutils literal"><span class="pre">slice(2,8)</span></code></li>
<li>A <a class="reference internal" href="#pysnptools.util.IntRangeSet" title="pysnptools.util.IntRangeSet"><code class="xref py py-class docutils literal"><span class="pre">IntRangeSet</span></code></a> (or any class with a <a class="reference internal" href="#pysnptools.util.IntRangeSet.ranges" title="pysnptools.util.IntRangeSet.ranges"><code class="xref py py-meth docutils literal"><span class="pre">ranges()</span></code></a> method), e.g., <code class="docutils literal"><span class="pre">IntRangeSet(3)</span></code></li>
<li>A list or iterable (but not tuple) of <em>ranges inputs</em>, e.g., <code class="docutils literal"><span class="pre">[1,6,7,(100,200)]</span></code></li>
</ul>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<p>Strings:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="s2">&quot;100:500,500:1000,2000&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;-10:-8,1,2,3:11&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>The ranges in an <em>ranges input</em> can overlap and can be in any order.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="s2">&quot;2000,100:1500,500:1000,2000&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;100:1500,2000&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Integers and Integer Expressions:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="mi">151000000000</span><span class="p">)</span> <span class="c1"># longs are OK</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="mi">3</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># integer expressions are OK</span>
</pre></div>
</div>
<p>A tuple must have exactly two integers. They represent the <em>start</em> (inclusive) and <em>stop</em> (exclusive) integers in a range.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">IntRangeSet</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span> <span class="o">==</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;2:8&#39;</span><span class="p">)</span> <span class="c1"># check &#39;set equality&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="mi">7</span> <span class="ow">in</span> <span class="n">IntRangeSet</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span> <span class="c1"># The integer 7 is an element of the set</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">IntRangeSet</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span> <span class="o">==</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<p>Lists and iterables of <em>ranges inputs</em>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">IntRangeSet</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,(</span><span class="mi">100</span><span class="p">,</span><span class="mi">200</span><span class="p">)])</span> <span class="o">==</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;1,6:8,100:200&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="n">xrange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">100</span><span class="p">))</span> <span class="o">==</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;0:100&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">IntRangeSet</span><span class="p">([</span><span class="n">xrange</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="mi">200</span><span class="p">),</span><span class="mi">3</span><span class="p">,</span><span class="s1">&#39;1000:2000&#39;</span><span class="p">,[</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">],(</span><span class="mi">20</span><span class="p">,</span><span class="mi">30</span><span class="p">)])</span> <span class="o">==</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;3:5,6,20:30,100:200,1000:2000&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Some methods accept zero or more <em>ranges input</em> as their input. This is called a <em>*ranges_inputs</em>. For example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">IntRangeSet</span><span class="p">()</span> <span class="c1"># zero ranges inputs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="c1"># one ranges input</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;3:11,5&#39;</span><span class="p">,</span><span class="mi">14</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span> <span class="c1"># Three ranges inputs, a string and two integers.</span>
</pre></div>
</div>
</div></blockquote>
<p><strong>Most Important Methods and Operators</strong></p>
<table border="1" class="docutils">
<colgroup>
<col width="38%" />
<col width="38%" />
<col width="24%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><em>Description</em></td>
<td><em>Method or Operator</em></td>
<td><em>For Details</em></td>
</tr>
<tr class="row-even"><td>is a &#8216;set equal&#8217; to b?</td>
<td><code class="docutils literal"><span class="pre">a</span> <span class="pre">==</span> <span class="pre">b</span></code></td>
<td><a class="reference internal" href="#pysnptools.util.IntRangeSet.__eq__" title="pysnptools.util.IntRangeSet.__eq__"><code class="xref py py-meth docutils literal"><span class="pre">__eq__()</span></code></a></td>
</tr>
<tr class="row-odd"><td>is a is superset of b?</td>
<td><code class="docutils literal"><span class="pre">b</span> <span class="pre">in</span> <span class="pre">a</span></code>,
<code class="docutils literal"><span class="pre">a.issuperset(b)</span></code>,
<code class="docutils literal"><span class="pre">a</span> <span class="pre">&gt;=</span> <span class="pre">b</span></code></td>
<td><a class="reference internal" href="#pysnptools.util.IntRangeSet.__contains__" title="pysnptools.util.IntRangeSet.__contains__"><code class="xref py py-meth docutils literal"><span class="pre">__contains__()</span></code></a></td>
</tr>
<tr class="row-even"><td>is a is subset of b?</td>
<td><code class="docutils literal"><span class="pre">a</span> <span class="pre">&lt;=</span> <span class="pre">b</span></code>,
<code class="docutils literal"><span class="pre">a.issubset(b)</span></code></td>
<td><a class="reference internal" href="#pysnptools.util.IntRangeSet.__le__" title="pysnptools.util.IntRangeSet.__le__"><code class="xref py py-meth docutils literal"><span class="pre">__le__()</span></code></a></td>
</tr>
<tr class="row-odd"><td>remove <em>i</em> th smallest element(s)</td>
<td><code class="docutils literal"><span class="pre">del</span> <span class="pre">a[i]</span></code></td>
<td><a class="reference internal" href="#pysnptools.util.IntRangeSet.__delitem__" title="pysnptools.util.IntRangeSet.__delitem__"><code class="xref py py-meth docutils literal"><span class="pre">__delitem__()</span></code></a></td>
</tr>
<tr class="row-even"><td>get <em>i</em> th smallest element(s)</td>
<td><code class="docutils literal"><span class="pre">a[i]</span></code></td>
<td><a class="reference internal" href="#pysnptools.util.IntRangeSet.__getitem__" title="pysnptools.util.IntRangeSet.__getitem__"><code class="xref py py-meth docutils literal"><span class="pre">__getitem__()</span></code></a></td>
</tr>
<tr class="row-odd"><td>is a not &#8216;set equal&#8217; to b?</td>
<td><code class="docutils literal"><span class="pre">a</span> <span class="pre">!=</span> <span class="pre">b</span></code></td>
<td><a class="reference internal" href="#pysnptools.util.IntRangeSet.__ne__" title="pysnptools.util.IntRangeSet.__ne__"><code class="xref py py-meth docutils literal"><span class="pre">__ne__()</span></code></a></td>
</tr>
<tr class="row-even"><td>is a is proper superset of b?</td>
<td><code class="docutils literal"><span class="pre">a</span> <span class="pre">&gt;</span> <span class="pre">b</span></code></td>
<td><a class="reference internal" href="#pysnptools.util.IntRangeSet.__gt__" title="pysnptools.util.IntRangeSet.__gt__"><code class="xref py py-meth docutils literal"><span class="pre">__gt__()</span></code></a></td>
</tr>
<tr class="row-odd"><td>is a is proper subset of b?</td>
<td><code class="docutils literal"><span class="pre">a</span> <span class="pre">&lt;</span> <span class="pre">b</span></code></td>
<td><a class="reference internal" href="#pysnptools.util.IntRangeSet.__lt__" title="pysnptools.util.IntRangeSet.__lt__"><code class="xref py py-meth docutils literal"><span class="pre">__lt__()</span></code></a></td>
</tr>
<tr class="row-even"><td>union b into a</td>
<td><code class="docutils literal"><span class="pre">a</span> <span class="pre">|=</span> <span class="pre">b</span></code>,
<code class="docutils literal"><span class="pre">a</span> <span class="pre">+=</span> <span class="pre">b</span></code>,
<code class="docutils literal"><span class="pre">a.add(b,c)</span></code>,
<code class="docutils literal"><span class="pre">a.update(b,c)</span></code></td>
<td><a class="reference internal" href="#pysnptools.util.IntRangeSet.add" title="pysnptools.util.IntRangeSet.add"><code class="xref py py-meth docutils literal"><span class="pre">add()</span></code></a></td>
</tr>
<tr class="row-odd"><td>union a and b</td>
<td><code class="docutils literal"><span class="pre">a</span> <span class="pre">|</span> <span class="pre">b</span></code>,
<code class="docutils literal"><span class="pre">a</span> <span class="pre">b</span></code>,
<code class="docutils literal"><span class="pre">a.union(b,c)</span></code></td>
<td><a class="reference internal" href="#pysnptools.util.IntRangeSet.__or__" title="pysnptools.util.IntRangeSet.__or__"><code class="xref py py-meth docutils literal"><span class="pre">__or__()</span></code></a></td>
</tr>
<tr class="row-even"><td>intersect b into a</td>
<td><code class="docutils literal"><span class="pre">a</span> <span class="pre">&amp;=</span> <span class="pre">b</span></code>,
<code class="docutils literal"><span class="pre">a.intersection_update(b,c)</span></code>,</td>
<td><a class="reference internal" href="#pysnptools.util.IntRangeSet.__iand__" title="pysnptools.util.IntRangeSet.__iand__"><code class="xref py py-meth docutils literal"><span class="pre">__iand__()</span></code></a></td>
</tr>
<tr class="row-odd"><td>intersect a and b</td>
<td><code class="docutils literal"><span class="pre">a</span> <span class="pre">&amp;</span> <span class="pre">b</span></code>,
<code class="docutils literal"><span class="pre">a.intersection(b,c)</span></code></td>
<td><a class="reference internal" href="#pysnptools.util.IntRangeSet.intersection" title="pysnptools.util.IntRangeSet.intersection"><code class="xref py py-meth docutils literal"><span class="pre">intersection()</span></code></a></td>
</tr>
<tr class="row-even"><td>subtract b from in a</td>
<td><code class="docutils literal"><span class="pre">a</span> <span class="pre">-=</span> <span class="pre">b</span></code>,
<code class="docutils literal"><span class="pre">a.difference_update(b)</span></code>,
<code class="docutils literal"><span class="pre">a.discard(b)</span></code>,</td>
<td><a class="reference internal" href="#pysnptools.util.IntRangeSet.__isub__" title="pysnptools.util.IntRangeSet.__isub__"><code class="xref py py-meth docutils literal"><span class="pre">__isub__()</span></code></a></td>
</tr>
<tr class="row-odd"><td>remove b from a, error if missing</td>
<td><code class="docutils literal"><span class="pre">a.remove(b)</span></code></td>
<td><a class="reference internal" href="#pysnptools.util.IntRangeSet.remove" title="pysnptools.util.IntRangeSet.remove"><code class="xref py py-meth docutils literal"><span class="pre">remove()</span></code></a></td>
</tr>
<tr class="row-even"><td>a &#8216;set difference&#8217; b</td>
<td><code class="docutils literal"><span class="pre">a</span> <span class="pre">-</span> <span class="pre">b</span></code>,
<code class="docutils literal"><span class="pre">a.difference(b)</span></code></td>
<td><a class="reference internal" href="#pysnptools.util.IntRangeSet.__sub__" title="pysnptools.util.IntRangeSet.__sub__"><code class="xref py py-meth docutils literal"><span class="pre">__sub__()</span></code></a></td>
</tr>
<tr class="row-odd"><td>iterate integers in a, from low</td>
<td><code class="docutils literal"><span class="pre">for</span> <span class="pre">element</span> <span class="pre">in</span> <span class="pre">a:</span></code></td>
<td><a class="reference internal" href="#pysnptools.util.IntRangeSet.__iter__" title="pysnptools.util.IntRangeSet.__iter__"><code class="xref py py-meth docutils literal"><span class="pre">__iter__()</span></code></a></td>
</tr>
<tr class="row-even"><td>iterate integers in a, from high</td>
<td><code class="docutils literal"><span class="pre">for</span> <span class="pre">element</span> <span class="pre">in</span> <span class="pre">reverse(a):</span></code></td>
<td><a class="reference internal" href="#pysnptools.util.IntRangeSet.__reversed__" title="pysnptools.util.IntRangeSet.__reversed__"><code class="xref py py-meth docutils literal"><span class="pre">__reversed__()</span></code></a></td>
</tr>
<tr class="row-odd"><td>symmetric difference into a</td>
<td><code class="docutils literal"><span class="pre">a</span> <span class="pre">^=</span> <span class="pre">b</span></code></td>
<td><a class="reference internal" href="#pysnptools.util.IntRangeSet.__ixor__" title="pysnptools.util.IntRangeSet.__ixor__"><code class="xref py py-meth docutils literal"><span class="pre">__ixor__()</span></code></a></td>
</tr>
<tr class="row-even"><td>a &#8216;symmetric difference&#8217; b</td>
<td><code class="docutils literal"><span class="pre">a</span> <span class="pre">^</span> <span class="pre">b</span></code></td>
<td><a class="reference internal" href="#pysnptools.util.IntRangeSet.__xor__" title="pysnptools.util.IntRangeSet.__xor__"><code class="xref py py-meth docutils literal"><span class="pre">__xor__()</span></code></a></td>
</tr>
<tr class="row-odd"><td>count of integer elements in a</td>
<td><code class="docutils literal"><span class="pre">len(a)</span></code></td>
<td><a class="reference internal" href="#pysnptools.util.IntRangeSet.__len__" title="pysnptools.util.IntRangeSet.__len__"><code class="xref py py-meth docutils literal"><span class="pre">__len__()</span></code></a></td>
</tr>
<tr class="row-even"><td>iterate ranges in a, from low</td>
<td><code class="docutils literal"><span class="pre">for</span> <span class="pre">start,stop</span> <span class="pre">in</span> <span class="pre">a.ranges():</span></code></td>
<td><a class="reference internal" href="#pysnptools.util.IntRangeSet.ranges" title="pysnptools.util.IntRangeSet.ranges"><code class="xref py py-meth docutils literal"><span class="pre">ranges()</span></code></a></td>
</tr>
<tr class="row-odd"><td>count of ranges in a</td>
<td><code class="docutils literal"><span class="pre">a.ranges_len</span></code></td>
<td><a class="reference internal" href="#pysnptools.util.IntRangeSet.ranges_len" title="pysnptools.util.IntRangeSet.ranges_len"><code class="xref py py-meth docutils literal"><span class="pre">ranges_len()</span></code></a></td>
</tr>
<tr class="row-even"><td>index of range containing b</td>
<td><code class="docutils literal"><span class="pre">a.ranges_index(b)</span></code></td>
<td><a class="reference internal" href="#pysnptools.util.IntRangeSet.ranges_index" title="pysnptools.util.IntRangeSet.ranges_index"><code class="xref py py-meth docutils literal"><span class="pre">ranges_index()</span></code></a></td>
</tr>
<tr class="row-odd"><td>get <em>i</em> th smallest range</td>
<td><code class="docutils literal"><span class="pre">a.ranges_getitem(i)</span></code></td>
<td><a class="reference internal" href="#pysnptools.util.IntRangeSet.ranges_getitem" title="pysnptools.util.IntRangeSet.ranges_getitem"><code class="xref py py-meth docutils literal"><span class="pre">ranges_getitem()</span></code></a></td>
</tr>
<tr class="row-even"><td>a as a string</td>
<td><code class="docutils literal"><span class="pre">str(a)</span></code></td>
<td><a class="reference internal" href="#pysnptools.util.IntRangeSet.__str__" title="pysnptools.util.IntRangeSet.__str__"><code class="xref py py-meth docutils literal"><span class="pre">__str__()</span></code></a></td>
</tr>
<tr class="row-odd"><td>remove all elements from a</td>
<td><code class="docutils literal"><span class="pre">a.clear()</span></code></td>
<td><a class="reference internal" href="#pysnptools.util.IntRangeSet.clear" title="pysnptools.util.IntRangeSet.clear"><code class="xref py py-meth docutils literal"><span class="pre">clear()</span></code></a></td>
</tr>
<tr class="row-even"><td>copy a</td>
<td><code class="docutils literal"><span class="pre">a.copy()</span></code></td>
<td><a class="reference internal" href="#pysnptools.util.IntRangeSet.copy" title="pysnptools.util.IntRangeSet.copy"><code class="xref py py-meth docutils literal"><span class="pre">copy()</span></code></a></td>
</tr>
<tr class="row-odd"><td>find index of b in a</td>
<td><code class="docutils literal"><span class="pre">a.index(b)</span></code></td>
<td><a class="reference internal" href="#pysnptools.util.IntRangeSet.index" title="pysnptools.util.IntRangeSet.index"><code class="xref py py-meth docutils literal"><span class="pre">index()</span></code></a></td>
</tr>
<tr class="row-even"><td>are a and b disjoint?</td>
<td><code class="docutils literal"><span class="pre">a.isdisjoint(b)</span></code></td>
<td><a class="reference internal" href="#pysnptools.util.IntRangeSet.isdisjoint" title="pysnptools.util.IntRangeSet.isdisjoint"><code class="xref py py-meth docutils literal"><span class="pre">isdisjoint()</span></code></a></td>
</tr>
<tr class="row-odd"><td>is a empty?</td>
<td><code class="docutils literal"><span class="pre">a.isempty(b)</span></code></td>
<td><a class="reference internal" href="#pysnptools.util.IntRangeSet.isempty" title="pysnptools.util.IntRangeSet.isempty"><code class="xref py py-meth docutils literal"><span class="pre">isempty()</span></code></a></td>
</tr>
<tr class="row-even"><td>smallest element of a</td>
<td><code class="docutils literal"><span class="pre">a.min()</span></code></td>
<td><a class="reference internal" href="#pysnptools.util.IntRangeSet.min" title="pysnptools.util.IntRangeSet.min"><code class="xref py py-meth docutils literal"><span class="pre">min()</span></code></a></td>
</tr>
<tr class="row-odd"><td>largest element of a</td>
<td><code class="docutils literal"><span class="pre">a.max()</span></code></td>
<td><a class="reference internal" href="#pysnptools.util.IntRangeSet.max" title="pysnptools.util.IntRangeSet.max"><code class="xref py py-meth docutils literal"><span class="pre">max()</span></code></a></td>
</tr>
<tr class="row-even"><td>sum of elements in a</td>
<td><code class="docutils literal"><span class="pre">a.sum()</span></code></td>
<td><a class="reference internal" href="#pysnptools.util.IntRangeSet.sum" title="pysnptools.util.IntRangeSet.sum"><code class="xref py py-meth docutils literal"><span class="pre">sum()</span></code></a></td>
</tr>
<tr class="row-odd"><td>remove and return an element</td>
<td><code class="docutils literal"><span class="pre">a.pop()</span></code></td>
<td><a class="reference internal" href="#pysnptools.util.IntRangeSet.pop" title="pysnptools.util.IntRangeSet.pop"><code class="xref py py-meth docutils literal"><span class="pre">pop()</span></code></a></td>
</tr>
</tbody>
</table>
<p><strong>Examples, Tips, and Warnings</strong></p>
<p>The argument to a method and the right-hand side of an operator can be a <em>ranges input</em> rather than <a class="reference internal" href="#pysnptools.util.IntRangeSet" title="pysnptools.util.IntRangeSet"><code class="xref py py-class docutils literal"><span class="pre">IntRangeSet</span></code></a>. For example,</p>
<blockquote>
<div><div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">big</span> <span class="o">=</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;-1000:2000&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">big</span> <span class="o">-</span> <span class="s1">&#39;10:20,500&#39;</span> <span class="c1"># We can subtract this string because it is a legal ranges input.</span>
<span class="go">IntRangeSet(&#39;-1000:10,20:500,501:2000&#39;)</span>
</pre></div>
</div>
<p>This even works for equality testing:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">big</span> <span class="o">-</span> <span class="s1">&#39;10:21,500&#39;</span> <span class="o">==</span> <span class="s1">&#39;-1000:10,21:500,501:2000&#39;</span>
</pre></div>
</div>
<p>The Python <em>in</em> operator is backwards from other operators, so the left-hand side can be any <em>ranges input</em>.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="mi">501</span> <span class="ow">in</span> <span class="n">big</span>
</pre></div>
</div>
</div></blockquote>
<p>Like most other Python libraries you specify a range with an inclusive <em>start</em> integer and an exclusive <em>stop</em>.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="mi">7</span> <span class="ow">in</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;4:8&#39;</span><span class="p">)</span> <span class="c1"># includes 7</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="mi">8</span> <span class="ow">in</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;4:8&#39;</span><span class="p">)</span> <span class="c1"># excludes 8</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="mi">8</span> <span class="ow">in</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="n">xrange</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span> <span class="c1"># also excludes 8</span>
<span class="go">False</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Be careful with the <em>ranges inputs</em> specified with tuples. Suppose we want a <a class="reference internal" href="#pysnptools.util.IntRangeSet" title="pysnptools.util.IntRangeSet"><code class="xref py py-class docutils literal"><span class="pre">IntRangeSet</span></code></a> containing 4,5,6,7.</dt>
<dd><div class="first last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">IntRangeSet</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span> <span class="o">==</span> <span class="s1">&#39;4:8&#39;</span> <span class="c1">#OK</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">IntRangeSet</span><span class="p">([(</span><span class="mi">4</span><span class="p">,</span><span class="mi">8</span><span class="p">)])</span> <span class="o">==</span> <span class="s1">&#39;4:8&#39;</span> <span class="c1"># List of a tuple is OK</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;4,8&#39;</span> <span class="c1">#No. This is not a tuple. It is two integer inputs, so we get only 4 and 8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">IntRangeSet</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span><span class="mi">8</span><span class="p">])</span> <span class="o">==</span> <span class="s1">&#39;4,8&#39;</span> <span class="c1">#No. List of two integers, so get only 4 and 8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#Illegal: IntRangeSet((4,8,10)) # tuples must be pairs</span>
</pre></div>
</div>
</dd>
</dl>
<p><strong>Methods and Operators</strong></p>
<dl class="method">
<dt id="pysnptools.util.IntRangeSet.__contains__">
<code class="descname">__contains__</code><span class="sig-paren">(</span><em>*ranges_inputs</em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.IntRangeSet.__contains__" title="Permalink to this definition">¶</a></dt>
<dd><p>True exactly when all the ranges input is a subset of the IntRangeSet.</p>
<p>These are the same:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">b</span> <span class="pre">in</span> <span class="pre">a</span></code></li>
<li><code class="docutils literal"><span class="pre">a.issuperset(b)</span></code></li>
<li><code class="docutils literal"><span class="pre">a</span> <span class="pre">&gt;=</span> <span class="pre">b</span></code></li>
</ul>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="mi">3</span> <span class="ow">in</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;0:5,6:11&#39;</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;4:7&#39;</span><span class="p">)</span> <span class="ow">in</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;0:5,6:11&#39;</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="s1">&#39;6:9&#39;</span> <span class="ow">in</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;0:5,6:11&#39;</span><span class="p">)</span> <span class="c1"># The left-hand of &#39;in&#39; can be any ranges input</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;0:5,6:11&#39;</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="s1">&#39;6:9&#39;</span> <span class="c1"># The right-hand of can be any ranges input</span>
<span class="go">True</span>
</pre></div>
</div>
<p>The &#8216;issuperset&#8217; method also supports unioning multiple ranges inputs.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;0:5,6:11&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">issuperset</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;0:5,6:11&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">issuperset</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
<p>Note: By definition, any set is a superset of itself.</p>
</dd></dl>

<dl class="method">
<dt id="pysnptools.util.IntRangeSet.__delitem__">
<code class="descname">__delitem__</code><span class="sig-paren">(</span><em>key</em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.IntRangeSet.__delitem__" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove elements from the IntRangeSet by position index. Position index can be specified by an integer with
negative integers counting from the end. Position indexes can also be specified with slices and a ranges input.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<p>Removing with an integer position index:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;100:200,1000&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">del</span> <span class="n">a</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">a</span>
<span class="go">IntRangeSet(&#39;100:102,103:200,1000&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">del</span> <span class="n">a</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">a</span>
<span class="go">IntRangeSet(&#39;100:102,103:200&#39;)</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<p>Removing with a slice:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;100:200,1000&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">del</span> <span class="n">a</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="mi">11</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">a</span>
<span class="go">IntRangeSet(&#39;100:102,111:200,1000&#39;)</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<p>Removing with a ranges input:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;100:200,1000&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">del</span> <span class="n">a</span><span class="p">[</span><span class="s1">&#39;2:11&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">a</span>
<span class="go">IntRangeSet(&#39;100:102,111:200,1000&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pysnptools.util.IntRangeSet.__eq__">
<code class="descname">__eq__</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.IntRangeSet.__eq__" title="Permalink to this definition">¶</a></dt>
<dd><p>True exactly when the IntRangeSet on the left is <em>set equivalent</em> to the ranges input on the right.</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">a</span> <span class="pre">==</span> <span class="pre">b</span></code></li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;0:10,12&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;0:10,12&#39;</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;0:10,12&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;0:10&#39;</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;0:10,12&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;12,0:5,5:10&#39;</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;0:10,12&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;0:10,12&#39;</span> <span class="c1"># The right-hand can be any ranges input</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pysnptools.util.IntRangeSet.__ge__">
<code class="descname">__ge__</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.IntRangeSet.__ge__" title="Permalink to this definition">¶</a></dt>
<dd><p>See <a class="reference internal" href="#pysnptools.util.IntRangeSet.__contains__" title="pysnptools.util.IntRangeSet.__contains__"><code class="xref py py-meth docutils literal"><span class="pre">IntRangeSet.__contains__()</span></code></a></p>
</dd></dl>

<dl class="method">
<dt id="pysnptools.util.IntRangeSet.__getitem__">
<code class="descname">__getitem__</code><span class="sig-paren">(</span><em>key</em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.IntRangeSet.__getitem__" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="docutils literal"><span class="pre">a[i]</span></code> returns the ith integer in sorted order (origin 0) from a, an IntRangeSet</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;100:200,1000&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">100</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;100:200,1000&#39;</span><span class="p">)[</span><span class="mi">10</span><span class="p">]</span>
<span class="go">110</span>
</pre></div>
</div>
<p>If i is negative, the indexing goes from the end</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;100:200,1000&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="go">1000</span>
</pre></div>
</div>
<p>Python&#8217;s standard slice notation may be used and returns IntRangeSets.
(Remember that the Stop number in slice notation is exclusive.)</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;100:200,1000&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="mi">10</span><span class="p">]</span> <span class="c1"># Integers 0 (inclusive) to 10 (exclusive)</span>
<span class="go">IntRangeSet(&#39;100:110&#39;)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;100:200,1000&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="mi">10</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span> <span class="c1"># Integers 0 (inclusive) to 10 (exclusive) with step 2</span>
<span class="go">IntRangeSet(&#39;100,102,104,106,108&#39;)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;100:200,1000&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">3</span><span class="p">:]</span> <span class="c1"># The last three integers in the IntRangeSet.</span>
<span class="go">IntRangeSet(&#39;198:200,1000&#39;)</span>
</pre></div>
</div>
<p>An IntRangeSet can also be accessed with any ranges input.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;100:200,1000&#39;</span><span class="p">)[</span><span class="s1">&#39;0:10,20&#39;</span><span class="p">]</span>
<span class="go">IntRangeSet(&#39;100:110,120&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pysnptools.util.IntRangeSet.__gt__">
<code class="descname">__gt__</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.IntRangeSet.__gt__" title="Permalink to this definition">¶</a></dt>
<dd><p>True exactly when the IntRangeSet is a proper superset of the ranges.</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">a</span> <span class="pre">&gt;</span> <span class="pre">b</span></code></li>
</ul>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;0:5,6:11&#39;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="s1">&#39;7:10&#39;</span> <span class="c1"># The right-hand can be any ranges input</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Note: By definition, no set is a proper superset of itself.</p>
</dd></dl>

<dl class="method">
<dt id="pysnptools.util.IntRangeSet.__iadd__">
<code class="descname">__iadd__</code><span class="sig-paren">(</span><em>*ranges_inputs</em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.IntRangeSet.__iadd__" title="Permalink to this definition">¶</a></dt>
<dd><p>See <a class="reference internal" href="#pysnptools.util.IntRangeSet.add" title="pysnptools.util.IntRangeSet.add"><code class="xref py py-meth docutils literal"><span class="pre">IntRangeSet.add()</span></code></a></p>
</dd></dl>

<dl class="method">
<dt id="pysnptools.util.IntRangeSet.__iand__">
<code class="descname">__iand__</code><span class="sig-paren">(</span><em>*ranges_inputs</em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.IntRangeSet.__iand__" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the IntRangeSet to itself intersected with a input range</p>
<p>These are the same:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">a</span> <span class="pre">&amp;=</span> <span class="pre">b</span></code></li>
<li><code class="docutils literal"><span class="pre">a.intersection_update(b)</span></code></li>
</ul>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;0:5,6:11&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">&amp;=</span> <span class="s1">&#39;3:8&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">a</span>
<span class="go">IntRangeSet(&#39;3:5,6:8&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pysnptools.util.IntRangeSet.__imul__">
<code class="descname">__imul__</code><span class="sig-paren">(</span><em>n</em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.IntRangeSet.__imul__" title="Permalink to this definition">¶</a></dt>
<dd><p>Put produces n copies of a unioned together in a, where a is an IntRangeSet.
Because a is a set, the result will either be an empty IntRangeSet (n is 0 or less) or the original a.</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">a</span> <span class="pre">*=</span> <span class="pre">n</span></code></li>
</ul>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;0:5,6:11&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">*=</span> <span class="mi">5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">a</span> <span class="c1"># should be unchanged</span>
<span class="go">IntRangeSet(&#39;0:5,6:11&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">*=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">a</span> <span class="c1"># should be empty</span>
<span class="go">IntRangeSet(&#39;&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pysnptools.util.IntRangeSet.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>*ranges_inputs</em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.IntRangeSet.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a <a class="reference internal" href="#pysnptools.util.IntRangeSet" title="pysnptools.util.IntRangeSet"><code class="xref py py-class docutils literal"><span class="pre">IntRangeSet</span></code></a>.</p>
</dd></dl>

<dl class="method">
<dt id="pysnptools.util.IntRangeSet.__ior__">
<code class="descname">__ior__</code><span class="sig-paren">(</span><em>*ranges_inputs</em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.IntRangeSet.__ior__" title="Permalink to this definition">¶</a></dt>
<dd><p>See <a class="reference internal" href="#pysnptools.util.IntRangeSet.add" title="pysnptools.util.IntRangeSet.add"><code class="xref py py-meth docutils literal"><span class="pre">IntRangeSet.add()</span></code></a></p>
</dd></dl>

<dl class="method">
<dt id="pysnptools.util.IntRangeSet.__isub__">
<code class="descname">__isub__</code><span class="sig-paren">(</span><em>*ranges_inputs</em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.IntRangeSet.__isub__" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove the elements of the range inputs from the IntRangeSet</p>
<p>These are the same:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">a</span> <span class="pre">-=</span> <span class="pre">b</span></code></li>
<li><code class="docutils literal"><span class="pre">a.difference_update(b)</span></code></li>
<li><code class="docutils literal"><span class="pre">a.discard(b)</span></code></li>
</ul>
<p><code class="docutils literal"><span class="pre">remove</span></code> is almost the same except that it raises a KeyError if any element of b is not in a.</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">a.remove(b)</span></code></li>
</ul>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;0:5,6:11&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">-=</span> <span class="s1">&#39;3:7&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">a</span>
<span class="go">IntRangeSet(&#39;0:3,7:11&#39;)</span>
</pre></div>
</div>
<p>The &#8216;difference_update&#8217;, &#8216;discard&#8217; and &#8216;remove&#8217; methods also support subtracting multiple ranges inputs.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;0:5,6:11&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">difference_update</span><span class="p">(</span><span class="s1">&#39;3:7&#39;</span><span class="p">,</span><span class="s1">&#39;8:100&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">a</span>
<span class="go">IntRangeSet(&#39;0:3,7&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pysnptools.util.IntRangeSet.__iter__">
<code class="descname">__iter__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.IntRangeSet.__iter__" title="Permalink to this definition">¶</a></dt>
<dd><p>Iterate, in order from smallest to largest, the integer elements of the IntRangeSet</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;1:4,10&#39;</span><span class="p">):</span>
<span class="gp">... </span>   <span class="nb">print</span> <span class="n">i</span>
<span class="go">1</span>
<span class="go">2</span>
<span class="go">3</span>
<span class="go">10</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pysnptools.util.IntRangeSet.__ixor__">
<code class="descname">__ixor__</code><span class="sig-paren">(</span><em>ranges</em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.IntRangeSet.__ixor__" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the IntRangeSet to contains exactly those elements that appear in either itself or the input ranges but not both</p>
<p>These are the same:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">a</span> <span class="pre">^=</span> <span class="pre">b</span></code></li>
<li><code class="docutils literal"><span class="pre">a.symmetric_difference_update(b)</span></code></li>
</ul>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;0:5,6:11&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">^=</span> <span class="s1">&#39;3:8&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">a</span>
<span class="go">IntRangeSet(&#39;0:3,5,8:11&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pysnptools.util.IntRangeSet.__le__">
<code class="descname">__le__</code><span class="sig-paren">(</span><em>ranges</em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.IntRangeSet.__le__" title="Permalink to this definition">¶</a></dt>
<dd><p>True exactly when the IntRangeSet is a subset of the ranges.</p>
<p>These are the same:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">a</span> <span class="pre">&lt;=</span> <span class="pre">b</span></code></li>
<li><code class="docutils literal"><span class="pre">a.issubset(b)</span></code></li>
</ul>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;0:5,6:11&#39;</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="s1">&#39;-1:101&#39;</span> <span class="c1"># The right-hand can be any ranges input</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Note: By definition, any set is a subset of itself.</p>
</dd></dl>

<dl class="method">
<dt id="pysnptools.util.IntRangeSet.__len__">
<code class="descname">__len__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.IntRangeSet.__len__" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of integer elements in the IntRangeSet</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="nb">len</span><span class="p">(</span><span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;0:10,12&#39;</span><span class="p">))</span>
<span class="go">11</span>
</pre></div>
</div>
<p>Note: This is computed in time linear in the number of ranges, rather than integer elements.</p>
</dd></dl>

<dl class="method">
<dt id="pysnptools.util.IntRangeSet.__lt__">
<code class="descname">__lt__</code><span class="sig-paren">(</span><em>ranges</em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.IntRangeSet.__lt__" title="Permalink to this definition">¶</a></dt>
<dd><p>True exactly when the IntRangeSet is a proper subset of the ranges.</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">a</span> <span class="pre">&lt;</span> <span class="pre">b</span></code></li>
</ul>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;0:5,6:11&#39;</span><span class="p">)</span> <span class="o">&lt;</span> <span class="s1">&#39;-1:101&#39;</span> <span class="c1"># The right-hand can be any ranges input</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Note: By definition, no set is a proper subset of itself.</p>
</dd></dl>

<dl class="method">
<dt id="pysnptools.util.IntRangeSet.__mul__">
<code class="descname">__mul__</code><span class="sig-paren">(</span><em>n</em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.IntRangeSet.__mul__" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="docutils literal"><span class="pre">a</span> <span class="pre">*</span> <span class="pre">n</span></code>, produces n shallow copies of a unioned, where a is an IntRangeSet.
Because a is a set, the result will either be an empty IntRangeSet (n is 0 or less) or a copy of
the original IntRangeSet.</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">a</span> <span class="pre">*</span> <span class="pre">n</span></code></li>
</ul>
</dd></dl>

<dl class="method">
<dt id="pysnptools.util.IntRangeSet.__ne__">
<code class="descname">__ne__</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.IntRangeSet.__ne__" title="Permalink to this definition">¶</a></dt>
<dd><p><em>False</em> exactly when the IntRangeSet on the left is <em>set equivalent</em> to the ranges input on the right.</p>
<p>These are the same.</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">a</span> <span class="pre">!=</span> <span class="pre">b</span></code></li>
<li><code class="docutils literal"><span class="pre">not</span> <span class="pre">a</span> <span class="pre">==</span> <span class="pre">b</span></code></li>
</ul>
</dd></dl>

<dl class="method">
<dt id="pysnptools.util.IntRangeSet.__or__">
<code class="descname">__or__</code><span class="sig-paren">(</span><em>*ranges_inputs</em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.IntRangeSet.__or__" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the union of a IntRangeSet with zero or more ranges inputs. The original IntRangeSet is not changed.</p>
<p>These are the same:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">a</span> <span class="pre">|</span> <span class="pre">b</span></code></li>
<li><code class="docutils literal"><span class="pre">a</span> <span class="pre">+</span> <span class="pre">b</span></code></li>
<li><code class="docutils literal"><span class="pre">a.union(b)</span></code></li>
</ul>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;0:5,6:10&#39;</span><span class="p">)</span> <span class="o">|</span> <span class="mi">5</span>
<span class="go">IntRangeSet(&#39;0:10&#39;)</span>
</pre></div>
</div>
<p>The &#8216;union&#8217; method also support unioning multiple ranges inputs,</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;0:5,6:10&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="s1">&#39;100:200&#39;</span><span class="p">)</span>
<span class="go">IntRangeSet(&#39;0:10,100:200&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pysnptools.util.IntRangeSet.__repr__">
<code class="descname">__repr__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.IntRangeSet.__repr__" title="Permalink to this definition">¶</a></dt>
<dd><p>Use the standard repr(a) function to create a string representation of a, an IntRangeSet.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="s2">&quot;Hello &quot;</span> <span class="o">+</span> <span class="nb">repr</span><span class="p">(</span><span class="n">IntRangeSet</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="go">Hello IntRangeSet(&#39;2:5,10&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pysnptools.util.IntRangeSet.__reversed__">
<code class="descname">__reversed__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.IntRangeSet.__reversed__" title="Permalink to this definition">¶</a></dt>
<dd><p>reversed(a) is a generator that produces the integer elements of a in order from largest to smallest.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;1:4,10&#39;</span><span class="p">)):</span>
<span class="gp">... </span>    <span class="nb">print</span> <span class="n">i</span>
<span class="go">10</span>
<span class="go">3</span>
<span class="go">2</span>
<span class="go">1</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pysnptools.util.IntRangeSet.__str__">
<code class="descname">__str__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.IntRangeSet.__str__" title="Permalink to this definition">¶</a></dt>
<dd><p>Use the standard str(a) function to create a string representation of a, an IntRangeSet.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="s2">&quot;Hello &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">IntRangeSet</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="go">Hello IntRangeSet(&#39;2:5,10&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pysnptools.util.IntRangeSet.__sub__">
<code class="descname">__sub__</code><span class="sig-paren">(</span><em>*ranges_inputs</em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.IntRangeSet.__sub__" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the set difference of a IntRangeSet with zero or more ranges inputs. The original IntRangeSet is not changed.</p>
<p>These are the same:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">a</span> <span class="pre">-</span> <span class="pre">b</span></code></li>
<li><code class="docutils literal"><span class="pre">a.difference(b)</span></code></li>
</ul>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;0:5,6:11&#39;</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
<span class="go">IntRangeSet(&#39;0,2:5,6:11&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;0:5,6:11&#39;</span><span class="p">)</span> <span class="o">-</span> <span class="s1">&#39;3:100&#39;</span>
<span class="go">IntRangeSet(&#39;0:3&#39;)</span>
</pre></div>
</div>
<p>The &#8216;difference&#8217; method also supports subtracting multiple input ranges</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;0:5,6:11&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="s1">&#39;3:100&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="go">IntRangeSet(&#39;0,2&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pysnptools.util.IntRangeSet.__xor__">
<code class="descname">__xor__</code><span class="sig-paren">(</span><em>ranges</em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.IntRangeSet.__xor__" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a new IntRangeSet set with elements in either the input IntRangeSet or the input range but not both.</p>
<p>These are the same:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">a</span> <span class="pre">^</span> <span class="pre">b</span></code></li>
<li><code class="docutils literal"><span class="pre">a.symmetric_difference(b)</span></code></li>
</ul>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;0:5,6:11&#39;</span><span class="p">)</span> <span class="o">^</span> <span class="s1">&#39;3:9&#39;</span>
<span class="go">IntRangeSet(&#39;0:3,5,9:11&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pysnptools.util.IntRangeSet.add">
<code class="descname">add</code><span class="sig-paren">(</span><em>*ranges_inputs</em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.IntRangeSet.add" title="Permalink to this definition">¶</a></dt>
<dd><p>Union zero or more ranges inputs into the current IntRangeSet.</p>
<p>These are the same:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">a</span> <span class="pre">|=</span> <span class="pre">b</span></code></li>
<li><code class="docutils literal"><span class="pre">a</span> <span class="pre">+=</span> <span class="pre">b</span></code></li>
<li><code class="docutils literal"><span class="pre">a.add(b)</span></code></li>
<li><code class="docutils literal"><span class="pre">a.update(b)</span></code></li>
</ul>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;0:5,6:10&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">|=</span> <span class="mi">5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">a</span>
<span class="go">IntRangeSet(&#39;0:10&#39;)</span>
</pre></div>
</div>
<p>The &#8216;add&#8217; and &#8216;update&#8217; methods also support unioning multiple ranges inputs,</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;0:5,6:10&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;5&#39;</span><span class="p">,</span><span class="s1">&#39;100:200&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">a</span>
<span class="go">IntRangeSet(&#39;0:10,100:200&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pysnptools.util.IntRangeSet.clear">
<code class="descname">clear</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.IntRangeSet.clear" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove all ranges from this IntRangeSet.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;0:10,12&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">a</span>
<span class="go">IntRangeSet(&#39;&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pysnptools.util.IntRangeSet.copy">
<code class="descname">copy</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.IntRangeSet.copy" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a deep copy of a IntRangeSet.</p>
</dd></dl>

<dl class="method">
<dt id="pysnptools.util.IntRangeSet.count">
<code class="descname">count</code><span class="sig-paren">(</span><em>ranges</em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.IntRangeSet.count" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of times that the elements of ranges appears in the IntRangeSet. Because IntRangeSet is 
a set, the number will be either 0 or 1.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;100:110,1000&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s1">&#39;105:107,1000&#39;</span><span class="p">)</span>
<span class="go">1</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pysnptools.util.IntRangeSet.difference">
<code class="descname">difference</code><span class="sig-paren">(</span><em>*ranges_inputs</em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.IntRangeSet.difference" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the set difference of a IntRangeSet with zero or more ranges inputs. The original IntRangeSet is not changed.</p>
<p>These are the same:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">a</span> <span class="pre">-</span> <span class="pre">b</span></code></li>
<li><code class="docutils literal"><span class="pre">a.difference(b)</span></code></li>
</ul>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;0:5,6:11&#39;</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
<span class="go">IntRangeSet(&#39;0,2:5,6:11&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;0:5,6:11&#39;</span><span class="p">)</span> <span class="o">-</span> <span class="s1">&#39;3:100&#39;</span>
<span class="go">IntRangeSet(&#39;0:3&#39;)</span>
</pre></div>
</div>
<p>The &#8216;difference&#8217; method also supports subtracting multiple input ranges</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;0:5,6:11&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="s1">&#39;3:100&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="go">IntRangeSet(&#39;0,2&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pysnptools.util.IntRangeSet.difference_update">
<code class="descname">difference_update</code><span class="sig-paren">(</span><em>*ranges_inputs</em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.IntRangeSet.difference_update" title="Permalink to this definition">¶</a></dt>
<dd><p>See <a class="reference internal" href="#pysnptools.util.IntRangeSet.__isub__" title="pysnptools.util.IntRangeSet.__isub__"><code class="xref py py-meth docutils literal"><span class="pre">IntRangeSet.__isub__()</span></code></a></p>
</dd></dl>

<dl class="method">
<dt id="pysnptools.util.IntRangeSet.discard">
<code class="descname">discard</code><span class="sig-paren">(</span><em>*ranges_inputs</em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.IntRangeSet.discard" title="Permalink to this definition">¶</a></dt>
<dd><p>See <a class="reference internal" href="#pysnptools.util.IntRangeSet.__isub__" title="pysnptools.util.IntRangeSet.__isub__"><code class="xref py py-meth docutils literal"><span class="pre">IntRangeSet.__isub__()</span></code></a></p>
</dd></dl>

<dl class="method">
<dt id="pysnptools.util.IntRangeSet.index">
<code class="descname">index</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.IntRangeSet.index" title="Permalink to this definition">¶</a></dt>
<dd><p>If x is an integer, returns the index of x in a, where a is an IntRangeSet.
If x is an ranges input, returns an IntRangeSet of index of every integer in x.
Raises an IndexError is x not in a.</p>
<p><code class="docutils literal"><span class="pre">*</span> <span class="pre">a.index(x)</span></code></p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;100:110,1000&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="mi">109</span><span class="p">)</span>
<span class="go">9</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;100:110,1000&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;109,100:104&#39;</span><span class="p">)</span>
<span class="go">IntRangeSet(&#39;0:4,9&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pysnptools.util.IntRangeSet.intersection">
<code class="descname">intersection</code><span class="sig-paren">(</span><em>*ranges_inputs</em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.IntRangeSet.intersection" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the intersection of a IntRangeSet and zero or more ranges inputs. The original IntRangeSet is not changed.</p>
<p>These are the same:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">a</span> <span class="pre">&amp;</span> <span class="pre">b</span></code></li>
<li><code class="docutils literal"><span class="pre">a.intersection(b)</span></code></li>
</ul>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;0:5,6:11&#39;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="s1">&#39;3:8&#39;</span>
<span class="go">IntRangeSet(&#39;3:5,6:8&#39;)</span>
</pre></div>
</div>
<p>The &#8216;intersection&#8217; method also support intersecting multiple ranges inputs,</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;0:5,6:11&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="s1">&#39;3:8&#39;</span><span class="p">,</span><span class="s1">&#39;4:7&#39;</span><span class="p">)</span>
<span class="go">IntRangeSet(&#39;4,6&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pysnptools.util.IntRangeSet.intersection_update">
<code class="descname">intersection_update</code><span class="sig-paren">(</span><em>*ranges_inputs</em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.IntRangeSet.intersection_update" title="Permalink to this definition">¶</a></dt>
<dd><p>See <a class="reference internal" href="#pysnptools.util.IntRangeSet.__iand__" title="pysnptools.util.IntRangeSet.__iand__"><code class="xref py py-meth docutils literal"><span class="pre">IntRangeSet.__iand__()</span></code></a></p>
</dd></dl>

<dl class="method">
<dt id="pysnptools.util.IntRangeSet.isdisjoint">
<code class="descname">isdisjoint</code><span class="sig-paren">(</span><em>ranges</em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.IntRangeSet.isdisjoint" title="Permalink to this definition">¶</a></dt>
<dd><p>True exactly when the two sets have no integer elements in common.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;100:110,1000&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">isdisjoint</span><span class="p">(</span><span class="s1">&#39;900:2000&#39;</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;100:110,1000&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">isdisjoint</span><span class="p">(</span><span class="s1">&#39;1900:2000&#39;</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="pysnptools.util.IntRangeSet.isempty">
<code class="descname">isempty</code><a class="headerlink" href="#pysnptools.util.IntRangeSet.isempty" title="Permalink to this definition">¶</a></dt>
<dd><p>True exactly when the IntRangeSet is empty.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">IntRangeSet</span><span class="p">()</span><span class="o">.</span><span class="n">isempty</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">isempty</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pysnptools.util.IntRangeSet.issubset">
<code class="descname">issubset</code><span class="sig-paren">(</span><em>ranges</em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.IntRangeSet.issubset" title="Permalink to this definition">¶</a></dt>
<dd><p>True exactly when the IntRangeSet is a subset of the ranges.</p>
<p>These are the same:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">a</span> <span class="pre">&lt;=</span> <span class="pre">b</span></code></li>
<li><code class="docutils literal"><span class="pre">a.issubset(b)</span></code></li>
</ul>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;0:5,6:11&#39;</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="s1">&#39;-1:101&#39;</span> <span class="c1"># The right-hand can be any ranges input</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Note: By definition, any set is a subset of itself.</p>
</dd></dl>

<dl class="method">
<dt id="pysnptools.util.IntRangeSet.issuperset">
<code class="descname">issuperset</code><span class="sig-paren">(</span><em>*ranges_inputs</em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.IntRangeSet.issuperset" title="Permalink to this definition">¶</a></dt>
<dd><p>True exactly when all the ranges input is a subset of the IntRangeSet.</p>
<p>These are the same:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">b</span> <span class="pre">in</span> <span class="pre">a</span></code></li>
<li><code class="docutils literal"><span class="pre">a.issuperset(b)</span></code></li>
<li><code class="docutils literal"><span class="pre">a</span> <span class="pre">&gt;=</span> <span class="pre">b</span></code></li>
</ul>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="mi">3</span> <span class="ow">in</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;0:5,6:11&#39;</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;4:7&#39;</span><span class="p">)</span> <span class="ow">in</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;0:5,6:11&#39;</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="s1">&#39;6:9&#39;</span> <span class="ow">in</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;0:5,6:11&#39;</span><span class="p">)</span> <span class="c1"># The left-hand of &#39;in&#39; can be any ranges input</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;0:5,6:11&#39;</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="s1">&#39;6:9&#39;</span> <span class="c1"># The right-hand of can be any ranges input</span>
<span class="go">True</span>
</pre></div>
</div>
<p>The &#8216;issuperset&#8217; method also supports unioning multiple ranges inputs.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;0:5,6:11&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">issuperset</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;0:5,6:11&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">issuperset</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
<p>Note: By definition, any set is a superset of itself.</p>
</dd></dl>

<dl class="method">
<dt id="pysnptools.util.IntRangeSet.max">
<code class="descname">max</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.IntRangeSet.max" title="Permalink to this definition">¶</a></dt>
<dd><p>The largest integer element in the IntRangeSet</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;0:10,12&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
<span class="go">12</span>
</pre></div>
</div>
<p>Note: This is more efficient than max(IntRangeSet(&#8216;0:10,12&#8217;)) because is computed
in constant time rather than in time linear to the number of integer elements.</p>
</dd></dl>

<dl class="method">
<dt id="pysnptools.util.IntRangeSet.min">
<code class="descname">min</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.IntRangeSet.min" title="Permalink to this definition">¶</a></dt>
<dd><p>The smallest integer element in the IntRangeSet</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;0:10,12&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
<span class="go">0</span>
</pre></div>
</div>
<p>Note: This is more efficient than <code class="docutils literal"><span class="pre">min(IntRangeSet('0:10,12'))</span></code> because is computed
in constant time rather than in time linear to the number of integer elements.</p>
</dd></dl>

<dl class="method">
<dt id="pysnptools.util.IntRangeSet.pop">
<code class="descname">pop</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.IntRangeSet.pop" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove and return the largest integer element from the IntRangeSet. Raises KeyError if the IntRangeSet is empty.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;0:5,6:11&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">a</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
<span class="go">10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">a</span>
<span class="go">IntRangeSet(&#39;0:5,6:10&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pysnptools.util.IntRangeSet.ranges">
<code class="descname">ranges</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.IntRangeSet.ranges" title="Permalink to this definition">¶</a></dt>
<dd><p>Iterate, in order, the ranges of a IntRangeSet as (start,stop) tuples.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">start</span><span class="p">,</span><span class="n">stop</span> <span class="ow">in</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;0:10,100:200&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">ranges</span><span class="p">():</span>
<span class="gp">... </span>      <span class="nb">print</span> <span class="s2">&quot;start is </span><span class="si">{0}</span><span class="s2">, stop is </span><span class="si">{1}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">start</span><span class="p">,</span><span class="n">stop</span><span class="p">)</span>
<span class="go">start is 0, stop is 10</span>
<span class="go">start is 100, stop is 200</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pysnptools.util.IntRangeSet.ranges_getitem">
<code class="descname">ranges_getitem</code><span class="sig-paren">(</span><em>index</em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.IntRangeSet.ranges_getitem" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the index-th range in the collection of ranges</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;-30:-20,0:10,12&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">ranges_getitem</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">(0, 10)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pysnptools.util.IntRangeSet.ranges_index">
<code class="descname">ranges_index</code><span class="sig-paren">(</span><em>element</em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.IntRangeSet.ranges_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the ranges index of range containing the element</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">int_range_set</span> <span class="o">=</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;-30:-20,0:10,12&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">index</span> <span class="o">=</span> <span class="n">int_range_set</span><span class="o">.</span><span class="n">ranges_index</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">index</span>
<span class="go">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">int_range_set</span><span class="o">.</span><span class="n">ranges_getitem</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
<span class="go">(0, 10)</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="pysnptools.util.IntRangeSet.ranges_len">
<code class="descname">ranges_len</code><a class="headerlink" href="#pysnptools.util.IntRangeSet.ranges_len" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of contiguous ranges in the IntRangeSet</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;0:10,12&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">ranges_len</span>
<span class="go">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pysnptools.util.IntRangeSet.remove">
<code class="descname">remove</code><span class="sig-paren">(</span><em>*ranges_inputs</em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.IntRangeSet.remove" title="Permalink to this definition">¶</a></dt>
<dd><p>See <code class="xref py py-meth docutils literal"><span class="pre">IntRangeSet__isub__()</span></code></p>
</dd></dl>

<dl class="method">
<dt id="pysnptools.util.IntRangeSet.sum">
<code class="descname">sum</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.IntRangeSet.sum" title="Permalink to this definition">¶</a></dt>
<dd><p>The sum of the integer elements in the IntRangeSet</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;0:10,12&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="go">57</span>
</pre></div>
</div>
<p>Note: This is more efficient than <code class="docutils literal"><span class="pre">sum(IntRangeSet('0:10,12'))</span></code> because is computed
in time linear in the number of ranges, rather than integer elements.</p>
</dd></dl>

<dl class="method">
<dt id="pysnptools.util.IntRangeSet.symmetric_difference">
<code class="descname">symmetric_difference</code><span class="sig-paren">(</span><em>ranges</em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.IntRangeSet.symmetric_difference" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a new IntRangeSet set with elements in either the input IntRangeSet or the input range but not both.</p>
<p>These are the same:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">a</span> <span class="pre">^</span> <span class="pre">b</span></code></li>
<li><code class="docutils literal"><span class="pre">a.symmetric_difference(b)</span></code></li>
</ul>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;0:5,6:11&#39;</span><span class="p">)</span> <span class="o">^</span> <span class="s1">&#39;3:9&#39;</span>
<span class="go">IntRangeSet(&#39;0:3,5,9:11&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pysnptools.util.IntRangeSet.symmetric_difference_update">
<code class="descname">symmetric_difference_update</code><span class="sig-paren">(</span><em>ranges</em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.IntRangeSet.symmetric_difference_update" title="Permalink to this definition">¶</a></dt>
<dd><p>See <a class="reference internal" href="#pysnptools.util.IntRangeSet.__ixor__" title="pysnptools.util.IntRangeSet.__ixor__"><code class="xref py py-meth docutils literal"><span class="pre">IntRangeSet.__ixor__()</span></code></a></p>
</dd></dl>

<dl class="method">
<dt id="pysnptools.util.IntRangeSet.union">
<code class="descname">union</code><span class="sig-paren">(</span><em>*ranges_inputs</em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.IntRangeSet.union" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the union of a IntRangeSet with zero or more ranges inputs. The original IntRangeSet is not changed.</p>
<p>These are the same:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">a</span> <span class="pre">|</span> <span class="pre">b</span></code></li>
<li><code class="docutils literal"><span class="pre">a</span> <span class="pre">+</span> <span class="pre">b</span></code></li>
<li><code class="docutils literal"><span class="pre">a.union(b)</span></code></li>
</ul>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;0:5,6:10&#39;</span><span class="p">)</span> <span class="o">|</span> <span class="mi">5</span>
<span class="go">IntRangeSet(&#39;0:10&#39;)</span>
</pre></div>
</div>
<p>The &#8216;union&#8217; method also support unioning multiple ranges inputs,</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;0:5,6:10&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="s1">&#39;100:200&#39;</span><span class="p">)</span>
<span class="go">IntRangeSet(&#39;0:10,100:200&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pysnptools.util.IntRangeSet.update">
<code class="descname">update</code><span class="sig-paren">(</span><em>*ranges_inputs</em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.IntRangeSet.update" title="Permalink to this definition">¶</a></dt>
<dd><p>Union zero or more ranges inputs into the current IntRangeSet.</p>
<p>These are the same:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">a</span> <span class="pre">|=</span> <span class="pre">b</span></code></li>
<li><code class="docutils literal"><span class="pre">a</span> <span class="pre">+=</span> <span class="pre">b</span></code></li>
<li><code class="docutils literal"><span class="pre">a.add(b)</span></code></li>
<li><code class="docutils literal"><span class="pre">a.update(b)</span></code></li>
</ul>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;0:5,6:10&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">|=</span> <span class="mi">5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">a</span>
<span class="go">IntRangeSet(&#39;0:10&#39;)</span>
</pre></div>
</div>
<p>The &#8216;add&#8217; and &#8216;update&#8217; methods also support unioning multiple ranges inputs,</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;0:5,6:10&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;5&#39;</span><span class="p">,</span><span class="s1">&#39;100:200&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">a</span>
<span class="go">IntRangeSet(&#39;0:10,100:200&#39;)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-pysnptools.util.pheno">
<span id="util-pheno"></span><h3><code class="xref py py-mod docutils literal"><span class="pre">util.pheno</span></code><a class="headerlink" href="#module-pysnptools.util.pheno" title="Permalink to this headline">¶</a></h3>
<div class="deprecated">
<p><span class="versionmodified">Deprecated since version Use: </span><a class="reference internal" href="#pysnptools.snpreader.Pheno" title="pysnptools.snpreader.Pheno"><code class="xref py py-class docutils literal"><span class="pre">Pheno</span></code></a> instead.    </p>
</div>
<dl class="function">
<dt id="pysnptools.util.pheno.loadOnePhen">
<code class="descclassname">pysnptools.util.pheno.</code><code class="descname">loadOnePhen</code><span class="sig-paren">(</span><em>filename</em>, <em>i_pheno=0</em>, <em>missing='-9'</em>, <em>vectorize=False</em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.pheno.loadOnePhen" title="Permalink to this definition">¶</a></dt>
<dd><div class="deprecated">
<p><span class="versionmodified">Deprecated since version Use: </span><a class="reference internal" href="#pysnptools.snpreader.Pheno" title="pysnptools.snpreader.Pheno"><code class="xref py py-class docutils literal"><span class="pre">Pheno</span></code></a> instead.    </p>
</div>
<p>Load one column of a phenotype file. Remove any rows with missing data</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>filename</strong> (<em>string</em>) &#8211; name of the file</li>
<li><strong>i_pheno</strong> (<em>int</em>) &#8211; column to return (default &#8216;0&#8217;, the first column)</li>
<li><strong>missing</strong> (<em>string</em>) &#8211; value to threat as missing</li>
<li><strong>vectorize</strong> (<em>bool</em>) &#8211; if true, return a 1-D vector rather than a 2-D array</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">An output dictionary</p>
</td>
</tr>
</tbody>
</table>
<p>The output dictionary looks like:</p>
<ul class="simple">
<li>&#8216;header&#8217; : [1] array phenotype namesv (only if header line is specified in file),</li>
<li>&#8216;vals&#8217;   : [N*1] array of phenotype-data,</li>
<li>&#8216;iid&#8217;    : [N*2] array of family IDs and case IDs</li>
</ul>
</dd></dl>

<dl class="function">
<dt id="pysnptools.util.pheno.loadPhen">
<code class="descclassname">pysnptools.util.pheno.</code><code class="descname">loadPhen</code><span class="sig-paren">(</span><em>filename</em>, <em>missing='-9'</em>, <em>famid='FID'</em>, <em>sampid='ID'</em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.pheno.loadPhen" title="Permalink to this definition">¶</a></dt>
<dd><div class="deprecated">
<p><span class="versionmodified">Deprecated since version Use: </span><a class="reference internal" href="#pysnptools.snpreader.Pheno" title="pysnptools.snpreader.Pheno"><code class="xref py py-class docutils literal"><span class="pre">Pheno</span></code></a> instead.    </p>
</div>
<p>Load a phenotype or covariate file. Covariates have the same file format.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>filename</strong> (<em>string</em>) &#8211; name of the file</li>
<li><strong>missing</strong> (<em>string</em>) &#8211; value to threat as missing</li>
<li><strong>vectorize</strong> (<em>bool</em>) &#8211; if true, return a 1-D vector rather than a 2-D array</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">An output dictionary</p>
</td>
</tr>
</tbody>
</table>
<p>The output dictionary looks like:</p>
<ul class="simple">
<li>&#8216;header&#8217; : [1] array phenotype names (only if header line is specified in file),</li>
<li>&#8216;vals&#8217;   : [N*1] array of phenotype-data,</li>
<li>&#8216;iid&#8217;    : [N*2] array of family IDs and case IDs</li>
</ul>
</dd></dl>

</div>
</div>
<div class="section" id="module-pysnptools.standardizer">
<span id="standardizer-module"></span><h2><code class="xref py py-mod docutils literal"><span class="pre">standardizer</span></code> Module<a class="headerlink" href="#module-pysnptools.standardizer" title="Permalink to this headline">¶</a></h2>
<div class="section" id="standardizer-standardizer">
<h3><code class="xref py py-class docutils literal"><span class="pre">standardizer.Standardizer</span></code><a class="headerlink" href="#standardizer-standardizer" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="pysnptools.standardizer.Standardizer">
<em class="property">class </em><code class="descclassname">pysnptools.standardizer.</code><code class="descname">Standardizer</code><a class="headerlink" href="#pysnptools.standardizer.Standardizer" title="Permalink to this definition">¶</a></dt>
<dd><p>A Standardizer is a class such as <a class="reference internal" href="#pysnptools.standardizer.Unit" title="pysnptools.standardizer.Unit"><code class="xref py py-class docutils literal"><span class="pre">Unit</span></code></a> and <a class="reference internal" href="#pysnptools.standardizer.Beta" title="pysnptools.standardizer.Beta"><code class="xref py py-class docutils literal"><span class="pre">Beta</span></code></a> to be used by the <a class="reference internal" href="#pysnptools.snpreader.SnpData.standardize" title="pysnptools.snpreader.SnpData.standardize"><code class="xref py py-meth docutils literal"><span class="pre">SnpData.standardize()</span></code></a> and <a class="reference internal" href="#pysnptools.snpreader.SnpReader.read_kernel" title="pysnptools.snpreader.SnpReader.read_kernel"><code class="xref py py-meth docutils literal"><span class="pre">SnpReader.read_kernel()</span></code></a> method to standardize SNP data.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<p>Read and standardize SNP data.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.standardizer</span> <span class="k">import</span> <span class="n">Unit</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.snpreader</span> <span class="k">import</span> <span class="n">Bed</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snpdata1</span> <span class="o">=</span> <span class="n">Bed</span><span class="p">(</span><span class="s1">&#39;../../tests/datasets/all_chr.maf0.001.N300&#39;</span><span class="p">,</span><span class="n">count_A1</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">standardize</span><span class="p">(</span><span class="n">Unit</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">snpdata1</span><span class="o">.</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
<span class="go">0.229415733871</span>
</pre></div>
</div>
<p>Create a kernel from SNP data on disk.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">kerneldata</span> <span class="o">=</span> <span class="n">Bed</span><span class="p">(</span><span class="s1">&#39;../examples/toydata.bed&#39;</span><span class="p">,</span><span class="n">count_A1</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">read_kernel</span><span class="p">(</span><span class="n">Unit</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">kerneldata</span><span class="o">.</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
<span class="go">9923.06992842</span>
</pre></div>
</div>
<p>Can also return a constant SNP standardizer that can be applied to other <a class="reference internal" href="#pysnptools.snpreader.SnpData" title="pysnptools.snpreader.SnpData"><code class="xref py py-class docutils literal"><span class="pre">SnpData</span></code></a>.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">snp_whole</span> <span class="o">=</span> <span class="n">Bed</span><span class="p">(</span><span class="s1">&#39;../../tests/datasets/all_chr.maf0.001.N300&#39;</span><span class="p">,</span><span class="n">count_A1</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">train_idx</span><span class="p">,</span> <span class="n">test_idx</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="n">snp_whole</span><span class="o">.</span><span class="n">iid_count</span><span class="p">),</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span> <span class="c1">#test on the first 10, train on the rest</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snp_train</span><span class="p">,</span> <span class="n">trained_standardizer</span> <span class="o">=</span> <span class="n">Unit</span><span class="p">()</span><span class="o">.</span><span class="n">standardize</span><span class="p">(</span><span class="n">snp_whole</span><span class="p">[</span><span class="n">train_idx</span><span class="p">,:]</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span><span class="n">return_trained</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">snp_train</span><span class="o">.</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
<span class="go">0.233549683248</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">trained_standardizer</span><span class="o">.</span><span class="n">stats</span><span class="p">[</span><span class="mi">0</span><span class="p">,:]</span> <span class="c1">#The mean and stddev of the 1st SNP on the training data</span>
<span class="go">[ 1.94827586  0.22146953]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snp_test</span> <span class="o">=</span> <span class="n">snp_whole</span><span class="p">[</span><span class="n">test_idx</span><span class="p">,:]</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">standardize</span><span class="p">(</span><span class="n">trained_standardizer</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snp_test</span><span class="o">.</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
<span class="go">0.23354968324845735</span>
</pre></div>
</div>
<p>Standardize any Numpy array.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">val</span> <span class="o">=</span> <span class="n">Bed</span><span class="p">(</span><span class="s1">&#39;../../tests/datasets/all_chr.maf0.001.N300&#39;</span><span class="p">,</span><span class="n">count_A1</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">val</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
<span class="go">2.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">val</span> <span class="o">=</span> <span class="n">Unit</span><span class="p">()</span><span class="o">.</span><span class="n">standardize</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
<span class="go">0.229415733871</span>
</pre></div>
</div>
<p>Details of Methods &amp; Properties:</p>
<dl class="attribute">
<dt id="pysnptools.standardizer.Standardizer.is_constant">
<code class="descname">is_constant</code><a class="headerlink" href="#pysnptools.standardizer.Standardizer.is_constant" title="Permalink to this definition">¶</a></dt>
<dd><p>Tell if a standardizer&#8217;s statistics are constant. For example, <code class="xref py py-class docutils literal"><span class="pre">Unit_Trained</span></code> contains a pre-specified mean and stddev for each SNP, so <code class="xref py py-attr docutils literal"><span class="pre">Unit_Trained.is_constant</span></code> is True.
<a class="reference internal" href="#pysnptools.standardizer.Unit" title="pysnptools.standardizer.Unit"><code class="xref py py-class docutils literal"><span class="pre">Unit</span></code></a>, on the other hand, measures the mean and stddev for each SNP, so <code class="xref py py-attr docutils literal"><span class="pre">Unit.is_constant</span></code> is False.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">bool</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pysnptools.standardizer.Standardizer.standardize">
<code class="descname">standardize</code><span class="sig-paren">(</span><em>snps</em>, <em>block_size=None</em>, <em>return_trained=False</em>, <em>force_python_only=False</em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.standardizer.Standardizer.standardize" title="Permalink to this definition">¶</a></dt>
<dd><p>Applies standardization, in place, to <a class="reference internal" href="#pysnptools.snpreader.SnpData" title="pysnptools.snpreader.SnpData"><code class="xref py py-class docutils literal"><span class="pre">SnpData</span></code></a> (or a NumPy array). For convenience also returns the <a class="reference internal" href="#pysnptools.snpreader.SnpData" title="pysnptools.snpreader.SnpData"><code class="xref py py-class docutils literal"><span class="pre">SnpData</span></code></a> (or a NumPy array).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>snps</strong> (<a class="reference internal" href="#pysnptools.snpreader.SnpData" title="pysnptools.snpreader.SnpData"><code class="xref py py-class docutils literal"><span class="pre">SnpData</span></code></a> (or a NumPy array)) &#8211; SNP values to standardize</li>
<li><strong>block_size</strong> (<em>None</em>) &#8211; <em>Not used</em></li>
<li><strong>return_trained</strong> (<em>boolean</em>) &#8211; If true, returns a second value containing a constant standardizer trained on this data.</li>
<li><strong>force_python_only</strong> (<em>bool</em>) &#8211; optional &#8211; If False (default), may use outside library code. If True, requests that the read
be done without outside library code.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#pysnptools.snpreader.SnpData" title="pysnptools.snpreader.SnpData"><code class="xref py py-class docutils literal"><span class="pre">SnpData</span></code></a> (or a NumPy array), (optional) constant <a class="reference internal" href="#pysnptools.standardizer.Standardizer" title="pysnptools.standardizer.Standardizer"><code class="xref py py-class docutils literal"><span class="pre">Standardizer</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="standardizer-unit">
<h3><code class="xref py py-class docutils literal"><span class="pre">standardizer.Unit</span></code><a class="headerlink" href="#standardizer-unit" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="pysnptools.standardizer.Unit">
<em class="property">class </em><code class="descclassname">pysnptools.standardizer.</code><code class="descname">Unit</code><a class="headerlink" href="#pysnptools.standardizer.Unit" title="Permalink to this definition">¶</a></dt>
<dd><p>A <a class="reference internal" href="#pysnptools.standardizer.Standardizer" title="pysnptools.standardizer.Standardizer"><code class="xref py py-class docutils literal"><span class="pre">Standardizer</span></code></a> to unit standardize SNP data. For each sid, the mean of the values is zero with standard deviation 1.
NaN values are then filled with zero, the mean (consequently, if there are NaN values, the final standard deviation will not be zero.</p>
<p>See <a class="reference internal" href="#pysnptools.standardizer.Standardizer" title="pysnptools.standardizer.Standardizer"><code class="xref py py-class docutils literal"><span class="pre">Standardizer</span></code></a> for more information about standardization.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.standardizer</span> <span class="k">import</span> <span class="n">Unit</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.snpreader</span> <span class="k">import</span> <span class="n">Bed</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snpdata1</span> <span class="o">=</span> <span class="n">Bed</span><span class="p">(</span><span class="s1">&#39;../../tests/datasets/all_chr.maf0.001.N300&#39;</span><span class="p">,</span><span class="n">count_A1</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">standardize</span><span class="p">(</span><span class="n">Unit</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">snpdata1</span><span class="o">.</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
<span class="go">0.229415733871</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="standardizer-beta">
<h3><code class="xref py py-class docutils literal"><span class="pre">standardizer.Beta</span></code><a class="headerlink" href="#standardizer-beta" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="pysnptools.standardizer.Beta">
<em class="property">class </em><code class="descclassname">pysnptools.standardizer.</code><code class="descname">Beta</code><span class="sig-paren">(</span><em>a</em>, <em>b</em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.standardizer.Beta" title="Permalink to this definition">¶</a></dt>
<dd><p>A <a class="reference internal" href="#pysnptools.standardizer.Standardizer" title="pysnptools.standardizer.Standardizer"><code class="xref py py-class docutils literal"><span class="pre">Standardizer</span></code></a> to beta standardize SNP data.</p>
<p>See <a class="reference internal" href="#pysnptools.standardizer.Standardizer" title="pysnptools.standardizer.Standardizer"><code class="xref py py-class docutils literal"><span class="pre">Standardizer</span></code></a> for more information about standardization.</p>
<dl class="docutils">
<dt><strong>Constructor:</strong></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>a</strong> (<em>float</em>) &#8211; The <em>a</em> parameter of the beta distribution</li>
<li><strong>b</strong> (<em>float</em>) &#8211; The <em>b</em> parameter of the beta distribution</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd>
</dl>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.standardizer</span> <span class="k">import</span> <span class="n">Beta</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.snpreader</span> <span class="k">import</span> <span class="n">Bed</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snpdata1</span> <span class="o">=</span> <span class="n">Bed</span><span class="p">(</span><span class="s1">&#39;../../tests/datasets/all_chr.maf0.001.N300&#39;</span><span class="p">,</span><span class="n">count_A1</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">standardize</span><span class="p">(</span><span class="n">Beta</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">25</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">snpdata1</span><span class="o">.</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
<span class="go">0.68080194805</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="standardizer-identity">
<h3><code class="xref py py-class docutils literal"><span class="pre">standardizer.Identity</span></code><a class="headerlink" href="#standardizer-identity" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="pysnptools.standardizer.Identity">
<em class="property">class </em><code class="descclassname">pysnptools.standardizer.</code><code class="descname">Identity</code><a class="headerlink" href="#pysnptools.standardizer.Identity" title="Permalink to this definition">¶</a></dt>
<dd><p>A <a class="reference internal" href="#pysnptools.standardizer.Standardizer" title="pysnptools.standardizer.Standardizer"><code class="xref py py-class docutils literal"><span class="pre">Standardizer</span></code></a> that does nothing to SNP data.</p>
<p>See <a class="reference internal" href="#pysnptools.standardizer.Standardizer" title="pysnptools.standardizer.Standardizer"><code class="xref py py-class docutils literal"><span class="pre">Standardizer</span></code></a> for more information about standardization.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.standardizer</span> <span class="k">import</span> <span class="n">Identity</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.snpreader</span> <span class="k">import</span> <span class="n">Bed</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snpdata1</span> <span class="o">=</span> <span class="n">Bed</span><span class="p">(</span><span class="s1">&#39;../../tests/datasets/all_chr.maf0.001.N300&#39;</span><span class="p">,</span><span class="n">count_A1</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">snpdata1</span><span class="o">.</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
<span class="go">2.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snpdata1</span> <span class="o">=</span> <span class="n">snpdata1</span><span class="o">.</span><span class="n">standardize</span><span class="p">(</span><span class="n">Identity</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">snpdata1</span><span class="o">.</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
<span class="go">2.0</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="standardizer-diagkton">
<h3><code class="xref py py-class docutils literal"><span class="pre">standardizer.DiagKtoN</span></code><a class="headerlink" href="#standardizer-diagkton" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="pysnptools.standardizer.DiagKtoN">
<em class="property">class </em><code class="descclassname">pysnptools.standardizer.</code><code class="descname">DiagKtoN</code><span class="sig-paren">(</span><em>deprecated_iid_count=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.standardizer.DiagKtoN" title="Permalink to this definition">¶</a></dt>
<dd><p>Both a <a class="reference internal" href="#pysnptools.standardizer.Standardizer" title="pysnptools.standardizer.Standardizer"><code class="xref py py-class docutils literal"><span class="pre">Standardizer</span></code></a> and a A <a class="reference internal" href="#pysnptools.kernelstandardizer.KernelStandardizer" title="pysnptools.kernelstandardizer.KernelStandardizer"><code class="xref py py-class docutils literal"><span class="pre">KernelStandardizer</span></code></a>.</p>
<p>When applied to a <a class="reference internal" href="#pysnptools.snpreader.SnpData" title="pysnptools.snpreader.SnpData"><code class="xref py py-class docutils literal"><span class="pre">SnpData</span></code></a>, it multiplies the SNP values by the square root of a factor such that a kernel
constructed from the SNP values will have a diagonal that sums to iid_count. This class thus
standardizes the kernel before it is even constructed.</p>
<p>When applied to a <a class="reference internal" href="#pysnptools.kernelreader.KernelData" title="pysnptools.kernelreader.KernelData"><code class="xref py py-class docutils literal"><span class="pre">KernelData</span></code></a>, it multiplies the kernel values by the a factor such that a kernel
will have a diagonal that sums to iid_count.</p>
<p>See <a class="reference internal" href="#pysnptools.standardizer.Standardizer" title="pysnptools.standardizer.Standardizer"><code class="xref py py-class docutils literal"><span class="pre">Standardizer</span></code></a> for more information about standardization.</p>
<dl class="docutils">
<dt><strong>Constructor:</strong></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>deprecated_iid_count</strong> (<em>int</em>) (optional) &#8211; Deprecated.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd>
</dl>
<p>Example of DiagKtoN to <a class="reference internal" href="#pysnptools.snpreader.SnpData" title="pysnptools.snpreader.SnpData"><code class="xref py py-class docutils literal"><span class="pre">SnpData</span></code></a>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.standardizer</span> <span class="k">import</span> <span class="n">DiagKtoN</span><span class="p">,</span> <span class="n">Unit</span><span class="p">,</span> <span class="n">Identity</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.snpreader</span> <span class="k">import</span> <span class="n">Bed</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snpdata1</span> <span class="o">=</span> <span class="n">Bed</span><span class="p">(</span><span class="s1">&#39;../../tests/datasets/all_chr.maf0.001.N300&#39;</span><span class="p">,</span><span class="n">count_A1</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">standardize</span><span class="p">(</span><span class="n">Unit</span><span class="p">())</span><span class="o">.</span><span class="n">standardize</span><span class="p">(</span><span class="n">DiagKtoN</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kernel1</span> <span class="o">=</span> <span class="n">snpdata1</span><span class="o">.</span><span class="n">read_kernel</span><span class="p">(</span><span class="n">Identity</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">kernel1</span><span class="o">.</span><span class="n">val</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="go">300.0</span>
</pre></div>
</div>
<p>Example of DiagKtoN to <a class="reference internal" href="#pysnptools.kernelreader.KernelData" title="pysnptools.kernelreader.KernelData"><code class="xref py py-class docutils literal"><span class="pre">KernelData</span></code></a>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.standardizer</span> <span class="k">import</span> <span class="n">DiagKtoN</span><span class="p">,</span> <span class="n">Unit</span><span class="p">,</span> <span class="n">Identity</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.snpreader</span> <span class="k">import</span> <span class="n">Bed</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snpdata1</span> <span class="o">=</span> <span class="n">Bed</span><span class="p">(</span><span class="s1">&#39;../../tests/datasets/all_chr.maf0.001.N300&#39;</span><span class="p">,</span><span class="n">count_A1</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">standardize</span><span class="p">(</span><span class="n">Unit</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kernel1</span> <span class="o">=</span> <span class="n">snpdata1</span><span class="o">.</span><span class="n">read_kernel</span><span class="p">(</span><span class="n">DiagKtoN</span><span class="p">(),</span><span class="n">block_size</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">kernel1</span><span class="o">.</span><span class="n">val</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="go">300.0</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="standardizer-unittrained">
<h3><code class="xref py py-class docutils literal"><span class="pre">standardizer.UnitTrained</span></code><a class="headerlink" href="#standardizer-unittrained" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="pysnptools.standardizer.UnitTrained">
<em class="property">class </em><code class="descclassname">pysnptools.standardizer.</code><code class="descname">UnitTrained</code><span class="sig-paren">(</span><em>sid</em>, <em>stats</em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.standardizer.UnitTrained" title="Permalink to this definition">¶</a></dt>
<dd><p>A <a class="reference internal" href="#pysnptools.standardizer.Standardizer" title="pysnptools.standardizer.Standardizer"><code class="xref py py-class docutils literal"><span class="pre">Standardizer</span></code></a> to unit standardize one set of SNP data based on the mean and stddev of another set of SNP data.
NaN values are then filled with zero.</p>
<p>See <a class="reference internal" href="#pysnptools.standardizer.Standardizer" title="pysnptools.standardizer.Standardizer"><code class="xref py py-class docutils literal"><span class="pre">Standardizer</span></code></a> for more information about standardization.</p>
<dl class="docutils">
<dt><strong>Constructor:</strong></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>stats</strong> (<em>ndarray of float</em>) &#8211; The mean and stddev of each sid</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd>
</dl>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.standardizer</span> <span class="k">import</span> <span class="n">Unit</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.snpreader</span> <span class="k">import</span> <span class="n">Bed</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">train</span> <span class="o">=</span> <span class="n">Bed</span><span class="p">(</span><span class="s1">&#39;../../tests/datasets/all_chr.maf0.001.N300&#39;</span><span class="p">,</span><span class="n">count_A1</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="mi">1</span><span class="p">:,:]</span><span class="o">.</span><span class="n">read</span><span class="p">()</span> <span class="c1"># read SNP values for all but the first iid</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_</span><span class="p">,</span> <span class="n">unittrained</span> <span class="o">=</span> <span class="n">train</span><span class="o">.</span><span class="n">standardize</span><span class="p">(</span><span class="n">Unit</span><span class="p">(),</span><span class="n">return_trained</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1">#Unit standardize and remember the mean and stddev of each sid</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">unittrained</span><span class="o">.</span><span class="n">stats</span><span class="p">[:</span><span class="mi">5</span><span class="p">,:]</span> <span class="c1">#Print the means and stddev of the first five sids</span>
<span class="go">[[ 1.94983278  0.21828988]</span>
<span class="go"> [ 1.96989967  0.17086341]</span>
<span class="go"> [ 1.84280936  0.39057474]</span>
<span class="go"> [ 1.99665552  0.0577347 ]</span>
<span class="go"> [ 1.97658863  0.15120608]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">test</span> <span class="o">=</span> <span class="n">Bed</span><span class="p">(</span><span class="s1">&#39;../../tests/datasets/all_chr.maf0.001.N300&#39;</span><span class="p">,</span><span class="n">count_A1</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="mi">0</span><span class="p">,:]</span><span class="o">.</span><span class="n">read</span><span class="p">()</span> <span class="c1"># read SNP values for the first iid</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">test</span> <span class="o">=</span> <span class="n">test</span><span class="o">.</span><span class="n">standardize</span><span class="p">(</span><span class="n">unittrained</span><span class="p">)</span> <span class="c1"># Use the mean and stddev of the train data to unit standardize the test data.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">test</span><span class="o">.</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
<span class="go">0.229819279888</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="standardizer-diagktontrained">
<h3><code class="xref py py-class docutils literal"><span class="pre">standardizer.DiagKtoNTrained</span></code><a class="headerlink" href="#standardizer-diagktontrained" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="pysnptools.standardizer.DiagKtoNTrained">
<em class="property">class </em><code class="descclassname">pysnptools.standardizer.</code><code class="descname">DiagKtoNTrained</code><span class="sig-paren">(</span><em>factor</em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.standardizer.DiagKtoNTrained" title="Permalink to this definition">¶</a></dt>
<dd><p>Both a <a class="reference internal" href="#pysnptools.standardizer.Standardizer" title="pysnptools.standardizer.Standardizer"><code class="xref py py-class docutils literal"><span class="pre">Standardizer</span></code></a> and a A <a class="reference internal" href="#pysnptools.kernelstandardizer.KernelStandardizer" title="pysnptools.kernelstandardizer.KernelStandardizer"><code class="xref py py-class docutils literal"><span class="pre">KernelStandardizer</span></code></a>.</p>
<p>When applied to a <a class="reference internal" href="#pysnptools.snpreader.SnpData" title="pysnptools.snpreader.SnpData"><code class="xref py py-class docutils literal"><span class="pre">SnpData</span></code></a>, DiagKtoN standardizes one set of SNP data based on another set of SNP data.</p>
<p>When applied to a <a class="reference internal" href="#pysnptools.kernelreader.KernelData" title="pysnptools.kernelreader.KernelData"><code class="xref py py-class docutils literal"><span class="pre">KernelData</span></code></a>, DiagKtoN standardizes one kernel data based on another kernel data.</p>
<p>See <a class="reference internal" href="#pysnptools.standardizer.Standardizer" title="pysnptools.standardizer.Standardizer"><code class="xref py py-class docutils literal"><span class="pre">Standardizer</span></code></a> for more information about standardization.</p>
<dl class="docutils">
<dt><strong>Constructor:</strong></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>factor</strong> (<em>float</em>) &#8211; The number what when multiplied into the kernel values will make the diagonal of the kernel values to  sum to iid_count.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd>
</dl>
</dd></dl>

</div>
</div>
<div class="section" id="kernelstandardizer-module">
<h2><code class="xref py py-mod docutils literal"><span class="pre">kernelstandardizer</span></code> Module<a class="headerlink" href="#kernelstandardizer-module" title="Permalink to this headline">¶</a></h2>
<div class="section" id="kernelstandardizer-kernelstandardizer">
<h3><code class="xref py py-class docutils literal"><span class="pre">kernelstandardizer.KernelStandardizer</span></code><a class="headerlink" href="#kernelstandardizer-kernelstandardizer" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="pysnptools.kernelstandardizer.KernelStandardizer">
<em class="property">class </em><code class="descclassname">pysnptools.kernelstandardizer.</code><code class="descname">KernelStandardizer</code><a class="headerlink" href="#pysnptools.kernelstandardizer.KernelStandardizer" title="Permalink to this definition">¶</a></dt>
<dd><p>A KernelStandardizer is a class such as <a class="reference internal" href="#pysnptools.standardizer.DiagKtoN" title="pysnptools.standardizer.DiagKtoN"><code class="xref py py-class docutils literal"><span class="pre">DiagKtoN</span></code></a> and <a class="reference internal" href="#pysnptools.standardizer.Identity" title="pysnptools.standardizer.Identity"><code class="xref py py-class docutils literal"><span class="pre">Identity</span></code></a> to be used by the <a class="reference internal" href="#pysnptools.kernelreader.KernelData.standardize" title="pysnptools.kernelreader.KernelData.standardize"><code class="xref py py-meth docutils literal"><span class="pre">KernelData.standardize()</span></code></a> to standardize Kernel data.
It always works in-place <em>and</em> returns the <a class="reference internal" href="#pysnptools.kernelreader.KernelData" title="pysnptools.kernelreader.KernelData"><code class="xref py py-class docutils literal"><span class="pre">KernelData</span></code></a> on which it works.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<p>Read and standardize Kernel data.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.kernelstandardizer</span> <span class="k">import</span> <span class="n">DiagKtoN</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.kernelreader</span> <span class="k">import</span> <span class="n">KernelNpz</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kerneldata1</span> <span class="o">=</span> <span class="n">KernelNpz</span><span class="p">(</span><span class="s1">&#39;../examples/toydata.kernel.npz&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">kerneldata1</span><span class="o">.</span><span class="n">val</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="go">5000000.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kerneldata1</span> <span class="o">=</span> <span class="n">kerneldata1</span><span class="o">.</span><span class="n">standardize</span><span class="p">(</span><span class="n">DiagKtoN</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">kerneldata1</span><span class="o">.</span><span class="n">val</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="go">500.0</span>
</pre></div>
</div>
<p>Can also return a constant kernel standardizer that be applied to other <a class="reference internal" href="#pysnptools.kernelreader.KernelData" title="pysnptools.kernelreader.KernelData"><code class="xref py py-class docutils literal"><span class="pre">KernelData</span></code></a>.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">kernel_whole</span> <span class="o">=</span> <span class="n">KernelNpz</span><span class="p">(</span><span class="s1">&#39;../examples/toydata.kernel.npz&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">train_idx</span><span class="p">,</span> <span class="n">test_idx</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="n">kernel_whole</span><span class="o">.</span><span class="n">iid_count</span><span class="p">),</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>  <span class="c1">#test on the first 10, train on the rest</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kernel_train</span><span class="p">,</span> <span class="n">trained_standardizer</span> <span class="o">=</span> <span class="n">DiagKtoN</span><span class="p">()</span><span class="o">.</span><span class="n">standardize</span><span class="p">(</span><span class="n">kernel_whole</span><span class="p">[</span><span class="n">train_idx</span><span class="p">]</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span><span class="n">return_trained</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">kernel_train</span><span class="o">.</span><span class="n">val</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="go">490.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">trained_standardizer</span><span class="o">.</span><span class="n">factor</span>
<span class="go">9.99909752089e-05</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kernel_whole_test</span> <span class="o">=</span> <span class="n">kernel_whole</span><span class="p">[:,</span><span class="n">test_idx</span><span class="p">]</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">standardize</span><span class="p">(</span><span class="n">trained_standardizer</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kernel_whole_test</span><span class="o">.</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
<span class="go">0.99221743920965288</span>
</pre></div>
</div>
<p>Details of Methods &amp; Properties:</p>
<dl class="method">
<dt id="pysnptools.kernelstandardizer.KernelStandardizer.standardize">
<code class="descname">standardize</code><span class="sig-paren">(</span><em>kerneldata</em>, <em>return_trained=False</em>, <em>force_python_only=False</em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.kernelstandardizer.KernelStandardizer.standardize" title="Permalink to this definition">¶</a></dt>
<dd><p>Applies standardization, in place, to <a class="reference internal" href="#pysnptools.kernelreader.KernelData" title="pysnptools.kernelreader.KernelData"><code class="xref py py-class docutils literal"><span class="pre">KernelData</span></code></a>. For convenience also returns the <code class="xref py py-class docutils literal"><span class="pre">KernelData</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>snps</strong> (<a class="reference internal" href="#pysnptools.kernelreader.KernelData" title="pysnptools.kernelreader.KernelData"><code class="xref py py-class docutils literal"><span class="pre">KernelData</span></code></a>) &#8211; kernel values to standardize</li>
<li><strong>return_trained</strong> (<em>boolean</em>) &#8211; If true, returns a second value containing a constant <a class="reference internal" href="#pysnptools.kernelstandardizer.KernelStandardizer" title="pysnptools.kernelstandardizer.KernelStandardizer"><code class="xref py py-class docutils literal"><span class="pre">KernelStandardizer</span></code></a> trained on this data.</li>
<li><strong>force_python_only</strong> (<em>bool</em>) &#8211; optional &#8211; If False (default), may use outside library code. If True, requests that the read
be done without outside library code.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#pysnptools.kernelreader.KernelData" title="pysnptools.kernelreader.KernelData"><code class="xref py py-class docutils literal"><span class="pre">KernelData</span></code></a>, (optional) constant <a class="reference internal" href="#pysnptools.kernelstandardizer.KernelStandardizer" title="pysnptools.kernelstandardizer.KernelStandardizer"><code class="xref py py-class docutils literal"><span class="pre">KernelStandardizer</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="kernelstandardizer-diagkton">
<h3><code class="xref py py-class docutils literal"><span class="pre">kernelstandardizer.DiagKtoN</span></code><a class="headerlink" href="#kernelstandardizer-diagkton" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="pysnptools.kernelstandardizer.DiagKtoN">
<em class="property">class </em><code class="descclassname">pysnptools.kernelstandardizer.</code><code class="descname">DiagKtoN</code><span class="sig-paren">(</span><em>deprecated_iid_count=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.kernelstandardizer.DiagKtoN" title="Permalink to this definition">¶</a></dt>
<dd><p>Both a <a class="reference internal" href="#pysnptools.standardizer.Standardizer" title="pysnptools.standardizer.Standardizer"><code class="xref py py-class docutils literal"><span class="pre">Standardizer</span></code></a> and a A <a class="reference internal" href="#pysnptools.kernelstandardizer.KernelStandardizer" title="pysnptools.kernelstandardizer.KernelStandardizer"><code class="xref py py-class docutils literal"><span class="pre">KernelStandardizer</span></code></a>.</p>
<p>When applied to a <a class="reference internal" href="#pysnptools.snpreader.SnpData" title="pysnptools.snpreader.SnpData"><code class="xref py py-class docutils literal"><span class="pre">SnpData</span></code></a>, it multiplies the SNP values by the square root of a factor such that a kernel
constructed from the SNP values will have a diagonal that sums to iid_count. This class thus
standardizes the kernel before it is even constructed.</p>
<p>When applied to a <a class="reference internal" href="#pysnptools.kernelreader.KernelData" title="pysnptools.kernelreader.KernelData"><code class="xref py py-class docutils literal"><span class="pre">KernelData</span></code></a>, it multiplies the kernel values by the a factor such that a kernel
will have a diagonal that sums to iid_count.</p>
<p>See <a class="reference internal" href="#pysnptools.standardizer.Standardizer" title="pysnptools.standardizer.Standardizer"><code class="xref py py-class docutils literal"><span class="pre">Standardizer</span></code></a> for more information about standardization.</p>
<dl class="docutils">
<dt><strong>Constructor:</strong></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>deprecated_iid_count</strong> (<em>int</em>) (optional) &#8211; Deprecated.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd>
</dl>
<p>Example of DiagKtoN to <a class="reference internal" href="#pysnptools.snpreader.SnpData" title="pysnptools.snpreader.SnpData"><code class="xref py py-class docutils literal"><span class="pre">SnpData</span></code></a>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.standardizer</span> <span class="k">import</span> <span class="n">DiagKtoN</span><span class="p">,</span> <span class="n">Unit</span><span class="p">,</span> <span class="n">Identity</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.snpreader</span> <span class="k">import</span> <span class="n">Bed</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snpdata1</span> <span class="o">=</span> <span class="n">Bed</span><span class="p">(</span><span class="s1">&#39;../../tests/datasets/all_chr.maf0.001.N300&#39;</span><span class="p">,</span><span class="n">count_A1</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">standardize</span><span class="p">(</span><span class="n">Unit</span><span class="p">())</span><span class="o">.</span><span class="n">standardize</span><span class="p">(</span><span class="n">DiagKtoN</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kernel1</span> <span class="o">=</span> <span class="n">snpdata1</span><span class="o">.</span><span class="n">read_kernel</span><span class="p">(</span><span class="n">Identity</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">kernel1</span><span class="o">.</span><span class="n">val</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="go">300.0</span>
</pre></div>
</div>
<p>Example of DiagKtoN to <a class="reference internal" href="#pysnptools.kernelreader.KernelData" title="pysnptools.kernelreader.KernelData"><code class="xref py py-class docutils literal"><span class="pre">KernelData</span></code></a>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.standardizer</span> <span class="k">import</span> <span class="n">DiagKtoN</span><span class="p">,</span> <span class="n">Unit</span><span class="p">,</span> <span class="n">Identity</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.snpreader</span> <span class="k">import</span> <span class="n">Bed</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snpdata1</span> <span class="o">=</span> <span class="n">Bed</span><span class="p">(</span><span class="s1">&#39;../../tests/datasets/all_chr.maf0.001.N300&#39;</span><span class="p">,</span><span class="n">count_A1</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">standardize</span><span class="p">(</span><span class="n">Unit</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kernel1</span> <span class="o">=</span> <span class="n">snpdata1</span><span class="o">.</span><span class="n">read_kernel</span><span class="p">(</span><span class="n">DiagKtoN</span><span class="p">(),</span><span class="n">block_size</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">kernel1</span><span class="o">.</span><span class="n">val</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="go">300.0</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="kernelstandardizer-diagktontrained">
<h3><code class="xref py py-class docutils literal"><span class="pre">kernelstandardizer.DiagKtoNTrained</span></code><a class="headerlink" href="#kernelstandardizer-diagktontrained" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="pysnptools.kernelstandardizer.DiagKtoNTrained">
<em class="property">class </em><code class="descclassname">pysnptools.kernelstandardizer.</code><code class="descname">DiagKtoNTrained</code><span class="sig-paren">(</span><em>factor</em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.kernelstandardizer.DiagKtoNTrained" title="Permalink to this definition">¶</a></dt>
<dd><p>Both a <a class="reference internal" href="#pysnptools.standardizer.Standardizer" title="pysnptools.standardizer.Standardizer"><code class="xref py py-class docutils literal"><span class="pre">Standardizer</span></code></a> and a A <a class="reference internal" href="#pysnptools.kernelstandardizer.KernelStandardizer" title="pysnptools.kernelstandardizer.KernelStandardizer"><code class="xref py py-class docutils literal"><span class="pre">KernelStandardizer</span></code></a>.</p>
<p>When applied to a <a class="reference internal" href="#pysnptools.snpreader.SnpData" title="pysnptools.snpreader.SnpData"><code class="xref py py-class docutils literal"><span class="pre">SnpData</span></code></a>, DiagKtoN standardizes one set of SNP data based on another set of SNP data.</p>
<p>When applied to a <a class="reference internal" href="#pysnptools.kernelreader.KernelData" title="pysnptools.kernelreader.KernelData"><code class="xref py py-class docutils literal"><span class="pre">KernelData</span></code></a>, DiagKtoN standardizes one kernel data based on another kernel data.</p>
<p>See <a class="reference internal" href="#pysnptools.standardizer.Standardizer" title="pysnptools.standardizer.Standardizer"><code class="xref py py-class docutils literal"><span class="pre">Standardizer</span></code></a> for more information about standardization.</p>
<dl class="docutils">
<dt><strong>Constructor:</strong></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>factor</strong> (<em>float</em>) &#8211; The number what when multiplied into the kernel values will make the diagonal of the kernel values to  sum to iid_count.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="kernelstandardizer-identity">
<h3><code class="xref py py-class docutils literal"><span class="pre">kernelstandardizer.Identity</span></code><a class="headerlink" href="#kernelstandardizer-identity" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="pysnptools.kernelstandardizer.Identity">
<em class="property">class </em><code class="descclassname">pysnptools.kernelstandardizer.</code><code class="descname">Identity</code><a class="headerlink" href="#pysnptools.kernelstandardizer.Identity" title="Permalink to this definition">¶</a></dt>
<dd><p>A <a class="reference internal" href="#pysnptools.kernelstandardizer.KernelStandardizer" title="pysnptools.kernelstandardizer.KernelStandardizer"><code class="xref py py-class docutils literal"><span class="pre">KernelStandardizer</span></code></a> that does nothing to kernel data.</p>
<p>See <a class="reference internal" href="#pysnptools.kernelstandardizer.KernelStandardizer" title="pysnptools.kernelstandardizer.KernelStandardizer"><code class="xref py py-class docutils literal"><span class="pre">KernelStandardizer</span></code></a> for more information about standardization.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.kernelstandardizer</span> <span class="k">import</span> <span class="n">Identity</span> <span class="k">as</span> <span class="n">KS_Identity</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.kernelreader</span> <span class="k">import</span> <span class="n">KernelNpz</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kerneldata1</span> <span class="o">=</span> <span class="n">KernelNpz</span><span class="p">(</span><span class="s1">&#39;../examples/toydata.kernel.npz&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">kerneldata1</span><span class="o">.</span><span class="n">val</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="go">5000000.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kerneldata1</span> <span class="o">=</span> <span class="n">kerneldata1</span><span class="o">.</span><span class="n">standardize</span><span class="p">(</span><span class="n">KS_Identity</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">kerneldata1</span><span class="o">.</span><span class="n">val</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="go">5000000.0</span>
</pre></div>
</div>
</dd></dl>

</div>
</div>
<div class="section" id="module-pysnptools.pstreader">
<span id="pstreader-module"></span><h2><code class="xref py py-mod docutils literal"><span class="pre">pstreader</span></code> Module<a class="headerlink" href="#module-pysnptools.pstreader" title="Permalink to this headline">¶</a></h2>
<p>Tools for reading and manipulating matrix data along with row and column ids and properties.</p>
<div class="section" id="pstreader-pstreader">
<h3><code class="xref py py-class docutils literal"><span class="pre">pstreader.PstReader</span></code><a class="headerlink" href="#pstreader-pstreader" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="pysnptools.pstreader.PstReader">
<em class="property">class </em><code class="descclassname">pysnptools.pstreader.</code><code class="descname">PstReader</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.pstreader.PstReader" title="Permalink to this definition">¶</a></dt>
<dd><p>A PstReader is one of three things:</p>
<ul>
<li><p class="first">A <a class="reference internal" href="#pysnptools.pstreader.PstData" title="pysnptools.pstreader.PstData"><code class="xref py py-class docutils literal"><span class="pre">PstData</span></code></a> class that holds matrix data in memory:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.pstreader</span> <span class="k">import</span> <span class="n">PstData</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data1</span> <span class="o">=</span> <span class="n">PstData</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">],</span><span class="n">col</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">,</span><span class="s1">&#39;z&#39;</span><span class="p">],</span><span class="n">val</span><span class="o">=</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span><span class="mi">6</span><span class="p">]],</span><span class="n">row_property</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="s1">&#39;C&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">type</span><span class="p">(</span><span class="n">data1</span><span class="o">.</span><span class="n">val</span><span class="p">)</span> <span class="c1"># The val property is an ndarray of values</span>
<span class="go">&lt;type &#39;numpy.ndarray&#39;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data1</span><span class="o">.</span><span class="n">row_count</span> <span class="c1">#prints the number of rows in this in-memory data</span>
<span class="go">3</span>
</pre></div>
</div>
</li>
<li><p class="first">A class such as <a class="reference internal" href="#pysnptools.pstreader.PstNpz" title="pysnptools.pstreader.PstNpz"><code class="xref py py-class docutils literal"><span class="pre">PstNpz</span></code></a> for you to specify data in file. For example,</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.pstreader</span> <span class="k">import</span> <span class="n">PstNpz</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">on_disk</span> <span class="o">=</span> <span class="n">PstNpz</span><span class="p">(</span><span class="s1">&#39;../../tests/datasets/all_chr.maf0.001.N300.pst.npz&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">on_disk</span> <span class="c1"># prints specification for reading from file</span>
<span class="go">PstNpz(&#39;../../tests/datasets/all_chr.maf0.001.N300.pst.npz&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">on_disk</span><span class="o">.</span><span class="n">col_count</span> <span class="c1"># prints the number of columns (but doesn&#39;t read any matrix values)</span>
<span class="go">1015</span>
</pre></div>
</div>
</li>
<li><p class="first">A subset of any PstReader, specified with &#8220;[ <em>row_index</em> , <em>col_index</em> ]&#8221;, to read just some values.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.pstreader</span> <span class="k">import</span> <span class="n">PstNpz</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">on_disk</span> <span class="o">=</span> <span class="n">PstNpz</span><span class="p">(</span><span class="s1">&#39;../../tests/datasets/all_chr.maf0.001.N300.pst.npz&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">subset_on_disk</span> <span class="o">=</span> <span class="n">on_disk</span><span class="p">[[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],::</span><span class="mi">2</span><span class="p">]</span> <span class="c1"># specification for a subset of the data on disk. No values are read yet.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">subset_on_disk</span><span class="o">.</span><span class="n">col_count</span> <span class="c1"># prints the number of columns in this subset (but still doesn&#39;t read any values)</span>
<span class="go">508</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">subset_on_disk</span> <span class="c1">#prints a specification of &#39;subset_on_disk&#39;</span>
<span class="go">PstNpz(&#39;../../tests/datasets/all_chr.maf0.001.N300.pst.npz&#39;)[[3,4],::2]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_subset</span> <span class="o">=</span> <span class="n">subset_on_disk</span><span class="o">.</span><span class="n">read</span><span class="p">()</span> <span class="c1"># efficiently (if practical) reads the specified subset of values from the disk</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">data_subset</span> <span class="c1"># prints the specification of the in-memory information</span>
<span class="go">PstData(PstNpz(&#39;../../tests/datasets/all_chr.maf0.001.N300.pst.npz&#39;)[[3,4],::2])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">int</span><span class="p">(</span><span class="n">data_subset</span><span class="o">.</span><span class="n">val</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span><span class="nb">int</span><span class="p">(</span><span class="n">data_subset</span><span class="o">.</span><span class="n">val</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="c1"># The dimensions of the ndarray of values</span>
<span class="go">(2, 508)</span>
</pre></div>
</div>
</li>
</ul>
<p>The PstReaders Classes</p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="31%" />
<col width="31%" />
<col width="20%" />
<col width="19%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><em>Class</em></td>
<td><em>Format</em></td>
<td><em>Random Access</em></td>
<td><em>Suffixes</em></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#pysnptools.pstreader.PstData" title="pysnptools.pstreader.PstData"><code class="xref py py-class docutils literal"><span class="pre">PstData</span></code></a></td>
<td>in-memory floats</td>
<td>Yes</td>
<td><em>n/a</em></td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#pysnptools.pstreader.PstNpz" title="pysnptools.pstreader.PstNpz"><code class="xref py py-class docutils literal"><span class="pre">PstNpz</span></code></a></td>
<td>binary, floats</td>
<td>No</td>
<td>.pst.npz,.snp.npz,
.kernel.npz</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#pysnptools.pstreader.PstHdf5" title="pysnptools.pstreader.PstHdf5"><code class="xref py py-class docutils literal"><span class="pre">PstHdf5</span></code></a></td>
<td>binary, floats</td>
<td>Yes</td>
<td>.pst.hdf5,.snp.hdf5,
.kernel.hdf5</td>
</tr>
<tr class="row-odd"><td>various <a class="reference internal" href="#pysnptools.snpreader.SnpReader" title="pysnptools.snpreader.SnpReader"><code class="xref py py-class docutils literal"><span class="pre">SnpReader</span></code></a></td>
<td>varies</td>
<td>varies</td>
<td>varies</td>
</tr>
<tr class="row-even"><td>various <a class="reference internal" href="#pysnptools.kernelreader.KernelReader" title="pysnptools.kernelreader.KernelReader"><code class="xref py py-class docutils literal"><span class="pre">KernelReader</span></code></a></td>
<td>varies</td>
<td>varies</td>
<td>varies</td>
</tr>
</tbody>
</table>
<blockquote>
<div><p>A <a class="reference internal" href="#pysnptools.snpreader.SnpReader" title="pysnptools.snpreader.SnpReader"><code class="xref py py-class docutils literal"><span class="pre">SnpReader</span></code></a> and <a class="reference internal" href="#pysnptools.kernelreader.KernelReader" title="pysnptools.kernelreader.KernelReader"><code class="xref py py-class docutils literal"><span class="pre">KernelReader</span></code></a> are each a kind of <a class="reference internal" href="#pysnptools.pstreader.PstReader" title="pysnptools.pstreader.PstReader"><code class="xref py py-class docutils literal"><span class="pre">PstReader</span></code></a>. They have some restrictions summarized here:</p>
<table border="1" class="docutils">
<colgroup>
<col width="30%" />
<col width="13%" />
<col width="11%" />
<col width="11%" />
<col width="18%" />
<col width="18%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><em>Class</em></td>
<td><em>val type</em></td>
<td><em>row type</em></td>
<td><em>col type</em></td>
<td><em>row_property type</em></td>
<td><em>col_property type</em></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#pysnptools.pstreader.PstReader" title="pysnptools.pstreader.PstReader"><code class="xref py py-class docutils literal"><span class="pre">PstReader</span></code></a></td>
<td>float</td>
<td>any</td>
<td>any</td>
<td>any</td>
<td>any</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#pysnptools.snpreader.SnpReader" title="pysnptools.snpreader.SnpReader"><code class="xref py py-class docutils literal"><span class="pre">SnpReader</span></code></a></td>
<td>float</td>
<td>str,str</td>
<td>str</td>
<td>none</td>
<td>float,float,float</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#pysnptools.kernelreader.KernelReader" title="pysnptools.kernelreader.KernelReader"><code class="xref py py-class docutils literal"><span class="pre">KernelReader</span></code></a></td>
<td>float</td>
<td>str,str</td>
<td>str,str</td>
<td>none</td>
<td>none</td>
</tr>
</tbody>
</table>
<p>For convenience, they allow additional ways to access rows and columns.</p>
<table border="1" class="docutils">
<colgroup>
<col width="30%" />
<col width="13%" />
<col width="11%" />
<col width="11%" />
<col width="18%" />
<col width="18%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><em>Class</em></td>
<td><em>val name</em></td>
<td><em>row name</em></td>
<td><em>col name</em></td>
<td><em>row_property name</em></td>
<td><em>col_property name</em></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#pysnptools.pstreader.PstReader" title="pysnptools.pstreader.PstReader"><code class="xref py py-class docutils literal"><span class="pre">PstReader</span></code></a></td>
<td>val</td>
<td>row</td>
<td>col</td>
<td>row_property</td>
<td>col_property</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#pysnptools.snpreader.SnpReader" title="pysnptools.snpreader.SnpReader"><code class="xref py py-class docutils literal"><span class="pre">SnpReader</span></code></a></td>
<td>val</td>
<td>iid,row</td>
<td>sid,col</td>
<td>none</td>
<td>col_property,pos</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#pysnptools.kernelreader.KernelReader" title="pysnptools.kernelreader.KernelReader"><code class="xref py py-class docutils literal"><span class="pre">KernelReader</span></code></a></td>
<td>val</td>
<td>iid0,row,iid</td>
<td>iid1,col,iid</td>
<td>none</td>
<td>none</td>
</tr>
</tbody>
</table>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Note:</th><td class="field-body">A <a class="reference internal" href="#pysnptools.kernelreader.KernelReader.iid" title="pysnptools.kernelreader.KernelReader.iid"><code class="xref py py-attr docutils literal"><span class="pre">KernelReader.iid</span></code></a> may be used when <a class="reference internal" href="#pysnptools.kernelreader.KernelReader.iid0" title="pysnptools.kernelreader.KernelReader.iid0"><code class="xref py py-attr docutils literal"><span class="pre">KernelReader.iid0</span></code></a> is equal to <a class="reference internal" href="#pysnptools.kernelreader.KernelReader.iid1" title="pysnptools.kernelreader.KernelReader.iid1"><code class="xref py py-attr docutils literal"><span class="pre">KernelReader.iid1</span></code></a></td>
</tr>
</tbody>
</table>
</div></blockquote>
</div></blockquote>
<p>Methods &amp; Properties:</p>
<blockquote>
<div><p>Every PstReader, such as <a class="reference internal" href="#pysnptools.pstreader.PstNpz" title="pysnptools.pstreader.PstNpz"><code class="xref py py-class docutils literal"><span class="pre">PstNpz</span></code></a> and <a class="reference internal" href="#pysnptools.pstreader.PstData" title="pysnptools.pstreader.PstData"><code class="xref py py-class docutils literal"><span class="pre">PstData</span></code></a>, has these properties: <a class="reference internal" href="#pysnptools.pstreader.PstReader.row" title="pysnptools.pstreader.PstReader.row"><code class="xref py py-attr docutils literal"><span class="pre">row</span></code></a>, <a class="reference internal" href="#pysnptools.pstreader.PstReader.row_count" title="pysnptools.pstreader.PstReader.row_count"><code class="xref py py-attr docutils literal"><span class="pre">row_count</span></code></a>, <a class="reference internal" href="#pysnptools.pstreader.PstReader.col" title="pysnptools.pstreader.PstReader.col"><code class="xref py py-attr docutils literal"><span class="pre">col</span></code></a>, <a class="reference internal" href="#pysnptools.pstreader.PstReader.col_count" title="pysnptools.pstreader.PstReader.col_count"><code class="xref py py-attr docutils literal"><span class="pre">col_count</span></code></a>,
<a class="reference internal" href="#pysnptools.pstreader.PstReader.row_property" title="pysnptools.pstreader.PstReader.row_property"><code class="xref py py-attr docutils literal"><span class="pre">row_property</span></code></a>, <a class="reference internal" href="#pysnptools.pstreader.PstReader.col_property" title="pysnptools.pstreader.PstReader.col_property"><code class="xref py py-attr docutils literal"><span class="pre">col_property</span></code></a> and these methods: <a class="reference internal" href="#pysnptools.pstreader.PstReader.read" title="pysnptools.pstreader.PstReader.read"><code class="xref py py-meth docutils literal"><span class="pre">read()</span></code></a>, <a class="reference internal" href="#pysnptools.pstreader.PstReader.row_to_index" title="pysnptools.pstreader.PstReader.row_to_index"><code class="xref py py-meth docutils literal"><span class="pre">row_to_index()</span></code></a>, <a class="reference internal" href="#pysnptools.pstreader.PstReader.col_to_index" title="pysnptools.pstreader.PstReader.col_to_index"><code class="xref py py-meth docutils literal"><span class="pre">col_to_index()</span></code></a>. See below for details.</p>
<p><a class="reference internal" href="#pysnptools.pstreader.PstData" title="pysnptools.pstreader.PstData"><code class="xref py py-class docutils literal"><span class="pre">PstData</span></code></a> is a PstReader so it supports the above properties and methods. In addition, it supports property <code class="xref py py-attr docutils literal"><span class="pre">PstData.val</span></code> and equality testing.
See below for details.</p>
</div></blockquote>
<p>Rows and Cols:</p>
<blockquote>
<div><p>Example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.pstreader</span> <span class="k">import</span> <span class="n">PstHdf5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">on_disk</span> <span class="o">=</span> <span class="n">PstHdf5</span><span class="p">(</span><span class="s1">&#39;../examples/toydata.iidmajor.snp.hdf5&#39;</span><span class="p">)</span> <span class="c1"># PstHdf5 can load .pst.hdf5, .snp.hdf5, and kernel.hdf5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">on_disk</span><span class="o">.</span><span class="n">row</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span> <span class="c1"># print the first three rows</span>
<span class="go">[[&#39;per0&#39; &#39;per0&#39;]</span>
<span class="go"> [&#39;per1&#39; &#39;per1&#39;]</span>
<span class="go"> [&#39;per2&#39; &#39;per2&#39;]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">on_disk</span><span class="o">.</span><span class="n">col</span><span class="p">[:</span><span class="mi">8</span><span class="p">]</span> <span class="c1"># print the first eight columns</span>
<span class="go">[&#39;null_0&#39; &#39;null_1&#39; &#39;null_2&#39; &#39;null_3&#39; &#39;null_4&#39; &#39;null_5&#39; &#39;null_6&#39; &#39;null_7&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">on_disk</span><span class="o">.</span><span class="n">row_to_index</span><span class="p">([[</span><span class="s1">&#39;per2&#39;</span><span class="p">,</span> <span class="s1">&#39;per2&#39;</span><span class="p">],[</span><span class="s1">&#39;per1&#39;</span><span class="p">,</span> <span class="s1">&#39;per1&#39;</span><span class="p">]])</span> <span class="c1">#Find the indexes for two rows.</span>
<span class="go">[2 1]</span>
</pre></div>
</div>
</div></blockquote>
<p>When Matrix Data is Read:</p>
<blockquote>
<div><p>Matrix data can be enormous so we generally avoid reading it to the degree practical. Specifically,</p>
<ul>
<li><p class="first">Constructing and printing a PstReader causes no file reading. For example, these commands read no data:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">on_disk</span> <span class="o">=</span> <span class="n">PstHdf5</span><span class="p">(</span><span class="s1">&#39;../examples/toydata.iidmajor.snp.hdf5&#39;</span><span class="p">)</span> <span class="c1"># Construct a PstHdf5 PstReader. No data is read.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">on_disk</span> <span class="c1"># Print the PstHdf5 PstReader specification. No data is read.</span>
<span class="go">PstHdf5(&#39;../examples/toydata.iidmajor.snp.hdf5&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">subset_on_disk</span> <span class="o">=</span> <span class="n">on_disk</span><span class="p">[[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],::</span><span class="mi">2</span><span class="p">]</span> <span class="c1"># Construct a subsetting PstReader. No data is read.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">subset_on_disk</span> <span class="c1"># print the subset PstReader. No data is read.</span>
<span class="go">PstHdf5(&#39;../examples/toydata.iidmajor.snp.hdf5&#39;)[[3,4],::2]</span>
</pre></div>
</div>
</li>
<li><p class="first">Properties and methods related to the rows and columns (to the degree practical) read only row and col data from the disk,
not value data. Moreover, the row and col data is read from file only once. Consider these commands:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">on_disk</span> <span class="o">=</span> <span class="n">PstHdf5</span><span class="p">(</span><span class="s1">&#39;../examples/toydata.iidmajor.snp.hdf5&#39;</span><span class="p">)</span> <span class="c1"># Construct a PstHdf5 PstReader. No data is read.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">on_disk</span><span class="o">.</span><span class="n">col</span><span class="p">[:</span><span class="mi">8</span><span class="p">]</span> <span class="c1"># without reading any values data from disk, read the row and col data from disk, cache it, and then print the first eight cols.</span>
<span class="go">[&#39;null_0&#39; &#39;null_1&#39; &#39;null_2&#39; &#39;null_3&#39; &#39;null_4&#39; &#39;null_5&#39; &#39;null_6&#39; &#39;null_7&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">on_disk</span><span class="o">.</span><span class="n">col_to_index</span><span class="p">([</span><span class="s1">&#39;null_7&#39;</span><span class="p">,</span><span class="s1">&#39;null_2&#39;</span><span class="p">])</span> <span class="c1">#use the cached col information to find the indexes of &#39;null_7&#39; and &#39;null_2&#39;. (No data is read from disk.)</span>
<span class="go">[7 2]</span>
</pre></div>
</div>
</li>
<li><p class="first">The only method that reads values from file (to the degree practical) is <a class="reference internal" href="#pysnptools.pstreader.PstReader.read" title="pysnptools.pstreader.PstReader.read"><code class="xref py py-meth docutils literal"><span class="pre">read()</span></code></a>. For example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">on_disk</span> <span class="o">=</span> <span class="n">PstHdf5</span><span class="p">(</span><span class="s1">&#39;../examples/toydata.iidmajor.snp.hdf5&#39;</span><span class="p">)</span> <span class="c1"># Construct a PstHdf5 PstReader. No data is read.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data1</span> <span class="o">=</span> <span class="n">on_disk</span><span class="o">.</span><span class="n">read</span><span class="p">()</span> <span class="c1">#read all the values from disk, creating a new PstData instance that keeps these values in memory</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">data1</span><span class="o">.</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span> <span class="c1"># print the value for the row with index 0 and the col with index 2. (No data is read from disk.)</span>
<span class="go">2.0</span>
</pre></div>
</div>
</li>
<li><p class="first">If you request the values for only a subset of the rows or columns, (to the degree practical) only that subset will be read from disk.
for example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">on_disk</span> <span class="o">=</span> <span class="n">PstHdf5</span><span class="p">(</span><span class="s1">&#39;../../tests/datasets/all_chr.maf0.001.N300.snp.hdf5&#39;</span><span class="p">)[[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],::</span><span class="mi">2</span><span class="p">]</span> <span class="c1"># Construct a subsetting PstReader. No data is read.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_subset</span> <span class="o">=</span> <span class="n">subset_on_disk</span><span class="o">.</span><span class="n">read</span><span class="p">()</span> <span class="c1"># from disk, read the values for the rows with index 3 and 4 AND cols with even numbered indexes.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">data_subset</span><span class="o">.</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span> <span class="c1"># print the value with subset row index 0 and col index 2 (corresponding to row index 3 and col index 4 in the full data). No data is read from disk.</span>
<span class="go">1.0</span>
</pre></div>
</div>
</li>
</ul>
</div></blockquote>
<p>When Matrix Data is Re-Read and Copied:</p>
<blockquote>
<div><p>Every time you call a PstReader&#8217;s <a class="reference internal" href="#pysnptools.pstreader.PstReader.read" title="pysnptools.pstreader.PstReader.read"><code class="xref py py-meth docutils literal"><span class="pre">read()</span></code></a> method, the PstReader re-reads the value data and returns a new in-memory <a class="reference internal" href="#pysnptools.pstreader.PstData" title="pysnptools.pstreader.PstData"><code class="xref py py-class docutils literal"><span class="pre">PstData</span></code></a>
(with <code class="xref py py-attr docutils literal"><span class="pre">PstData.val</span></code> property containing a new ndarray of the values).</p>
<p>Here is an example of what not to do, because it causes all the matrix value data to be read twice.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">on_disk</span> <span class="o">=</span> <span class="n">PstHdf5</span><span class="p">(</span><span class="s1">&#39;../examples/toydata.iidmajor.snp.hdf5&#39;</span><span class="p">)</span> <span class="c1"># Construct a PstHdf5 PstReader. No data is read.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Not recommended because it inefficiently reads all the values twice.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">on_disk</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span> <span class="c1"># read all values into a new PstData, print a value</span>
<span class="go">2.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">on_disk</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span> <span class="c1"># read all values (again) into a second new PstData, print a value</span>
<span class="go">2.0</span>
</pre></div>
</div>
<p>Here are two efficient alternatives. First, if all values can all fit in memory, read them once into a <a class="reference internal" href="#pysnptools.pstreader.PstData" title="pysnptools.pstreader.PstData"><code class="xref py py-class docutils literal"><span class="pre">PstData</span></code></a> and then
access that <a class="reference internal" href="#pysnptools.pstreader.PstData" title="pysnptools.pstreader.PstData"><code class="xref py py-class docutils literal"><span class="pre">PstData</span></code></a> multiple times.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">on_disk</span> <span class="o">=</span> <span class="n">PstHdf5</span><span class="p">(</span><span class="s1">&#39;../examples/toydata.iidmajor.snp.hdf5&#39;</span><span class="p">)</span> <span class="c1"># Construct a PstHdf5 PstReader. No data is read.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data1</span> <span class="o">=</span> <span class="n">on_disk</span><span class="o">.</span><span class="n">read</span><span class="p">()</span> <span class="c1"># read all values into a new PstData</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">data1</span><span class="o">.</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span> <span class="c1"># print a value from data1&#39;s in-memory ndarray</span>
<span class="go">2.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">data1</span><span class="o">.</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span> <span class="c1"># print another value from data1&#39;s in-memory ndarray.</span>
<span class="go">2.0</span>
</pre></div>
</div>
<p>Second, if the value data is too large to fit in memory, use subsetting to read only the values of interest from disk.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">on_disk</span> <span class="o">=</span> <span class="n">PstHdf5</span><span class="p">(</span><span class="s1">&#39;../examples/toydata.iidmajor.snp.hdf5&#39;</span><span class="p">)</span> <span class="c1"># Construct a PstHdf5 PstReader. No data is read.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">on_disk</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="c1">#Define the subset of data and read only that subset from disk.</span>
<span class="go">2.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">on_disk</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="c1">#Define a second subset of data and read only that subset from disk.</span>
<span class="go">2.0</span>
</pre></div>
</div>
<p>Because the in-memory <a class="reference internal" href="#pysnptools.pstreader.PstData" title="pysnptools.pstreader.PstData"><code class="xref py py-class docutils literal"><span class="pre">PstData</span></code></a> class is a kind of PstReader, you may read from it, too.
Doing so create a new <a class="reference internal" href="#pysnptools.pstreader.PstData" title="pysnptools.pstreader.PstData"><code class="xref py py-class docutils literal"><span class="pre">PstData</span></code></a> instance containing a copy of the matrix values in a new ndarray.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">on_disk</span> <span class="o">=</span> <span class="n">PstHdf5</span><span class="p">(</span><span class="s1">&#39;../examples/toydata.iidmajor.snp.hdf5&#39;</span><span class="p">)</span> <span class="c1"># Construct a PstHdf5 PstReader. No data is read.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data1</span> <span class="o">=</span> <span class="n">on_disk</span><span class="o">.</span><span class="n">read</span><span class="p">()</span> <span class="c1"># read all matrix values from disk into a new PstData</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">data1</span><span class="o">.</span><span class="n">val</span> <span class="ow">is</span> <span class="n">data1</span><span class="o">.</span><span class="n">val</span> <span class="c1"># Do the in-memory SNP values use the same memory as themselves? Yes</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data2</span> <span class="o">=</span> <span class="n">data1</span><span class="o">.</span><span class="n">read</span><span class="p">()</span> <span class="c1"># copy all the matrix values into a new ndarray in a new PstData</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">data2</span><span class="o">.</span><span class="n">val</span> <span class="ow">is</span> <span class="n">data1</span><span class="o">.</span><span class="n">val</span> <span class="c1"># Do the two ndarrays of in-memory matrix values use the same memory?</span>
<span class="go">False</span>
</pre></div>
</div>
</div></blockquote>
<p>Avoiding Unwanted ndarray Allocations</p>
<blockquote>
<div><p>You may want a subset of matrix values from an in-memory <a class="reference internal" href="#pysnptools.pstreader.PstData" title="pysnptools.pstreader.PstData"><code class="xref py py-class docutils literal"><span class="pre">PstData</span></code></a> and you may know that this subset and the original <a class="reference internal" href="#pysnptools.pstreader.PstData" title="pysnptools.pstreader.PstData"><code class="xref py py-class docutils literal"><span class="pre">PstData</span></code></a>
can safely share the memory of the ndarray of matrix values. For this case, the <a class="reference internal" href="#pysnptools.pstreader.PstReader.read" title="pysnptools.pstreader.PstReader.read"><code class="xref py py-meth docutils literal"><span class="pre">read()</span></code></a> has optional parameters called view_ok and order. If you override 
the defaults of &#8220;view_ok=False,order=&#8217;F&#8217;&#8221; with &#8220;view_ok=True,order=&#8217;A&#8217;, the <a class="reference internal" href="#pysnptools.pstreader.PstReader.read" title="pysnptools.pstreader.PstReader.read"><code class="xref py py-meth docutils literal"><span class="pre">read()</span></code></a> will, if practical, return a new 
<a class="reference internal" href="#pysnptools.pstreader.PstData" title="pysnptools.pstreader.PstData"><code class="xref py py-class docutils literal"><span class="pre">PstData</span></code></a> with a ndarray shares memory with the original ndarray.
Use these parameters with care because any change to either ndarray will effect
the others. Also keep in mind that <a class="reference internal" href="#pysnptools.pstreader.PstReader.read" title="pysnptools.pstreader.PstReader.read"><code class="xref py py-meth docutils literal"><span class="pre">read()</span></code></a> relies on ndarray&#8217;s mechanisms to decide whether to actually
share memory and so it may ignore your suggestion and allocate a new ndarray anyway.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">on_disk</span> <span class="o">=</span> <span class="n">PstNpz</span><span class="p">(</span><span class="s1">&#39;../../tests/datasets/all_chr.maf0.001.N300.pst.npz&#39;</span><span class="p">)</span> <span class="c1"># Construct a PstNpz PstReader. No data is read.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data1</span> <span class="o">=</span> <span class="n">on_disk</span><span class="o">.</span><span class="n">read</span><span class="p">()</span> <span class="c1"># read all data from disk into a PstData with a new ndarray</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">column01</span> <span class="o">=</span> <span class="n">data1</span><span class="p">[:,</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">view_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">order</span><span class="o">=</span><span class="s1">&#39;A&#39;</span><span class="p">)</span> <span class="c1">#create PstData with the data from just the first two columns. Sharing memory is OK. The memory may be laid out in any order (that is col-major and row-major are both OK).</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#print np.may_share_memory(data1.val, column01.val) # Do the two ndarray&#39;s share memory? They could (but currently they won&#39;t)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">column201</span> <span class="o">=</span> <span class="n">data1</span><span class="p">[:,[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">view_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">order</span><span class="o">=</span><span class="s1">&#39;A&#39;</span><span class="p">)</span> <span class="c1">#create PstData with the data from three columns, permuted. Sharing memory is OK.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">np</span><span class="o">.</span><span class="n">may_share_memory</span><span class="p">(</span><span class="n">data1</span><span class="o">.</span><span class="n">val</span><span class="p">,</span> <span class="n">column201</span><span class="o">.</span><span class="n">val</span><span class="p">)</span> <span class="c1"># Do the two ndarray&#39;s share memory? No, ndarray decided that this indexing was too complex for sharing.</span>
<span class="go">False</span>
</pre></div>
</div>
</div></blockquote>
<p>Creating Subsetting PstReaders with Indexing</p>
<blockquote>
<div><p>You often don&#8217;t want to read the matrix values for all rows and cols. You can use indexing to create a subsetting PstReader that
will read only the matrix values of interest.</p>
<p>PstReaders support the indexing formats supported by ndarray plus two generalizations. Here are examples of indexing with an array
of indexes, with slicing, and with an array of Booleans.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">on_disk</span> <span class="o">=</span> <span class="n">PstNpz</span><span class="p">(</span><span class="s1">&#39;../../tests/datasets/all_chr.maf0.001.N300.pst.npz&#39;</span><span class="p">)</span> <span class="c1"># Specify some data on disk in PstNpz format</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">subset_reader_1</span> <span class="o">=</span> <span class="n">on_disk</span><span class="p">[[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],:]</span> <span class="c1">#index with an array of indexes</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">subset_reader_1</span><span class="o">.</span><span class="n">row_count</span><span class="p">,</span> <span class="n">subset_reader_1</span><span class="o">.</span><span class="n">col_count</span>
<span class="go">2 1015</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data1</span> <span class="o">=</span> <span class="n">subset_reader_1</span><span class="o">.</span><span class="n">read</span><span class="p">()</span> <span class="c1"># read just the two rows of interest from the disk</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">subset_reader_2</span> <span class="o">=</span> <span class="n">on_disk</span><span class="p">[:,:</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="c1">#index with a slice</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">subset_reader_2</span><span class="o">.</span><span class="n">row_count</span><span class="p">,</span> <span class="n">subset_reader_2</span><span class="o">.</span><span class="n">col_count</span>
<span class="go">300 507</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">boolindexes</span> <span class="o">=</span> <span class="p">[</span><span class="n">s</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;23_&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">on_disk</span><span class="o">.</span><span class="n">col</span><span class="p">]</span> <span class="c1"># create a Boolean index of cols that start &#39;23_&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">subset_reader_3</span> <span class="o">=</span> <span class="n">on_disk</span><span class="p">[:,</span><span class="n">boolindexes</span><span class="p">]</span> <span class="c1">#index with array of Booleans</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">subset_reader_3</span><span class="o">.</span><span class="n">row_count</span><span class="p">,</span> <span class="n">subset_reader_3</span><span class="o">.</span><span class="n">col_count</span>
<span class="go">300 24</span>
</pre></div>
</div>
<p>The first generalization over what ndarray offers is full indexing on both the row dimension and the col dimension, in other words,
full multidimensional indexing. For example,</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">on_disk</span> <span class="o">=</span> <span class="n">PstNpz</span><span class="p">(</span><span class="s1">&#39;../../tests/datasets/all_chr.maf0.001.N300.pst.npz&#39;</span><span class="p">)</span> <span class="c1"># Specify some data on disk in PstNpz format</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">subset_reader_4</span> <span class="o">=</span> <span class="n">on_disk</span><span class="p">[[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],:</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="c1"># index on two dimensions at once</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">subset_reader_4</span><span class="o">.</span><span class="n">row_count</span><span class="p">,</span> <span class="n">subset_reader_4</span><span class="o">.</span><span class="n">col_count</span>
<span class="go">2 507</span>
</pre></div>
</div>
<p>The second generalization is indexing on a single integer index.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">on_disk</span> <span class="o">=</span> <span class="n">PstNpz</span><span class="p">(</span><span class="s1">&#39;../../tests/datasets/all_chr.maf0.001.N300.pst.npz&#39;</span><span class="p">)</span> <span class="c1"># Specify some data on disk in PstNpz format</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">subset_reader_5</span> <span class="o">=</span> <span class="n">on_disk</span><span class="p">[</span><span class="mi">5</span><span class="p">,:]</span> <span class="c1">#index with single integer</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">subset_reader_5</span><span class="o">.</span><span class="n">row_count</span><span class="p">,</span> <span class="n">subset_reader_5</span><span class="o">.</span><span class="n">col_count</span>
<span class="go">1 1015</span>
</pre></div>
</div>
<p>Indexing is also useful when you have matrix values in memory via a <a class="reference internal" href="#pysnptools.pstreader.PstData" title="pysnptools.pstreader.PstData"><code class="xref py py-class docutils literal"><span class="pre">PstData</span></code></a> index and want to copy a subset of those values.
While you could instead index directly on the <cite>.PstData.val</cite> ndarray, by indexing on the <a class="reference internal" href="#pysnptools.pstreader.PstData" title="pysnptools.pstreader.PstData"><code class="xref py py-class docutils literal"><span class="pre">PstData</span></code></a> instance you
also get row and col information.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">on_disk</span> <span class="o">=</span> <span class="n">PstNpz</span><span class="p">(</span><span class="s1">&#39;../../tests/datasets/all_chr.maf0.001.N300.pst.npz&#39;</span><span class="p">)</span> <span class="c1"># Specify some data on disk in PstNpz format</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data1</span> <span class="o">=</span> <span class="n">on_disk</span><span class="o">.</span><span class="n">read</span><span class="p">()</span> <span class="c1"># read all matrix values into memory</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">data1</span><span class="o">.</span><span class="n">col</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span> <span class="c1"># print the first 10 cols</span>
<span class="go">[&#39;1_12&#39; &#39;1_34&#39; &#39;1_10&#39; &#39;1_35&#39; &#39;1_28&#39; &#39;1_25&#39; &#39;1_36&#39; &#39;1_39&#39; &#39;1_4&#39; &#39;1_13&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_subset</span> <span class="o">=</span> <span class="n">data1</span><span class="p">[:,::</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">view_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">order</span><span class="o">=</span><span class="s1">&#39;A&#39;</span><span class="p">)</span> <span class="c1"># create a copy or view with every other col</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">data_subset</span><span class="o">.</span><span class="n">col</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span> <span class="c1"># print the first 10 cols in the subset</span>
<span class="go">[&#39;1_12&#39; &#39;1_10&#39; &#39;1_28&#39; &#39;1_36&#39; &#39;1_4&#39; &#39;1_11&#39; &#39;1_32&#39; &#39;1_9&#39; &#39;1_17&#39; &#39;1_18&#39;]</span>
</pre></div>
</div>
<p>You can apply indexing on top of indexing to specify subsets of subsets of data to read. In this example, 
only the column values for every 16th col is actually read from the disk.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># These are just PstReaders, nothing is read from disk yet</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">on_disk</span> <span class="o">=</span> <span class="n">PstNpz</span><span class="p">(</span><span class="s1">&#39;../../tests/datasets/all_chr.maf0.001.N300.pst.npz&#39;</span><span class="p">)</span> <span class="c1"># Specify some data on disk in PstNpz format</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">half_reader</span> <span class="o">=</span> <span class="n">on_disk</span><span class="p">[:,::</span><span class="mi">2</span><span class="p">]</span> <span class="c1"># a reader for half the cols</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">quarter_reader</span> <span class="o">=</span> <span class="n">half_reader</span><span class="p">[:,::</span><span class="mi">2</span><span class="p">]</span> <span class="c1"># a reader for half of half the cols</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sixteenth_reader</span> <span class="o">=</span> <span class="n">quarter_reader</span><span class="p">[:,::</span><span class="mi">2</span><span class="p">][:,::</span><span class="mi">2</span><span class="p">]</span> <span class="c1"># a reader for half of half of half of half the cols</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">sixteenth_reader</span> <span class="c1">#Print the specification of this reader</span>
<span class="go">PstNpz(&#39;../../tests/datasets/all_chr.maf0.001.N300.pst.npz&#39;)[:,::2][:,::2][:,::2][:,::2]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Now we read from disk. Only values for one col in every 16 will be read.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_sixteenth</span> <span class="o">=</span> <span class="n">sixteenth_reader</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">data_sixteenth</span><span class="o">.</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span>
<span class="go">2.0</span>
</pre></div>
</div>
</div></blockquote>
<p>The <a class="reference internal" href="#pysnptools.pstreader.PstReader.read" title="pysnptools.pstreader.PstReader.read"><code class="xref py py-meth docutils literal"><span class="pre">read()</span></code></a> Method</p>
<blockquote>
<div>By default the <a class="reference internal" href="#pysnptools.pstreader.PstReader.read" title="pysnptools.pstreader.PstReader.read"><code class="xref py py-meth docutils literal"><span class="pre">read()</span></code></a> returns a ndarray of scipy.float64 laid out in memory in F-contiguous order (row-index varies the fastest). You may, instead,
ask for scipy.float32 or for C-contiguous order or any order. See <a class="reference internal" href="#pysnptools.pstreader.PstReader.read" title="pysnptools.pstreader.PstReader.read"><code class="xref py py-meth docutils literal"><span class="pre">read()</span></code></a> for details.</div></blockquote>
<p>Details of Methods &amp; Properties:</p>
<dl class="attribute">
<dt id="pysnptools.pstreader.PstReader.col">
<code class="descname">col</code><a class="headerlink" href="#pysnptools.pstreader.PstReader.col" title="Permalink to this definition">¶</a></dt>
<dd><p>A ndarray of the cols id. Each id can be anything, for example, a string, an array of two strings, a number, etc.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">ndarray (length <a class="reference internal" href="#pysnptools.pstreader.PstReader.col_count" title="pysnptools.pstreader.PstReader.col_count"><code class="xref py py-attr docutils literal"><span class="pre">col_count</span></code></a>)</td>
</tr>
</tbody>
</table>
<p>This property (to the degree practical) reads only row and col data from the disk, not matrix value data.
Moreover, the row and col data is read from file only once.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.pstreader</span> <span class="k">import</span> <span class="n">PstData</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data1</span> <span class="o">=</span> <span class="n">PstData</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">],</span><span class="n">col</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">,</span><span class="s1">&#39;z&#39;</span><span class="p">],</span><span class="n">val</span><span class="o">=</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span><span class="mi">6</span><span class="p">]],</span><span class="n">row_property</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="s1">&#39;C&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">data1</span><span class="o">.</span><span class="n">col</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="c1"># print the last column id.</span>
<span class="go">z</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data2</span> <span class="o">=</span> <span class="n">PstData</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">],</span><span class="n">col</span><span class="o">=</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">]],</span><span class="n">val</span><span class="o">=</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span><span class="mi">6</span><span class="p">]],</span><span class="n">row_property</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="s1">&#39;C&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">data2</span><span class="o">.</span><span class="n">col</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="c1"># print the last column id.</span>
<span class="go">[2 0]</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="pysnptools.pstreader.PstReader.col_count">
<code class="descname">col_count</code><a class="headerlink" href="#pysnptools.pstreader.PstReader.col_count" title="Permalink to this definition">¶</a></dt>
<dd><p>number of cols</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">integer</td>
</tr>
</tbody>
</table>
<p>This property (to the degree practical) reads only row and col data from the disk, not matrix value data. Moreover, the row and col data is read from file only once.</p>
</dd></dl>

<dl class="attribute">
<dt id="pysnptools.pstreader.PstReader.col_property">
<code class="descname">col_property</code><a class="headerlink" href="#pysnptools.pstreader.PstReader.col_property" title="Permalink to this definition">¶</a></dt>
<dd><p>A ndarray of the additional information for each col. Each element is a ndarray.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">1- or 2-dimensional ndarray (length <a class="reference internal" href="#pysnptools.pstreader.PstReader.col_count" title="pysnptools.pstreader.PstReader.col_count"><code class="xref py py-attr docutils literal"><span class="pre">col_count</span></code></a>)</td>
</tr>
</tbody>
</table>
<p>This property (to the degree practical) reads only row and col data from the disk, not matrix value data. Moreover, the row and col data is read from file only once.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
<tr class="field-even field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.pstreader</span> <span class="k">import</span> <span class="n">PstNpz</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">on_disk</span> <span class="o">=</span> <span class="n">PstNpz</span><span class="p">(</span><span class="s1">&#39;../../tests/datasets/all_chr.maf0.001.N300.pst.npz&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">on_disk</span><span class="o">.</span><span class="n">col_property</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span> <span class="c1"># print column information for the first three cols:</span>
<span class="go">[[ 1.          0.00800801  0.        ]</span>
<span class="go"> [ 1.          0.023023    1.        ]</span>
<span class="go"> [ 1.          0.0700701   4.        ]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pysnptools.pstreader.PstReader.col_to_index">
<code class="descname">col_to_index</code><span class="sig-paren">(</span><em>list</em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.pstreader.PstReader.col_to_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes a list of column ds and returns a list of index numbers</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>list</strong> (<em>list</em>) &#8211; list of cols</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">ndarray of int</td>
</tr>
</tbody>
</table>
<p>This method (to the degree practical) reads only row and col data from the disk, not matrix value data. Moreover, the row and col data is read from file only once.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.pstreader</span> <span class="k">import</span> <span class="n">PstNpz</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">on_disk</span> <span class="o">=</span> <span class="n">PstNpz</span><span class="p">(</span><span class="s1">&#39;../../tests/datasets/all_chr.maf0.001.N300.pst.npz&#39;</span><span class="p">)</span> <span class="c1"># Specify matrix data on disk</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">on_disk</span><span class="o">.</span><span class="n">col_to_index</span><span class="p">([</span><span class="s1">&#39;1_10&#39;</span><span class="p">,</span><span class="s1">&#39;1_13&#39;</span><span class="p">])</span> <span class="c1">#Find the indexes for two cols.</span>
<span class="go">[2 9]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pysnptools.pstreader.PstReader.read">
<code class="descname">read</code><span class="sig-paren">(</span><em>order='F'</em>, <em>dtype=&lt;type 'numpy.float64'&gt;</em>, <em>force_python_only=False</em>, <em>view_ok=False</em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.pstreader.PstReader.read" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads the matrix values and returns a <a class="reference internal" href="#pysnptools.pstreader.PstData" title="pysnptools.pstreader.PstData"><code class="xref py py-class docutils literal"><span class="pre">PstData</span></code></a> (with <code class="xref py py-attr docutils literal"><span class="pre">PstData.val</span></code> property containing a new ndarray of the matrix values).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>order</strong> (<em>string or None</em>) &#8211; {&#8216;F&#8217; (default), &#8216;C&#8217;, &#8216;A&#8217;}, optional &#8211; Specify the order of the ndarray. If order is &#8216;F&#8217; (default),
then the array will be in F-contiguous order (row-index varies the fastest).
If order is &#8216;C&#8217;, then the returned array will be in C-contiguous order (col-index varies the fastest).
If order is &#8216;A&#8217;, then the <code class="xref py py-attr docutils literal"><span class="pre">PstData.val</span></code>
ndarray may be in any order (either C-, Fortran-contiguous).</li>
<li><strong>dtype</strong> (<em>data-type</em>) &#8211; {scipy.float64 (default), scipy.float32}, optional &#8211; The data-type for the <code class="xref py py-attr docutils literal"><span class="pre">PstData.val</span></code> ndarray.</li>
<li><strong>force_python_only</strong> (<em>bool</em>) &#8211; optional &#8211; If False (default), may use outside library code. If True, requests that the read
be done without outside library code.</li>
<li><strong>view_ok</strong> (<em>bool</em>) &#8211; optional &#8211; If False (default), allocates new memory for the <code class="xref py py-attr docutils literal"><span class="pre">PstData.val</span></code>&#8216;s ndarray. If True,
if practical and reading from a <a class="reference internal" href="#pysnptools.pstreader.PstData" title="pysnptools.pstreader.PstData"><code class="xref py py-class docutils literal"><span class="pre">PstData</span></code></a>, will return a new 
<a class="reference internal" href="#pysnptools.pstreader.PstData" title="pysnptools.pstreader.PstData"><code class="xref py py-class docutils literal"><span class="pre">PstData</span></code></a> with a ndarray shares memory with the original <a class="reference internal" href="#pysnptools.pstreader.PstData" title="pysnptools.pstreader.PstData"><code class="xref py py-class docutils literal"><span class="pre">PstData</span></code></a>.
Typically, you&#8217;ll also wish to use &#8220;order=&#8217;A&#8217;&#8221; to increase the chance that sharing will be possible.
Use these parameters with care because any change to either ndarray will effect
the others. Also keep in mind that <a class="reference internal" href="#pysnptools.pstreader.PstReader.read" title="pysnptools.pstreader.PstReader.read"><code class="xref py py-meth docutils literal"><span class="pre">read()</span></code></a> relies on ndarray&#8217;s mechanisms to decide whether to actually
share memory and so it may ignore your suggestion and allocate a new ndarray anyway.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#pysnptools.pstreader.PstData" title="pysnptools.pstreader.PstData"><code class="xref py py-class docutils literal"><span class="pre">PstData</span></code></a></p>
</td>
</tr>
</tbody>
</table>
<p>Calling the method again causes the matrix values to be re-read and creates a new in-memory <a class="reference internal" href="#pysnptools.pstreader.PstData" title="pysnptools.pstreader.PstData"><code class="xref py py-class docutils literal"><span class="pre">PstData</span></code></a> with a new ndarray of matrix values.</p>
<p>If you request the values for only a subset of the sids or iids, (to the degree practical) only that subset will be read from disk.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.pstreader</span> <span class="k">import</span> <span class="n">PstHdf5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">on_disk</span> <span class="o">=</span> <span class="n">PstHdf5</span><span class="p">(</span><span class="s1">&#39;../examples/toydata.iidmajor.snp.hdf5&#39;</span><span class="p">)</span> <span class="c1"># Specify matrix data on disk</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pstdata1</span> <span class="o">=</span> <span class="n">on_disk</span><span class="o">.</span><span class="n">read</span><span class="p">()</span> <span class="c1"># Read all the matrix data returning a PstData instance</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="nb">type</span><span class="p">(</span><span class="n">pstdata1</span><span class="o">.</span><span class="n">val</span><span class="p">)</span> <span class="c1"># The PstData instance contains a ndarray of the data.</span>
<span class="go">&lt;type &#39;numpy.ndarray&#39;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">subset_pstdata</span> <span class="o">=</span> <span class="n">on_disk</span><span class="p">[:,::</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">read</span><span class="p">()</span> <span class="c1"># From the disk, read matrix values for every other sid</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">subset_pstdata</span><span class="o">.</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># Print the first matrix value in the subset</span>
<span class="go">1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">subsub_pstdata</span> <span class="o">=</span> <span class="n">subset_pstdata</span><span class="p">[:</span><span class="mi">10</span><span class="p">,:]</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="n">view_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1"># Create an in-memory subset of the subset with matrix values for the first ten iids. Share memory if practical.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># print np.may_share_memory(subset_snpdata.val, subsub_snpdata.val) # Do the two ndarray&#39;s share memory? They could. Currently they won&#39;t.       </span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="pysnptools.pstreader.PstReader.row">
<code class="descname">row</code><a class="headerlink" href="#pysnptools.pstreader.PstReader.row" title="Permalink to this definition">¶</a></dt>
<dd><p>A ndarray of the row ids. Each id can be anything, for example, a string, an array of two strings, a number, etc.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">ndarray (length <a class="reference internal" href="#pysnptools.pstreader.PstReader.row_count" title="pysnptools.pstreader.PstReader.row_count"><code class="xref py py-attr docutils literal"><span class="pre">row_count</span></code></a>)</td>
</tr>
</tbody>
</table>
<p>This property (to the degree practical) reads only row and col data from the disk, not matrix value data.
Moreover, the row and col data is read from file only once.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.pstreader</span> <span class="k">import</span> <span class="n">PstData</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data1</span> <span class="o">=</span> <span class="n">PstData</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">],</span><span class="n">col</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">,</span><span class="s1">&#39;z&#39;</span><span class="p">],</span><span class="n">val</span><span class="o">=</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span><span class="mi">6</span><span class="p">]],</span><span class="n">row_property</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="s1">&#39;C&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">data1</span><span class="o">.</span><span class="n">row</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span> <span class="c1"># print the first two row ids</span>
<span class="go">[&#39;a&#39; &#39;b&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data2</span> <span class="o">=</span> <span class="n">PstData</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]],</span><span class="n">col</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">,</span><span class="s1">&#39;z&#39;</span><span class="p">],</span><span class="n">val</span><span class="o">=</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span><span class="mi">6</span><span class="p">]],</span><span class="n">row_property</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="s1">&#39;C&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">data2</span><span class="o">.</span><span class="n">row</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span> <span class="c1"># print the first two row ids</span>
<span class="go">[[1 0]</span>
<span class="go"> [2 0]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="pysnptools.pstreader.PstReader.row_count">
<code class="descname">row_count</code><a class="headerlink" href="#pysnptools.pstreader.PstReader.row_count" title="Permalink to this definition">¶</a></dt>
<dd><p>number of rows</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">integer</td>
</tr>
</tbody>
</table>
<p>This property (to the degree practical) reads only row and col data from the disk, not matrix value data. Moreover, the row and col data is read from file only once.</p>
</dd></dl>

<dl class="attribute">
<dt id="pysnptools.pstreader.PstReader.row_property">
<code class="descname">row_property</code><a class="headerlink" href="#pysnptools.pstreader.PstReader.row_property" title="Permalink to this definition">¶</a></dt>
<dd><p>A ndarray of the additional information for each row. Each element is a ndarray.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">1- or 2-dimensional ndarray (length <a class="reference internal" href="#pysnptools.pstreader.PstReader.row_count" title="pysnptools.pstreader.PstReader.row_count"><code class="xref py py-attr docutils literal"><span class="pre">row_count</span></code></a>)</td>
</tr>
</tbody>
</table>
<p>This property (to the degree practical) reads only row and col data from the disk, not matrix value data. Moreover, the row and col data is read from file only once.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.pstreader</span> <span class="k">import</span> <span class="n">PstData</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data1</span> <span class="o">=</span> <span class="n">PstData</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">],</span><span class="n">col</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">,</span><span class="s1">&#39;z&#39;</span><span class="p">],</span><span class="n">val</span><span class="o">=</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span><span class="mi">6</span><span class="p">]],</span><span class="n">row_property</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="s1">&#39;C&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">data1</span><span class="o">.</span><span class="n">row_property</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span> <span class="c1"># print the first two row property values</span>
<span class="go">[&#39;A&#39; &#39;B&#39;]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pysnptools.pstreader.PstReader.row_to_index">
<code class="descname">row_to_index</code><span class="sig-paren">(</span><em>list</em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.pstreader.PstReader.row_to_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes a list of row ids and returns a list of index numbers</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>list</strong> &#8211; list of rows</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">ndarray of int</td>
</tr>
</tbody>
</table>
<p>This method (to the degree practical) reads only row and col data from the disk, not matrix value data. Moreover, the row and col data is read from file only once.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.pstreader</span> <span class="k">import</span> <span class="n">PstNpz</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">on_disk</span> <span class="o">=</span> <span class="n">PstNpz</span><span class="p">(</span><span class="s1">&#39;../../tests/datasets/all_chr.maf0.001.N300.pst.npz&#39;</span><span class="p">)</span> <span class="c1"># Specify matrix data on disk</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">on_disk</span><span class="o">.</span><span class="n">row_to_index</span><span class="p">([[</span><span class="s1">&#39;POP1&#39;</span><span class="p">,</span><span class="s1">&#39;44&#39;</span><span class="p">],[</span><span class="s1">&#39;POP1&#39;</span><span class="p">,</span><span class="s1">&#39;12&#39;</span><span class="p">]])</span> <span class="c1">#Find the indexes for two rows.</span>
<span class="go">[2 1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="pysnptools.pstreader.PstReader.shape">
<code class="descname">shape</code><a class="headerlink" href="#pysnptools.pstreader.PstReader.shape" title="Permalink to this definition">¶</a></dt>
<dd><p>number of rows and number of cols</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">tuple of two integers</td>
</tr>
</tbody>
</table>
<p>This property (to the degree practical) reads only row and col data from the disk, not matrix value data. Moreover, the row and col data is read from file only once.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="pstreader-pstdata">
<h3><code class="xref py py-class docutils literal"><span class="pre">pstreader.PstData</span></code><a class="headerlink" href="#pstreader-pstdata" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="pysnptools.pstreader.PstData">
<em class="property">class </em><code class="descclassname">pysnptools.pstreader.</code><code class="descname">PstData</code><span class="sig-paren">(</span><em>row</em>, <em>col</em>, <em>val</em>, <em>row_property=None</em>, <em>col_property=None</em>, <em>name=None</em>, <em>parent_string=None</em>, <em>copyinputs_function=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.pstreader.PstData" title="Permalink to this definition">¶</a></dt>
<dd><p>A <a class="reference internal" href="#pysnptools.pstreader.PstReader" title="pysnptools.pstreader.PstReader"><code class="xref py py-class docutils literal"><span class="pre">PstReader</span></code></a> for holding values in-memory, along with related row and col information.
It is usually created by calling the <a class="reference internal" href="#pysnptools.pstreader.PstReader.read" title="pysnptools.pstreader.PstReader.read"><code class="xref py py-meth docutils literal"><span class="pre">PstReader.read()</span></code></a> method on another <a class="reference internal" href="#pysnptools.pstreader.PstReader" title="pysnptools.pstreader.PstReader"><code class="xref py py-class docutils literal"><span class="pre">PstReader</span></code></a>, for example, <a class="reference internal" href="#pysnptools.pstreader.PstNpz" title="pysnptools.pstreader.PstNpz"><code class="xref py py-class docutils literal"><span class="pre">PstNpz</span></code></a>. It can also be constructed.</p>
<p>See <a class="reference internal" href="#pysnptools.pstreader.PstReader" title="pysnptools.pstreader.PstReader"><code class="xref py py-class docutils literal"><span class="pre">PstReader</span></code></a> for details and examples.</p>
<dl class="docutils">
<dt><strong>Constructor:</strong></dt>
<dd><table class="first docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>row</strong> (an array of anything) &#8211; The <a class="reference internal" href="#pysnptools.pstreader.PstReader.row" title="pysnptools.pstreader.PstReader.row"><code class="xref py py-attr docutils literal"><span class="pre">row</span></code></a> information</li>
<li><strong>col</strong> (an array of anything) &#8211; The <a class="reference internal" href="#pysnptools.pstreader.PstReader.col" title="pysnptools.pstreader.PstReader.col"><code class="xref py py-attr docutils literal"><span class="pre">col</span></code></a> information</li>
<li><strong>val</strong> (a 2-D array of floats) &#8211; The values</li>
<li><strong>row_property</strong> (optional, an array of anything) &#8211; Additional information associated with each row.</li>
<li><strong>col_property</strong> (optional, an array of strings) &#8211; Additional information associated with each col.</li>
<li><strong>name</strong> (optional, string) &#8211; Information to be display about the origin of this data</li>
<li><strong>copyinputs_function</strong> (optional, function) &#8211; <em>Used internally by optional clustering code</em></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.pstreader</span> <span class="k">import</span> <span class="n">PstData</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pstdata</span> <span class="o">=</span> <span class="n">PstData</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="p">[[</span><span class="s1">&#39;fam0&#39;</span><span class="p">,</span><span class="s1">&#39;iid0&#39;</span><span class="p">],[</span><span class="s1">&#39;fam0&#39;</span><span class="p">,</span><span class="s1">&#39;iid1&#39;</span><span class="p">]],</span> <span class="n">col</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;snp334&#39;</span><span class="p">,</span><span class="s1">&#39;snp349&#39;</span><span class="p">,</span><span class="s1">&#39;snp921&#39;</span><span class="p">],</span> <span class="n">val</span><span class="o">=</span><span class="p">[[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">2.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">2.</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">pstdata</span><span class="o">.</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">pstdata</span><span class="o">.</span><span class="n">row_count</span><span class="p">,</span> <span class="n">pstdata</span><span class="o">.</span><span class="n">col_count</span>
<span class="go">2.0 2 3</span>
</pre></div>
</div>
</dd>
</dl>
<p><strong>Equality:</strong></p>
<blockquote>
<div><p>Two PstData objects are equal if their five arrays (<a class="reference internal" href="#pysnptools.pstreader.PstReader.row" title="pysnptools.pstreader.PstReader.row"><code class="xref py py-attr docutils literal"><span class="pre">row</span></code></a>, <a class="reference internal" href="#pysnptools.pstreader.PstReader.col" title="pysnptools.pstreader.PstReader.col"><code class="xref py py-attr docutils literal"><span class="pre">col</span></code></a>, <code class="xref py py-attr docutils literal"><span class="pre">val</span></code>, <a class="reference internal" href="#pysnptools.pstreader.PstReader.row_property" title="pysnptools.pstreader.PstReader.row_property"><code class="xref py py-attr docutils literal"><span class="pre">PstReader.row_property</span></code></a>, and <a class="reference internal" href="#pysnptools.pstreader.PstReader.col_property" title="pysnptools.pstreader.PstReader.col_property"><code class="xref py py-attr docutils literal"><span class="pre">col_property</span></code></a>) are &#8216;array_equal&#8217;.
(Their &#8216;name&#8217; does not need to be the same).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.pstreader</span> <span class="k">import</span> <span class="n">PstData</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pstdata1</span> <span class="o">=</span> <span class="n">PstData</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="p">[[</span><span class="s1">&#39;fam0&#39;</span><span class="p">,</span><span class="s1">&#39;iid0&#39;</span><span class="p">],[</span><span class="s1">&#39;fam0&#39;</span><span class="p">,</span><span class="s1">&#39;iid1&#39;</span><span class="p">]],</span> <span class="n">col</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;snp334&#39;</span><span class="p">,</span><span class="s1">&#39;snp349&#39;</span><span class="p">,</span><span class="s1">&#39;snp921&#39;</span><span class="p">],</span> <span class="n">val</span><span class="o">=</span><span class="p">[[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">2.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">2.</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pstdata2</span> <span class="o">=</span> <span class="n">PstData</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="p">[[</span><span class="s1">&#39;fam0&#39;</span><span class="p">,</span><span class="s1">&#39;iid0&#39;</span><span class="p">],[</span><span class="s1">&#39;fam0&#39;</span><span class="p">,</span><span class="s1">&#39;iid1&#39;</span><span class="p">]],</span> <span class="n">col</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;snp334&#39;</span><span class="p">,</span><span class="s1">&#39;snp349&#39;</span><span class="p">,</span><span class="s1">&#39;snp921&#39;</span><span class="p">],</span> <span class="n">val</span><span class="o">=</span><span class="p">[[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">2.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">2.</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">pstdata1</span> <span class="o">==</span> <span class="n">pstdata2</span> <span class="c1">#True, because all the arrays have the same values.</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">pstdata1</span><span class="o">.</span><span class="n">val</span> <span class="ow">is</span> <span class="n">pstdata2</span><span class="o">.</span><span class="n">val</span> <span class="c1">#False, because the two arrays have different memory.</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pstdata3</span> <span class="o">=</span> <span class="n">PstData</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">],</span> <span class="n">col</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;snp334&#39;</span><span class="p">,</span><span class="s1">&#39;snp349&#39;</span><span class="p">,</span><span class="s1">&#39;snp921&#39;</span><span class="p">],</span> <span class="n">val</span><span class="o">=</span><span class="p">[[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">2.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">2.</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pstdata4</span> <span class="o">=</span> <span class="n">PstData</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="p">[[</span><span class="s1">&#39;fam0&#39;</span><span class="p">,</span><span class="s1">&#39;iid0&#39;</span><span class="p">],[</span><span class="s1">&#39;fam0&#39;</span><span class="p">,</span><span class="s1">&#39;iid1&#39;</span><span class="p">]],</span> <span class="n">col</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;snp334&#39;</span><span class="p">,</span><span class="s1">&#39;snp349&#39;</span><span class="p">,</span><span class="s1">&#39;snp921&#39;</span><span class="p">],</span> <span class="n">val</span><span class="o">=</span><span class="p">[[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">2.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">2.</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">pstdata3</span> <span class="o">==</span> <span class="n">pstdata4</span> <span class="c1">#False, because the rows have different ids.</span>
<span class="go">False</span>
</pre></div>
</div>
</div></blockquote>
<p><strong>Methods beyond</strong> <a class="reference internal" href="#pysnptools.pstreader.PstReader" title="pysnptools.pstreader.PstReader"><code class="xref py py-class docutils literal"><span class="pre">PstReader</span></code></a></p>
</dd></dl>

</div>
<div class="section" id="pstreader-psthdf5">
<h3><code class="xref py py-class docutils literal"><span class="pre">pstreader.PstHdf5</span></code><a class="headerlink" href="#pstreader-psthdf5" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="pysnptools.pstreader.PstHdf5">
<em class="property">class </em><code class="descclassname">pysnptools.pstreader.</code><code class="descname">PstHdf5</code><span class="sig-paren">(</span><em>filename</em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.pstreader.PstHdf5" title="Permalink to this definition">¶</a></dt>
<dd><p>A <a class="reference internal" href="#pysnptools.pstreader.PstReader" title="pysnptools.pstreader.PstReader"><code class="xref py py-class docutils literal"><span class="pre">PstReader</span></code></a> for reading *.pst.hdf5 files from disk.</p>
<p>See <a class="reference internal" href="#pysnptools.pstreader.PstReader" title="pysnptools.pstreader.PstReader"><code class="xref py py-class docutils literal"><span class="pre">PstReader</span></code></a> for general examples of using PstReaders.</p>
<p>The general HDF5 format is described in <a class="reference external" href="http://www.hdfgroup.org/HDF5/">http://www.hdfgroup.org/HDF5/</a>. The PstHdf5 format stores
val, row, col, row_property, and col_property information in Hdf5 format.</p>
<dl class="docutils">
<dt><strong>Constructor:</strong></dt>
<dd><table class="first docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>filename</strong> (<em>string</em>) &#8211; The PstHdf5 file to read.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.pstreader</span> <span class="k">import</span> <span class="n">PstHdf5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">on_disk</span> <span class="o">=</span> <span class="n">PstHdf5</span><span class="p">(</span><span class="s1">&#39;../examples/toydata.iidmajor.snp.hdf5&#39;</span><span class="p">)</span> <span class="c1"># PstHdf5 can load .pst.hdf5, .snp.hdf5, and kernel.hdf5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">on_disk</span><span class="o">.</span><span class="n">row_count</span>
<span class="go">500</span>
</pre></div>
</div>
</dd>
</dl>
<p><strong>Methods beyond</strong> <a class="reference internal" href="#pysnptools.pstreader.PstReader" title="pysnptools.pstreader.PstReader"><code class="xref py py-class docutils literal"><span class="pre">PstReader</span></code></a></p>
<dl class="staticmethod">
<dt id="pysnptools.pstreader.PstHdf5.write">
<em class="property">static </em><code class="descname">write</code><span class="sig-paren">(</span><em>filename</em>, <em>pstdata</em>, <em>hdf5_dtype=None</em>, <em>col_major=True</em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.pstreader.PstHdf5.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes a <a class="reference internal" href="#pysnptools.pstreader.PstData" title="pysnptools.pstreader.PstData"><code class="xref py py-class docutils literal"><span class="pre">PstData</span></code></a> to PstHdf5 format.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>filename</strong> (<em>string</em>) &#8211; the name of the file to create</li>
<li><strong>pstdata</strong> (<a class="reference internal" href="#pysnptools.pstreader.PstData" title="pysnptools.pstreader.PstData"><code class="xref py py-class docutils literal"><span class="pre">PstData</span></code></a>) &#8211; The in-memory data that should be written to disk.</li>
<li><strong>hdf5_dtype</strong> (<em>string</em>) &#8211; None (use the .val&#8217;s dtype) or a Hdf5 dtype, e.g. &#8216;f8&#8217;,&#8217;f4&#8217;,etc.</li>
<li><strong>col_major</strong> (<em>bool</em>) &#8211; Tells if vals should be stored on disk in col_major (default) or row_major format.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.pstreader</span> <span class="k">import</span> <span class="n">PstData</span><span class="p">,</span> <span class="n">PstHdf5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pysnptools.util</span> <span class="k">as</span> <span class="nn">pstutil</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data1</span> <span class="o">=</span> <span class="n">PstData</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">],</span><span class="n">col</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">,</span><span class="s1">&#39;z&#39;</span><span class="p">],</span><span class="n">val</span><span class="o">=</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span><span class="mi">6</span><span class="p">]],</span><span class="n">row_property</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="s1">&#39;C&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pstutil</span><span class="o">.</span><span class="n">create_directory_if_necessary</span><span class="p">(</span><span class="s2">&quot;tempdir/tiny.pst.hdf5&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">PstHdf5</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;tempdir/tiny.pst.hdf5&quot;</span><span class="p">,</span><span class="n">data1</span><span class="p">)</span>          <span class="c1"># Write data in PstHdf5 format</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="pstreader-pstnpz">
<h3><code class="xref py py-class docutils literal"><span class="pre">pstreader.PstNpz</span></code><a class="headerlink" href="#pstreader-pstnpz" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="pysnptools.pstreader.PstNpz">
<em class="property">class </em><code class="descclassname">pysnptools.pstreader.</code><code class="descname">PstNpz</code><span class="sig-paren">(</span><em>filename</em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.pstreader.PstNpz" title="Permalink to this definition">¶</a></dt>
<dd><p>A <a class="reference internal" href="#pysnptools.pstreader.PstReader" title="pysnptools.pstreader.PstReader"><code class="xref py py-class docutils literal"><span class="pre">PstReader</span></code></a> for reading *.pst.npz files from disk.</p>
<p>See <a class="reference internal" href="#pysnptools.pstreader.PstReader" title="pysnptools.pstreader.PstReader"><code class="xref py py-class docutils literal"><span class="pre">PstReader</span></code></a> for general examples of using PstReaders.</p>
<p>The general NPZ format is described in <a class="reference external" href="http://docs.scipy.org/doc/numpy/reference/generated/numpy.savez.html">http://docs.scipy.org/doc/numpy/reference/generated/numpy.savez.html</a>. The PstNpz format stores
val, row, col, row_property, and col_property information in NPZ format.</p>
<dl class="docutils">
<dt><strong>Constructor:</strong></dt>
<dd><table class="first docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>filename</strong> (<em>string</em>) &#8211; The PstNpz file to read.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.pstreader</span> <span class="k">import</span> <span class="n">PstNpz</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_on_disk</span> <span class="o">=</span> <span class="n">PstNpz</span><span class="p">(</span><span class="s1">&#39;../examples/little.pst.npz&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">data_on_disk</span><span class="o">.</span><span class="n">iid_count</span>
<span class="go">500</span>
</pre></div>
</div>
</dd>
</dl>
<p><strong>Methods beyond</strong> <code class="xref py py-class docutils literal"><span class="pre">NpzReader</span></code></p>
<dl class="method">
<dt id="pysnptools.pstreader.PstNpz.run_once">
<code class="descname">run_once</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.pstreader.PstNpz.run_once" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="staticmethod">
<dt id="pysnptools.pstreader.PstNpz.write">
<em class="property">static </em><code class="descname">write</code><span class="sig-paren">(</span><em>filename</em>, <em>pstdata</em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.pstreader.PstNpz.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes a <a class="reference internal" href="#pysnptools.pstreader.PstData" title="pysnptools.pstreader.PstData"><code class="xref py py-class docutils literal"><span class="pre">PstData</span></code></a> to PstNpz format.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>filename</strong> (<em>string</em>) &#8211; the name of the file to create</li>
<li><strong>pstdata</strong> (<a class="reference internal" href="#pysnptools.pstreader.PstData" title="pysnptools.pstreader.PstData"><code class="xref py py-class docutils literal"><span class="pre">PstData</span></code></a>) &#8211; The in-memory data that should be written to disk.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.pstreader</span> <span class="k">import</span> <span class="n">PstData</span><span class="p">,</span> <span class="n">PstNpz</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pysnptools.util</span> <span class="k">as</span> <span class="nn">pstutil</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data1</span> <span class="o">=</span> <span class="n">PstData</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">],</span><span class="n">col</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">,</span><span class="s1">&#39;z&#39;</span><span class="p">],</span><span class="n">val</span><span class="o">=</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span><span class="mi">6</span><span class="p">]],</span><span class="n">row_property</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="s1">&#39;C&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pstutil</span><span class="o">.</span><span class="n">create_directory_if_necessary</span><span class="p">(</span><span class="s2">&quot;tempdir/tiny.pst.npz&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">PstNpz</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;tempdir/tiny.pst.npz&quot;</span><span class="p">,</span><span class="n">data1</span><span class="p">)</span>          <span class="c1"># Write data in PstNz format</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</div>
</div>
<div class="section" id="indices-and-tables">
<h2>Indices and Tables<a class="headerlink" href="#indices-and-tables" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><ul class="simple">
<li><a class="reference internal" href="genindex.html"><span class="std std-ref">Index</span></a></li>
<li><a class="reference internal" href="py-modindex.html"><span class="std std-ref">Module Index</span></a></li>
<li><a class="reference internal" href="search.html"><span class="std std-ref">Search Page</span></a></li>
</ul>
</div></blockquote>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="#">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#"><code class="docutils literal"><span class="pre">pysnptools</span></code> Documentation</a><ul>
<li><a class="reference internal" href="#module-pysnptools.snpreader"><code class="docutils literal"><span class="pre">snpreader</span></code> Module</a><ul>
<li><a class="reference internal" href="#snpreader-snpreader"><code class="docutils literal"><span class="pre">snpreader.SnpReader</span></code></a></li>
<li><a class="reference internal" href="#snpreader-bed"><code class="docutils literal"><span class="pre">snpreader.Bed</span></code></a></li>
<li><a class="reference internal" href="#snpreader-snpdata"><code class="docutils literal"><span class="pre">snpreader.SnpData</span></code></a></li>
<li><a class="reference internal" href="#snpreader-pheno"><code class="docutils literal"><span class="pre">snpreader.Pheno</span></code></a></li>
<li><a class="reference internal" href="#snpreader-ped"><code class="docutils literal"><span class="pre">snpreader.Ped</span></code></a></li>
<li><a class="reference internal" href="#snpreader-dat"><code class="docutils literal"><span class="pre">snpreader.Dat</span></code></a></li>
<li><a class="reference internal" href="#snpreader-dense"><code class="docutils literal"><span class="pre">snpreader.Dense</span></code></a></li>
<li><a class="reference internal" href="#snpreader-snphdf5"><code class="docutils literal"><span class="pre">snpreader.SnpHdf5</span></code></a></li>
<li><a class="reference internal" href="#snpreader-snpnpz"><code class="docutils literal"><span class="pre">snpreader.SnpNpz</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-pysnptools.kernelreader"><code class="docutils literal"><span class="pre">kernelreader</span></code> Module</a><ul>
<li><a class="reference internal" href="#kernelreader-kernelreader"><code class="docutils literal"><span class="pre">kernelreader.KernelReader</span></code></a></li>
<li><a class="reference internal" href="#kernelreader-kerneldata"><code class="docutils literal"><span class="pre">kernelreader.KernelData</span></code></a></li>
<li><a class="reference internal" href="#kernelreader-kernelnpz"><code class="docutils literal"><span class="pre">kernelreader.KernelNpz</span></code></a></li>
<li><a class="reference internal" href="#kernelreader-kernelhdf5"><code class="docutils literal"><span class="pre">kernelreader.KernelHdf5</span></code></a></li>
<li><a class="reference internal" href="#kernelreader-identity"><code class="docutils literal"><span class="pre">kernelreader.Identity</span></code></a></li>
<li><a class="reference internal" href="#kernelreader-snpkernel"><code class="docutils literal"><span class="pre">kernelreader.SnpKernel</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#util-module"><code class="docutils literal"><span class="pre">util</span></code> Module</a><ul>
<li><a class="reference internal" href="#module-pysnptools.util"><code class="docutils literal"><span class="pre">util</span></code></a></li>
<li><a class="reference internal" href="#util-intrangeset"><code class="docutils literal"><span class="pre">util.IntRangeSet</span></code></a></li>
<li><a class="reference internal" href="#module-pysnptools.util.pheno"><code class="docutils literal"><span class="pre">util.pheno</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-pysnptools.standardizer"><code class="docutils literal"><span class="pre">standardizer</span></code> Module</a><ul>
<li><a class="reference internal" href="#standardizer-standardizer"><code class="docutils literal"><span class="pre">standardizer.Standardizer</span></code></a></li>
<li><a class="reference internal" href="#standardizer-unit"><code class="docutils literal"><span class="pre">standardizer.Unit</span></code></a></li>
<li><a class="reference internal" href="#standardizer-beta"><code class="docutils literal"><span class="pre">standardizer.Beta</span></code></a></li>
<li><a class="reference internal" href="#standardizer-identity"><code class="docutils literal"><span class="pre">standardizer.Identity</span></code></a></li>
<li><a class="reference internal" href="#standardizer-diagkton"><code class="docutils literal"><span class="pre">standardizer.DiagKtoN</span></code></a></li>
<li><a class="reference internal" href="#standardizer-unittrained"><code class="docutils literal"><span class="pre">standardizer.UnitTrained</span></code></a></li>
<li><a class="reference internal" href="#standardizer-diagktontrained"><code class="docutils literal"><span class="pre">standardizer.DiagKtoNTrained</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#kernelstandardizer-module"><code class="docutils literal"><span class="pre">kernelstandardizer</span></code> Module</a><ul>
<li><a class="reference internal" href="#kernelstandardizer-kernelstandardizer"><code class="docutils literal"><span class="pre">kernelstandardizer.KernelStandardizer</span></code></a></li>
<li><a class="reference internal" href="#kernelstandardizer-diagkton"><code class="docutils literal"><span class="pre">kernelstandardizer.DiagKtoN</span></code></a></li>
<li><a class="reference internal" href="#kernelstandardizer-diagktontrained"><code class="docutils literal"><span class="pre">kernelstandardizer.DiagKtoNTrained</span></code></a></li>
<li><a class="reference internal" href="#kernelstandardizer-identity"><code class="docutils literal"><span class="pre">kernelstandardizer.Identity</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-pysnptools.pstreader"><code class="docutils literal"><span class="pre">pstreader</span></code> Module</a><ul>
<li><a class="reference internal" href="#pstreader-pstreader"><code class="docutils literal"><span class="pre">pstreader.PstReader</span></code></a></li>
<li><a class="reference internal" href="#pstreader-pstdata"><code class="docutils literal"><span class="pre">pstreader.PstData</span></code></a></li>
<li><a class="reference internal" href="#pstreader-psthdf5"><code class="docutils literal"><span class="pre">pstreader.PstHdf5</span></code></a></li>
<li><a class="reference internal" href="#pstreader-pstnpz"><code class="docutils literal"><span class="pre">pstreader.PstNpz</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#indices-and-tables">Indices and Tables</a></li>
</ul>
</li>
</ul>

  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/index.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="#">pysnptools 0.0.1 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2014, Carl Kadie.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.4.1.
    </div>
  </body>
</html>